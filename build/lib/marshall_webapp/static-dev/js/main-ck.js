function AstroMath(){}function Projection(t,e){this.PROJECTION=Projection.PROJ_TAN,this.ROT=this.tr_oR(t,e)}function Coo(t,e,i){this.lon=t,this.lat=e,this.prec=i,this.frame=null,this.computeDirCos()}function Tokenizer(t,e){this.string=Strings.trim(t,e),this.sep=e,this.pos=0}function Strings(){}function Numbers(){}function relMouseCoords(t){var e=0,i=0,r=0,o=0,a=this;if(t.offsetX)return{x:t.offsetX,y:t.offsetY};if(!Utils.cssScale){var n=window.getComputedStyle(document.body,null),s=n.getPropertyValue("-webkit-transform")||n.getPropertyValue("-moz-transform")||n.getPropertyValue("-ms-transform")||n.getPropertyValue("-o-transform")||n.getPropertyValue("transform"),l=/matrix\((-?\d*\.?\d+),\s*0,\s*0,\s*(-?\d*\.?\d+),\s*0,\s*0\)/,c=s.match(l);c?Utils.cssScale=parseFloat(c[1]):Utils.cssScale=1}var h=t,u=h.target,d=h.target||h.srcElement,p=d.currentStyle||window.getComputedStyle(d,null),f=parseInt(p.borderLeftWidth,10),m=parseInt(p.borderTopWidth,10),g=d.getBoundingClientRect(),v=h.clientX-f-g.left,y=h.clientY-m-g.top;return{x:parseInt(v/Utils.cssScale),y:parseInt(y/Utils.cssScale)};do e+=a.offsetLeft-a.scrollLeft,i+=a.offsetTop-a.scrollTop;while(a=a.offsetParent);return t.pageX?(r=t.pageX-e-(document.body.scrollLeft||document.documentElement.scrollLeft),o=t.pageY-i-(document.body.scrollTop||document.documentElement.scrollTop)):(r=t.originalEvent.targetTouches[0].screenX-e-(document.body.scrollLeft||document.documentElement.scrollLeft),o=t.originalEvent.targetTouches[0].screenY-i-(document.body.scrollTop||document.documentElement.scrollTop)),{x:r,y:o}}function ColorOpacity(t,e){var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return i=i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null,rgba="rgba("+i.r+","+i.g+","+i.b+","+e+")",rgba}function dryxAladin(t){var e=$(t).attr("data");console.log("dataUrl: "+JSON.stringify(e)),$.getJSON(e,function(e){var i=$(t).attr("coords"),r=$(t).attr("survey"),o=e.aladin_parameters,a=e.catalogues,n=e.catalogueOrder,s=$(t).attr("transient");console.log("coords: "+JSON.stringify(i)),console.log("survey: "+JSON.stringify(r)),console.log("parameters: "+JSON.stringify(o)),console.log("catalogues: "+JSON.stringify(a)),console.log("catalogueOrder: "+JSON.stringify(n)),console.log("tranName: "+JSON.stringify(s));var l=A.aladin(t,{cooFrame:"J2000",showReticle:!1,showZoomControl:!0,showShareControl:!1,showCooGrid:!1,showFullscreenControl:!0,showFrameChoice:!1,showLayersControl:!0,showGotoControl:!1,showFrame:!0,fullScreen:!1,reticleColor:"#dc322f",reticleSize:50,survey:r,fov:o.FOV,target:i});l.getBaseImageLayer().getColorMap().reverse(1);for(var c=[],h=0;h<n.length;h++){var u=n[h];if(a.hasOwnProperty(u)){var d=A.graphicOverlay({name:"search areas",color:a[u].color,lineWidth:o.search_perimeter_width});l.addOverlay(d);var p=A.catalog({name:u,shape:"square",sourceSize:0,labelFont:"20px dryx_icon_font",displayLabel:!0,color:a[u].color,labelColumn:"mainId",colorColumn:"color"});l.addCatalog(p);var f=A.catalog({name:u+" markers",sourceSize:0,color:a[u].color});l.addCatalog(f);for(var m=a[u].data,g=0;g<m.length;g++)d.add(A.circle(m[g].raDeg,m[g].decDeg,m[g].original_search_radius_arcsec/3600,{color:m[g].radius_color,fillOpacity:.1})),f.addSources([A.marker(m[g].raDeg,m[g].decDeg,{popupTitle:m[g].catalogue_object_id,popupDesc:m[g].details})]),p.addSources(A.source(m[g].raDeg,m[g].decDeg,{mainId:m[g].label,color:m[g].radius_color}))}}var v=A.catalog({name:"transient",sourceSize:18,color:"#dc322f"});l.addCatalog(v);var y=i.split(" ");v.addSources([A.marker(y[0],y[1],{popupTitle:s})]),l.setImageSurvey("P/DSS/color"),setTimeout(function(){l.setImageSurvey(r)},200);var b=A.catalog(shape="square",color="#268bd2",sourceSize=50,labelColumn="nice",labelColor="#268bd2");l.addCatalog(b)});var i=function(t){return console.log("init function triggered for dryxAladin"),{}},r=function(t){console.log("attributes function triggered for dryxAladin")};return{init:i,update_attributes:r}}function reset_all_tickets(){$("div.aladin").each(function(t,e){$(e).attr("class","aladin-hide"),$(e).html("")}),$("div.singleTicket").each(function(t,e){$(e).find("a[data-toggle='tab']:first").click()})}var cds=cds||{},A=A||{};"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(t){return t<10?"0"+t:t}function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var i,r,o,a,n=gap,s,l=e[t];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(t)),"function"==typeof rep&&(l=rep.call(e,t,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,s=[],"[object Array]"===Object.prototype.toString.apply(l)){for(a=l.length,i=0;i<a;i+=1)s[i]=str(i,l)||"null";return o=0===s.length?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+n+"]":"["+s.join(",")+"]",gap=n,o}if(rep&&"object"==typeof rep)for(a=rep.length,i=0;i<a;i+=1)"string"==typeof rep[i]&&(r=rep[i],o=str(r,l),o&&s.push(quote(r)+(gap?": ":":")+o));else for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(o=str(r,l),o&&s.push(quote(r)+(gap?": ":":")+o));return o=0===s.length?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+n+"}":"{"+s.join(",")+"}",gap=n,o}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(t){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(t){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(t,e,i){var r;if(gap="",indent="","number"==typeof i)for(r=0;r<i;r+=1)indent+=" ";else"string"==typeof i&&(indent=i);if(rep=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw new Error("JSON.stringify");return str("",{"":t})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(t,e){var i,r,o=t[e];if(o&&"object"==typeof o)for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&(r=walk(o,i),void 0!==r?o[i]=r:delete o[i]);return reviver.call(t,e,o)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),Logger={},Logger.log=function(t,e){try{var i="http://alasky.u-strasbg.fr/cgi/AladinLiteLogger/log.py",r="";e&&(r=JSON.stringify(e)),$.ajax({url:i,data:{action:t,params:r,pageUrl:window.location.href,referer:document.referrer?document.referrer:""},method:"GET",dataType:"json"})}catch(t){window.console&&console.log("Exception: "+t)}},function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t:t(jQuery)}(function($){function t(t){var e=t||window.event,i=[].slice.call(arguments,1),a=0,n=0,s=0,l=0,c=0,h;return t=$.event.fix(e),t.type="mousewheel",e.wheelDelta&&(a=e.wheelDelta),e.detail&&(a=e.detail*-1),s=a,void 0!==e.axis&&e.axis===e.HORIZONTAL_AXIS&&(s=0,n=a*-1),e.deltaY&&(s=e.deltaY*-1,a=s),e.deltaX&&(n=e.deltaX,a=n*-1),void 0!==e.wheelDeltaY&&(s=e.wheelDeltaY),void 0!==e.wheelDeltaX&&(n=e.wheelDeltaX*-1),l=Math.abs(a),(!r||l<r)&&(r=l),c=Math.max(Math.abs(s),Math.abs(n)),(!o||c<o)&&(o=c),h=a>0?"floor":"ceil",a=Math[h](a/r),n=Math[h](n/o),s=Math[h](s/o),i.unshift(t,a,n,s),($.event.dispatch||$.event.handle).apply(this,i)}var e=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],i="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],r,o;if($.event.fixHooks)for(var a=e.length;a;)$.event.fixHooks[e[--a]]=$.event.mouseHooks;$.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=i.length;e;)this.addEventListener(i[--e],t,!1);else this.onmousewheel=t},teardown:function(){if(this.removeEventListener)for(var e=i.length;e;)this.removeEventListener(i[--e],t,!1);else this.onmousewheel=null}},$.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})}),window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){window.setTimeout(t,1e3/60)}}();var Stats=function(){function t(t,e,i){var r,o,a;for(o=0;o<30;o++)for(r=0;r<73;r++)a=4*(r+74*o),t[a]=t[a+4],t[a+1]=t[a+5],t[a+2]=t[a+6];for(o=0;o<30;o++)a=4*(73+74*o),o<e?(t[a]=I[i].bg.r,t[a+1]=I[i].bg.g,t[a+2]=I[i].bg.b):(t[a]=I[i].fg.r,t[a+1]=I[i].fg.g,t[a+2]=I[i].fg.b)}var e=0,i=2,r,o=0,a=(new Date).getTime(),n=a,s=a,l=0,c=1e3,h=0,u,d,p,f,m,g=0,v=1e3,y=0,b,x,w,C,S=0,_=1e3,M=0,T,k,N,A,I={fps:{bg:{r:16,g:16,b:48},fg:{r:0,g:255,b:255}},ms:{bg:{r:16,g:48,b:16},fg:{r:0,g:255,b:0}},mb:{bg:{r:48,g:16,b:26},fg:{r:255,g:0,b:128}}};r=document.createElement("div"),r.style.cursor="pointer",r.style.width="80px",r.style.opacity="0.9",r.style.zIndex="10001",r.addEventListener("click",function(){switch(e++,e==i&&(e=0),u.style.display="none",b.style.display="none",T.style.display="none",e){case 0:u.style.display="block";break;case 1:b.style.display="block";break;case 2:T.style.display="block"}},!1),u=document.createElement("div"),u.style.backgroundColor="rgb("+Math.floor(I.fps.bg.r/2)+","+Math.floor(I.fps.bg.g/2)+","+Math.floor(I.fps.bg.b/2)+")",u.style.padding="2px 0px 3px 0px",r.appendChild(u),d=document.createElement("div"),d.style.fontFamily="Helvetica, Arial, sans-serif",d.style.textAlign="left",d.style.fontSize="9px",d.style.color="rgb("+I.fps.fg.r+","+I.fps.fg.g+","+I.fps.fg.b+")",d.style.margin="0px 0px 1px 3px",d.innerHTML='<span style="font-weight:bold">FPS</span>',u.appendChild(d),p=document.createElement("canvas"),p.width=74,p.height=30,p.style.display="block",p.style.marginLeft="3px",u.appendChild(p),f=p.getContext("2d"),f.fillStyle="rgb("+I.fps.bg.r+","+I.fps.bg.g+","+I.fps.bg.b+")",f.fillRect(0,0,p.width,p.height),m=f.getImageData(0,0,p.width,p.height),b=document.createElement("div"),b.style.backgroundColor="rgb("+Math.floor(I.ms.bg.r/2)+","+Math.floor(I.ms.bg.g/2)+","+Math.floor(I.ms.bg.b/2)+")",b.style.padding="2px 0px 3px 0px",b.style.display="none",r.appendChild(b),x=document.createElement("div"),x.style.fontFamily="Helvetica, Arial, sans-serif",x.style.textAlign="left",x.style.fontSize="9px",x.style.color="rgb("+I.ms.fg.r+","+I.ms.fg.g+","+I.ms.fg.b+")",x.style.margin="0px 0px 1px 3px",x.innerHTML='<span style="font-weight:bold">MS</span>',b.appendChild(x),p=document.createElement("canvas"),p.width=74,p.height=30,p.style.display="block",p.style.marginLeft="3px",b.appendChild(p),w=p.getContext("2d"),w.fillStyle="rgb("+I.ms.bg.r+","+I.ms.bg.g+","+I.ms.bg.b+")",w.fillRect(0,0,p.width,p.height),C=w.getImageData(0,0,p.width,p.height);try{performance&&performance.memory&&performance.memory.totalJSHeapSize&&(i=3)}catch(t){}return T=document.createElement("div"),T.style.backgroundColor="rgb("+Math.floor(I.mb.bg.r/2)+","+Math.floor(I.mb.bg.g/2)+","+Math.floor(I.mb.bg.b/2)+")",T.style.padding="2px 0px 3px 0px",T.style.display="none",r.appendChild(T),k=document.createElement("div"),k.style.fontFamily="Helvetica, Arial, sans-serif",k.style.textAlign="left",k.style.fontSize="9px",k.style.color="rgb("+I.mb.fg.r+","+I.mb.fg.g+","+I.mb.fg.b+")",k.style.margin="0px 0px 1px 3px",k.innerHTML='<span style="font-weight:bold">MB</span>',T.appendChild(k),p=document.createElement("canvas"),p.width=74,p.height=30,p.style.display="block",p.style.marginLeft="3px",T.appendChild(p),N=p.getContext("2d"),N.fillStyle="#301010",N.fillRect(0,0,p.width,p.height),A=N.getImageData(0,0,p.width,p.height),{domElement:r,update:function(){o++,a=(new Date).getTime(),g=a-n,v=Math.min(v,g),y=Math.max(y,g),t(C.data,Math.min(30,30-g/200*30),"ms"),x.innerHTML='<span style="font-weight:bold">'+g+" MS</span> ("+v+"-"+y+")",w.putImageData(C,0,0),n=a,a>s+1e3&&(l=Math.round(1e3*o/(a-s)),c=Math.min(c,l),h=Math.max(h,l),t(m.data,Math.min(30,30-l/100*30),"fps"),d.innerHTML='<span style="font-weight:bold">'+l+" FPS</span> ("+c+"-"+h+")",f.putImageData(m,0,0),3==i&&(S=9.54e-7*performance.memory.usedJSHeapSize,_=Math.min(_,S),M=Math.max(M,S),t(A.data,Math.min(30,30-S/2),"mb"),k.innerHTML='<span style="font-weight:bold">'+Math.round(S)+" MB</span> ("+Math.round(_)+"-"+Math.round(M)+")",N.putImageData(A,0,0)),s=a,o=0)}}};Constants={},Constants.PI=Math.PI,Constants.C_PR=Math.PI/180,Constants.VLEV=2,Constants.EPS=1e-7,Constants.c=.105,Constants.LN10=Math.log(10),Constants.PIOVER2=Math.PI/2,Constants.TWOPI=2*Math.PI,Constants.TWOTHIRD=2/3,Constants.ARCSECOND_RADIAN=484813681109536e-20,SpatialVector=function(){function t(t,e,i){"use strict";this.x=t,this.y=e,this.z=i,this.ra_=0,this.dec_=0,this.okRaDec_=!1}return t.prototype.setXYZ=function(t,e,i){this.x=t,this.y=e,this.z=i,this.okRaDec_=!1},t.prototype.length=function(){"use strict";return Math.sqrt(this.lengthSquared())},t.prototype.lengthSquared=function(){"use strict";return this.x*this.x+this.y*this.y+this.z*this.z},t.prototype.normalized=function(){"use strict";var t=this.length();this.x/=t,this.y/=t,this.z/=t},t.prototype.set=function(t,e){"use strict";this.ra_=t,this.dec_=e,this.okRaDec_=!0,this.updateXYZ()},t.prototype.angle=function(t){"use strict";var e=this.y*t.z-this.z*t.y,i=this.z*t.x-this.x*t.z,r=this.x*t.y-this.y*t.x,o=Math.sqrt(e*e+i*i+r*r);return Math.abs(Math.atan2(o,dot(t)))},t.prototype.get=function(){"use strict";return[x,y,z]},t.prototype.toString=function(){"use strict";return"SpatialVector["+this.x+", "+this.y+", "+this.z+"]"},t.prototype.cross=function(e){"use strict";return new t(this.y*e.z-e.y*this.z,this.z*e.x-e.z*this.x,this.x*e.y-e.x()*this.y)},t.prototype.equal=function(t){"use strict";return this.x==t.x&&this.y==t.y&&this.z==t.z()},t.prototype.mult=function(e){"use strict";return new t(e*this.x,e*this.y,e*this.z)},t.prototype.dot=function(t){"use strict";return this.x*t.x+this.y*t.y+this.z*t.z},t.prototype.add=function(e){"use strict";return new t(this.x+e.x,this.y+e.y,this.z+e.z)},t.prototype.sub=function(e){"use strict";return new t(this.x-e.x,this.y-e.y,this.z-e.z)},t.prototype.dec=function(){"use strict";return this.okRaDec_||(this.normalized(),this.updateRaDec()),this.dec_},t.prototype.ra=function(){"use strict";return this.okRaDec_||(this.normalized(),this.updateRaDec()),this.ra_},t.prototype.updateXYZ=function(){"use strict";var t=Math.cos(this.dec_*Constants.C_PR);this.x=Math.cos(this.ra_*Constants.C_PR)*t,this.y=Math.sin(this.ra_*Constants.C_PR)*t,this.z=Math.sin(this.dec_*Constants.C_PR)},t.prototype.updateRaDec=function(){"use strict";this.dec_=Math.asin(this.z)/Constants.C_PR;var t=Math.cos(this.dec_*Constants.C_PR);this.ra_=t>Constants.EPS||-Constants.EPS>t?this.y>Constants.EPS||this.y<-Constants.EPS?0>this.y?360-Math.acos(this.x/t)/Constants.C_PR:Math.acos(this.x/t)/Constants.C_PR:0>this.x?180:0:0,this.okRaDec_=!0},t.prototype.toRaRadians=function(){"use strict";var t=0;return(0!=this.x||0!=this.y)&&(t=Math.atan2(this.y,this.x)),0>t&&(t+=2*Math.PI),t},t.prototype.toDeRadians=function(){var t=z/this.length(),e=Math.acos(t);return Math.PI/2-e},t}(),AngularPosition=function(){return AngularPosition=function(t,e){"use strict";this.theta=t,this.phi=e},AngularPosition.prototype.toString=function(){"use strict";return"theta: "+this.theta+", phi: "+this.phi},AngularPosition}(),LongRangeSetBuilder=function(){function t(){this.items=[]}return t.prototype.appendRange=function(t,e){for(var i=t;e>=i;i++)i in this.items||this.items.push(i)},t}(),HealpixIndex=function(){function t(t){"use strict";this.nside=t}return t.NS_MAX=8192,t.ORDER_MAX=13,t.NSIDELIST=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192],t.JRLL=[2,2,2,2,3,3,3,3,4,4,4,4],t.JPLL=[1,3,5,7,0,2,4,6,1,3,5,7],t.XOFFSET=[-1,-1,0,1,1,1,0,-1],t.YOFFSET=[0,1,1,1,0,-1,-1,-1],t.FACEARRAY=[[8,9,10,11,-1,-1,-1,-1,10,11,8,9],[5,6,7,4,8,9,10,11,9,10,11,8],[-1,-1,-1,-1,5,6,7,4,-1,-1,-1,-1],[4,5,6,7,11,8,9,10,11,8,9,10],[0,1,2,3,4,5,6,7,8,9,10,11],[1,2,3,0,0,1,2,3,5,6,7,4],[-1,-1,-1,-1,7,4,5,6,-1,-1,-1,-1],[3,0,1,2,3,0,1,2,4,5,6,7],[2,3,0,1,-1,-1,-1,-1,0,1,2,3]],t.SWAPARRAY=[[0,0,0,0,0,0,0,0,3,3,3,3],[0,0,0,0,0,0,0,0,6,6,6,6],[0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,5,5,5,5],[0,0,0,0,0,0,0,0,0,0,0,0],[5,5,5,5,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0],[6,6,6,6,0,0,0,0,0,0,0,0],[3,3,3,3,0,0,0,0,0,0,0,0]],t.Z0=Constants.TWOTHIRD,t.prototype.init=function(){"use strict";var e=256;this.ctab=Array(e),this.utab=Array(e);for(var i=0;256>i;++i)this.ctab[i]=1&i|(2&i)<<7|(4&i)>>1|(8&i)<<6|(16&i)>>2|(32&i)<<5|(64&i)>>3|(128&i)<<4,this.utab[i]=1&i|(2&i)<<1|(4&i)<<2|(8&i)<<3|(16&i)<<4|(32&i)<<5|(64&i)<<6|(128&i)<<7;this.nl2=2*this.nside,this.nl3=3*this.nside,this.nl4=4*this.nside,this.npface=this.nside*this.nside,this.ncap=2*this.nside*(this.nside-1),this.npix=12*this.npface,this.fact2=4/this.npix,this.fact1=(this.nside<<1)*this.fact2,this.order=t.nside2order(this.nside)},t.calculateNSide=function(e){for(var i=0,r=e*e,o=180/Constants.PI,a=5184e4*Constants.PI*o*o,n=Utils.castToInt(a/r),s=n/12,l=Math.sqrt(s),c=t.NS_MAX,h=0,u=0;t.NSIDELIST.length>u;u++)if(c>=Math.abs(l-t.NSIDELIST[u])&&(c=Math.abs(l-t.NSIDELIST[u]),i=t.NSIDELIST[u],h=u),l>i&&t.NS_MAX>l&&(i=t.NSIDELIST[h+1]),l>t.NS_MAX)return console.log("nside cannot be bigger than "+t.NS_MAX),t.NS_MAX;return i},t.nside2order=function(e){"use strict";return(e&e-1)>0?-1:Utils.castToInt(t.log2(e))},t.log2=function(t){"use strict";return Math.log(t)/Math.log(2)},t.prototype.ang2pix_nest=function(e,i){"use strict";var r,o,a,n,s,l,c,h,u,d,p,f,m;if(i>=Constants.TWOPI&&(i-=Constants.TWOPI),0>i&&(i+=Constants.TWOPI),e>Constants.PI||0>e)throw{name:"Illegal argument",message:"theta must be between 0 and "+Constants.PI};if(i>Constants.TWOPI||0>i)throw{name:"Illegal argument",message:"phi must be between 0 and "+Constants.TWOPI};if(o=Math.cos(e),a=Math.abs(o),n=i/Constants.PIOVER2,t.Z0>=a){var g=this.nside*(.5+n),v=.75*this.nside*o,h=g-v,u=g+v;l=h>>this.order,c=u>>this.order,p=l==c?4==l?4:l+4:c>l?l:c+8,f=Utils.castToInt(u&this.nside-1),m=Utils.castToInt(this.nside-(h&this.nside-1)-1)}else{d=Utils.castToInt(n),d>=4&&(d=3),s=n-d;var y=this.nside*Math.sqrt(3*(1-a));h=Utils.castToInt(s*y),u=Utils.castToInt((1-s)*y),h=Math.min(t.NS_MAX-1,h),u=Math.min(t.NS_MAX-1,u),o>=0?(p=d,f=Utils.castToInt(this.nside-u-1),m=Utils.castToInt(this.nside-h-1)):(p=d+8,f=h,m=u)}return r=this.xyf2nest(f,m,p)},t.prototype.xyf2nest=function(t,e,i){"use strict";return(i<<2*this.order)+(this.utab[255&t]|this.utab[255&t>>8]<<16|this.utab[255&t>>16]<<32|this.utab[255&t>>24]<<48|this.utab[255&e]<<1|this.utab[255&e>>8]<<17|this.utab[255&e>>16]<<33|this.utab[255&e>>24]<<49)},t.prototype.nest2xyf=function(t){"use strict";var e={};e.face_num=t>>2*this.order;var i=t&this.npface-1,r=(93823560581120&i)>>16|(614882086624428e4&i)>>31|21845&i|(1431633920&i)>>15;return e.ix=this.ctab[255&r]|this.ctab[255&r>>8]<<4|this.ctab[255&r>>16]<<16|this.ctab[255&r>>24]<<20,i>>=1,r=(93823560581120&i)>>16|(614882086624428e4&i)>>31|21845&i|(1431633920&i)>>15,e.iy=this.ctab[255&r]|this.ctab[255&r>>8]<<4|this.ctab[255&r>>16]<<16|this.ctab[255&r>>24]<<20,e},t.prototype.pix2ang_nest=function(e){"use strict";if(0>e||e>this.npix-1)throw{name:"Illegal argument",message:"ipix out of range"};var i,r,o,a=this.nest2xyf(e),n=a.ix,s=a.iy,l=a.face_num,c=(t.JRLL[l]<<this.order)-n-s-1;this.nside>c?(i=c,r=1-i*i*this.fact2,o=0):c>this.nl3?(i=this.nl4-c,r=i*i*this.fact2-1,o=0):(i=this.nside,r=(this.nl2-c)*this.fact1,o=1&c-this.nside);var h=Math.acos(r),u=(t.JPLL[l]*i+n-s+1+o)/2;u>this.nl4&&(u-=this.nl4),1>u&&(u+=this.nl4);var d=(u-.5*(o+1))*(Constants.PIOVER2/i);return{theta:h,phi:d}},t.nside2Npix=function(e){"use strict";if(0>e||(e&-e)!=e||e>t.NS_MAX)throw{name:"Illegal argument",message:"nside should be >0, power of 2, <"+t.NS_MAX};var i=12*e*e;return i},t.prototype.xyf2ring=function(e,i,r){"use strict";var o,a,n,s=t.JRLL[r]*this.nside-e-i-1;this.nside>s?(o=s,n=2*o*(o-1),a=0):s>3*this.nside?(o=this.nl4-s,n=this.npix-2*(o+1)*o,a=0):(o=this.nside,n=this.ncap+(s-this.nside)*this.nl4,a=1&s-this.nside);var l=(t.JPLL[r]*o+e-i+1+a)/2;return l>this.nl4?l-=this.nl4:1>l&&(l+=this.nl4),n+l-1},t.prototype.nest2ring=function(t){"use strict";var e=this.nest2xyf(t),i=this.xyf2ring(e.ix,e.iy,e.face_num);return i},t.prototype.corners_nest=function(t,e){"use strict";var i=this.nest2ring(t);return this.corners_ring(i,e)},t.prototype.pix2ang_ring=function(t){"use strict";var e,i,r,o,a,n,s,l,c;if(0>t||t>this.npix-1)throw{name:"Illegal argument",message:"ipix out of range"};return n=t+1,this.ncap>=n?(l=n/2,c=Utils.castToInt(l),r=Utils.castToInt(Math.sqrt(l-Math.sqrt(c)))+1,o=n-2*r*(r-1),e=Math.acos(1-r*r*this.fact2),i=(o-.5)*Constants.PI/(2*r)):this.npix-this.ncap>t?(a=t-this.ncap,r=a/this.nl4+this.nside,o=a%this.nl4+1,s=(1&r+this.nside)>0?1:.5,e=Math.acos((this.nl2-r)*this.fact1),i=(o-s)*Constants.PI/this.nl2):(a=this.npix-t,r=Utils.castToInt(.5*(1+Math.sqrt(2*a-1))),o=4*r+1-(a-2*r*(r-1)),e=Math.acos(-1+Math.pow(r,2)*this.fact2),i=(o-.5)*Constants.PI/(2*r)),[e,i]},t.prototype.ring=function(t){"use strict";var e,i,r=0,o=t+1,a=0;return this.ncap>=o?(i=o/2,a=Utils.castToInt(i),r=Utils.castToInt(Math.sqrt(i-Math.sqrt(a)))+1):this.nl2*(5*this.nside+1)>=o?(e=Utils.castToInt(o-this.ncap-1),r=Utils.castToInt(e/this.nl4+this.nside)):(e=this.npix-o+1,i=e/2,a=Utils.castToInt(i),r=Utils.castToInt(Math.sqrt(i-Math.sqrt(a)))+1,r=this.nl4-r),r},t.prototype.integration_limits_in_costh=function(t){"use strict";var e,i,r,o;return o=1*this.nside,this.nside>=t?(i=1-Math.pow(t,2)/3/this.npface,r=1-Math.pow(t-1,2)/3/this.npface,e=t==this.nside?2*(this.nside-1)/3/o:1-Math.pow(t+1,2)/3/this.npface):this.nl3>t?(i=2*(2*this.nside-t)/3/o,r=2*(2*this.nside-t+1)/3/o,e=2*(2*this.nside-t-1)/3/o):(r=t==this.nl3?2*(-this.nside+1)/3/o:-1+Math.pow(4*this.nside-t+1,2)/3/this.npface,e=-1+Math.pow(this.nl4-t-1,2)/3/this.npface,i=-1+Math.pow(this.nl4-t,2)/3/this.npface),[r,i,e]},t.prototype.pixel_boundaries=function(t,e,i,r){var o,a,n,s,l,c,h,u,d=1*this.nside;if(Math.abs(r)>=1-1/3/this.npface)return h=i*Constants.PIOVER2,u=(i+1)*Constants.PIOVER2,[h,u];if(1.5*r>=1)o=Math.sqrt(3*(1-r)),a=1/d/o,n=e,s=n-1,l=t-e,c=l+1,h=Constants.PIOVER2*(Math.max(s*a,1-c*a)+i),u=Constants.PIOVER2*(Math.min(1-l*a,n*a)+i);else if(1.5*r>-1){var p=.5*(1-1.5*r),f=p+1,m=this.nside+t%2;n=e-(m-t)/2,s=n-1,l=(m+t)/2-e,c=l+1,h=Constants.PIOVER2*(Math.max(f-c/d,-p+s/d)+i),u=Constants.PIOVER2*(Math.min(f-l/d,-p+n/d)+i)}else{o=Math.sqrt(3*(1+r)),a=1/d/o;var g=2*this.nside;n=t-g+e,s=n-1,l=g-e,c=l+1,h=Constants.PIOVER2*(Math.max(1-(g-s)*a,(g-c)*a)+i),u=Constants.PIOVER2*(Math.min(1-(g-n)*a,(g-l)*a)+i)}return[h,u]},t.vector=function(t,e){"use strict";var i=1*Math.sin(t)*Math.cos(e),r=1*Math.sin(t)*Math.sin(e),o=1*Math.cos(t);return new SpatialVector(i,r,o)},t.prototype.corners_ring=function(e,i){"use strict";var r=2*i+2,o=Array(r),a=this.pix2ang_ring(e),n=Math.cos(a[0]),s=a[0],l=a[1],c=Utils.castToInt(l/Constants.PIOVER2),h=this.ring(e),u=Math.min(h,Math.min(this.nside,this.nl4-h)),d=0,p=Constants.PIOVER2/u;d=h>=this.nside&&this.nl3>=h?Utils.castToInt(l/p+h%2/2)+1:Utils.castToInt(l/p)+1,d-=c*u;var f=r/2,m=this.integration_limits_in_costh(h),g=Math.acos(m[0]),v=Math.acos(m[2]),y=this.pixel_boundaries(h,d,c,m[0]);if(o[0]=d>u/2?t.vector(g,y[1]):t.vector(g,y[0]),y=this.pixel_boundaries(h,d,c,m[2]),o[f]=d>u/2?t.vector(v,y[1]):t.vector(v,y[0]),1==i){var b=Math.acos(m[1]);y=this.pixel_boundaries(h,d,c,m[1]),o[1]=t.vector(b,y[0]),o[3]=t.vector(b,y[1])}else for(var x=m[2]-m[0],w=x/(i+1),C=1;i>=C;C++)n=m[0]+w*C,s=Math.acos(n),y=this.pixel_boundaries(h,d,c,n),o[C]=t.vector(s,y[0]),o[r-C]=t.vector(s,y[1]);return o},t.vec2Ang=function(t){"use strict";var e=t.z/t.length(),i=Math.acos(e),r=0;return(0!=t.x||0!=t.y)&&(r=Math.atan2(t.y,t.x)),0>r&&(r+=2*Math.PI),[i,r]},t.prototype.queryDisc=function(e,i,r,o){"use strict";if(0>i||i>Constants.PI)throw{name:"Illegal argument",message:"angular radius is in RADIAN and should be in [0,pi]"};var a,n,s,l,c,h,u,d,p,f,m,g,v,y,b,x,w,C,S,_=new LongRangeSetBuilder,M=null,c=i;if(o&&(c+=Constants.PI/this.nl4),M=t.vec2Ang(e),h=M[0],u=M[1],m=this.fact2,g=this.fact1,l=Math.cos(h),S=1/Math.sqrt((1-l)*(1+l)),y=h-c,b=h+c,d=Math.cos(c),w=Math.cos(y),a=this.ringAbove(w)+1,x=Math.cos(b),n=this.ringAbove(x),a>n&&0==n&&(n=a),0>=y)for(var T=1;a>T;++T)this.inRing(T,0,Math.PI,_);for(s=a;n>=s;++s)C=this.nside>s?1-s*s*m:this.nl3>=s?(this.nl2-s)*g:-1+(this.nl4-s)*(this.nl4-s)*m,p=(d-C*l)*S,f=1-C*C-p*p,v=Math.atan2(Math.sqrt(f),p),isNaN(v)&&(v=c),this.inRing(s,u,v,_);if(b>=Math.PI)for(var T=n+1;this.nl4>T;++T)this.inRing(T,0,Math.PI,_,!1);var k;if(r){for(var N=_.items,A=[],I=0;N.length>I;I++){var R=this.ring2nest(N[I]);A.indexOf(R)>=0||A.push(R)}k=A}else k=_.items;return k},t.prototype.inRing=function(t,e,i,r,o){"use strict";var a,n,s,l,c=!1,h=!1,u=1e-12,d=0,p=0,f=0,m=0,g=(e-i)%Constants.TWOPI-u,v=e+i+u,y=(e+i)%Constants.TWOPI+u;if(u>Math.abs(i-Constants.PI)&&(c=!0),t>=this.nside&&this.nl3>=t?(p=t-this.nside+1,s=this.ncap+this.nl4*(p-1),l=s+this.nl4-1,a=p%2,n=this.nl4):(this.nside>t?(p=t,s=2*p*(p-1),l=s+4*p-1):(p=4*this.nside-t,s=this.npix-2*p*(p+1),l=s+4*p-1),n=4*p,a=1),c)return void r.appendRange(s,l);if(d=a/2,o)f=Math.round(n*g/Constants.TWOPI-d),m=Math.round(n*v/Constants.TWOPI-d),f%=n,m>n&&(m%=n);else{if(f=Math.ceil(n*g/Constants.TWOPI-d),m=Utils.castToInt(n*y/Constants.TWOPI-d),f>m&&1==t&&(m=Utils.castToInt(n*v/Constants.TWOPI-d)),f==m+1&&(f=m),1==f-m&&Constants.PI>i*n)return void console.log("the interval is too small and avay from center");f=Math.min(f,n-1),m=Math.max(m,0)}if(f>m&&(h=!0),h)f+=s,m+=s,r.appendRange(s,m),r.appendRange(f,l);else{if(0>f)return f=Math.abs(f),r.appendRange(s,s+m),void r.appendRange(l-f+1,l);f+=s,m+=s,r.appendRange(f,m)}},t.prototype.ringAbove=function(t){"use strict";var e=Math.abs(t);if(e>Constants.TWOTHIRD){var i=Utils.castToInt(this.nside*Math.sqrt(3*(1-e)));return t>0?i:4*this.nside-i-1}return Utils.castToInt(this.nside*(2-1.5*t))},t.prototype.ring2nest=function(t){"use strict";var e=this.ring2xyf(t);return this.xyf2nest(e.ix,e.iy,e.face_num)},t.prototype.ring2xyf=function(e){"use strict";var i,r,o,a,n={};if(this.ncap>e){i=Utils.castToInt(.5*(1+Math.sqrt(1+2*e))),r=e+1-2*i*(i-1),o=0,a=i,n.face_num=0;var s=r-1;s>=2*i&&(n.face_num=2,s-=2*i),s>=i&&++n.face_num}else if(this.npix-this.ncap>e){var l=e-this.ncap;this.order>=0?(i=(l>>this.order+2)+this.nside,r=(l&this.nl4-1)+1):(i=l/this.nl4+this.nside,r=l%this.nl4+1),o=1&i+this.nside,a=this.nside;var c,h,u=i-this.nside+1,d=this.nl2+2-u;this.order>=0?(c=r-Utils.castToInt(u/2)+this.nside-1>>this.order,h=r-Utils.castToInt(d/2)+this.nside-1>>this.order):(c=(r-Utils.castToInt(u/2)+this.nside-1)/this.nside,h=(r-Utils.castToInt(d/2)+this.nside-1)/this.nside),n.face_num=h==c?4==h?4:Utils.castToInt(h)+4:c>h?Utils.castToInt(h):Utils.castToInt(c)+8}else{var l=this.npix-e;i=Utils.castToInt(.5*(1+Math.sqrt(2*l-1))),r=4*i+1-(l-2*i*(i-1)),o=0,a=i,i=2*this.nl2-i,n.face_num=8;var s=r-1;s>=2*a&&(n.face_num=10,s-=2*a),s>=a&&++n.face_num}var p=i-t.JRLL[n.face_num]*this.nside+1,f=2*r-t.JPLL[n.face_num]*a-o-1;return f>=this.nl2&&(f-=8*this.nside),n.ix=f-p>>1,n.iy=-(f+p)>>1,n},t}(),Utils=function(){},Utils.radecToPolar=function(t,e){return{theta:Math.PI/2-e/180*Math.PI,phi:t/180*Math.PI}},Utils.polarToRadec=function(t,e){return{ra:180*e/Math.PI,dec:180*(Math.PI/2-t)/Math.PI}},Utils.castToInt=function(t){return t>0?Math.floor(t):Math.ceil(t)},AstroMath.D2R=Math.PI/180,AstroMath.R2D=180/Math.PI,AstroMath.sign=function(t){return t>0?1:t<0?-1:0},AstroMath.cosd=function(t){if(t%90==0){var e=Math.abs(Math.floor(t/90+.5))%4;switch(e){case 0:return 1;case 1:return 0;case 2:return-1;case 3:return 0}}return Math.cos(t*AstroMath.D2R)},AstroMath.sind=function(t){if(t%90===0){var e=Math.abs(Math.floor(t/90-.5))%4;switch(e){case 0:return 1;case 1:return 0;case 2:return-1;case 3:return 0}}return Math.sin(t*AstroMath.D2R)},AstroMath.tand=function(t){var e;return e=t%360,0==e||180==Math.abs(e)?0:45==e||225==e?1:e==-135||e==-315?-1:Math.tan(t*AstroMath.D2R)},AstroMath.asind=function(t){return Math.asin(t)*AstroMath.R2D},AstroMath.acosd=function(t){return Math.acos(t)*AstroMath.R2D},AstroMath.atand=function(t){return Math.atan(t)*AstroMath.R2D},AstroMath.atan2=function(t,e){if(0==t)return e>0?0:e<0?Math.PI:NaN;var i=AstroMath.sign(t);if(0==e)return Math.PI/2*i;var r=Math.atan(Math.abs(t/e));return e>0?r*i:e<0?(Math.PI-r)*i:void 0},AstroMath.atan2d=function(t,e){return AstroMath.atan2(t,e)*AstroMath.R2D},AstroMath.cosh=function(t){return(Math.exp(t)+Math.exp(-t))/2},AstroMath.sinh=function(t){return(Math.exp(t)-Math.exp(-t))/2},AstroMath.tanh=function(t){return(Math.exp(t)-Math.exp(-t))/(Math.exp(t)+Math.exp(-t))},AstroMath.acosh=function(t){return Math.log(t+Math.sqrt(t*t-1))},AstroMath.asinh=function(t){return Math.log(t+Math.sqrt(t*t+1))},AstroMath.atanh=function(t){return.5*Math.log((1+t)/(1-t))},AstroMath.sinc=function(t){var e=Math.abs(t),i;return e<=.001?(e*=e,i=1-e*(1-e/20)/6):i=Math.sin(e)/e,i},AstroMath.asinc=function(t){var e=Math.abs(t),i;return e<=.001?(e*=e,i=1+e*(6+.45*e)/6):i=Math.asin(e)/e,i},AstroMath.hypot=function(t,e){return Math.sqrt(t*t+e*e)},AstroMath.eulerMatrix=function(t,e,i){var r=new Array(3);r[0]=new Array(3),r[1]=new Array(3),r[2]=new Array(3);var o=AstroMath.cosd(t),a=AstroMath.sind(t),n=AstroMath.cosd(e),s=AstroMath.sind(e),l=AstroMath.cosd(i),c=AstroMath.sind(i);return r[0][0]=l*n*o-c*a,r[0][1]=-c*n*o-l*a,r[0][2]=-s*o,r[1][0]=l*n*a+c*o,r[1][1]=-c*n*a+l*o,r[1][2]=-s*a,r[2][0]=-s*l,r[2][1]=-s*o,r[2][2]=n,r},AstroMath.displayMatrix=function(t){for(var e=t.length,i=0,r=0;r<e;r++)t[r].length>i&&(i=t[r].length);for(var o="<table>\n",r=0;r<e;r++){o+="<tr>";for(var a=0;a<e;a++)o+="<td>",r<t[r].length&&(o+=t[r][a].toString()),o+="</td>";o+="</td>\n"}return o+="</table>\n"},Projection.PROJ_TAN=1,Projection.PROJ_TAN2=2,Projection.PROJ_STG=2,Projection.PROJ_SIN=3,Projection.PROJ_SIN2=4,Projection.PROJ_ZEA=4,Projection.PROJ_ARC=5,Projection.PROJ_SCHMIDT=5,Projection.PROJ_AITOFF=6,Projection.PROJ_AIT=6,Projection.PROJ_GLS=7,Projection.PROJ_MERCATOR=8,Projection.PROJ_MER=8,Projection.PROJ_LAM=9,Projection.PROJ_LAMBERT=9,Projection.PROJ_TSC=10,Projection.PROJ_QSC=11,Projection.PROJ_LIST=["Mercator",Projection.PROJ_MERCATOR,"Gnomonic",Projection.PROJ_TAN,"Stereographic",Projection.PROJ_TAN2,"Orthographic",Projection.PROJ_SIN,"Zenithal",Projection.PROJ_ZEA,"Schmidt",Projection.PROJ_SCHMIDT,"Aitoff",Projection.PROJ_AITOFF,"Lambert",Projection.PROJ_LAMBERT],Projection.PROJ_NAME=["-","Gnomonic","Stereographic","Orthographic","Equal-area","Schmidt plates","Aitoff","Global sin","Mercator","Lambert"],Projection.prototype={setCenter:function(t,e){this.ROT=this.tr_oR(t,e)},setProjection:function(t){this.PROJECTION=t},project:function(t,e){var i=this.tr_ou(t,e),r=this.tr_uu(i,this.ROT),o=this.tr_up(this.PROJECTION,r);return null==o?null:{X:-o[0],Y:-o[1]}},unproject:function(t,e){t=-t,e=-e;var i=this.tr_pu(this.PROJECTION,t,e),r=this.tr_uu1(i,this.ROT),o=this.tr_uo(r);return{ra:o[0],dec:o[1]}},tr_up:function(t,e){var i=e[0],r=e[1],o=e[2],a,n,s,l,c;if(a=AstroMath.hypot(i,r),
0==a&&0==o)return null;switch(t){default:s=null;break;case Projection.PROJ_AITOFF:n=Math.sqrt(a*(a+i)/2),l=Math.sqrt(2*a*(a-i)),n=Math.sqrt((1+n)/2),l/=n,c=o/n,r<0&&(l=-l),s=[l,c];break;case Projection.PROJ_GLS:c=Math.asin(o),l=0!=a?Math.atan2(r,i)*a:0,s=[l,c];break;case Projection.PROJ_MERCATOR:0!=a?(l=Math.atan2(r,i),c=AstroMath.atanh(o),s=[l,c]):s=null;break;case Projection.PROJ_TAN:i>0?(l=r/i,c=o/i,s=[l,c]):s=null;break;case Projection.PROJ_TAN2:n=(1+i)/2,n>0?(l=r/n,c=o/n,s=[l,c]):s=null;break;case Projection.PROJ_ARC:i<=-1?(l=Math.PI,c=0):(a=AstroMath.hypot(r,o),n=i>0?AstroMath.asinc(a):Math.acos(i)/a,l=r*n,c=o*n),s=[l,c];break;case Projection.PROJ_SIN:i>=0?(l=r,c=o,s=[l,c]):s=null;break;case Projection.PROJ_SIN2:n=Math.sqrt((1+i)/2),0!=n?(l=r/n,c=o/n):(l=2,c=0),s=[l,c];break;case Projection.PROJ_LAMBERT:c=o,l=0,0!=a&&(l=Math.atan2(r,i)),s=[l,c]}return s},tr_pu:function(t,e,i){var r,o,a,n,s;switch(t){default:return null;case Projection.PROJ_AITOFF:if(r=e*e/8+i*i/2,r>1)return null;a=1-r,o=Math.sqrt(1-r/2),n=e*o/2,s=i*o,r=AstroMath.hypot(a,n),0!=r&&(o=a,a=(o*o-n*n)/r,n=2*o*n/r);break;case Projection.PROJ_GLS:if(s=Math.sin(i),r=1-s*s,r<0)return null;r=Math.sqrt(r),o=0!=r?e/r:0,a=r*Math.cos(o),n=r*Math.sin(o);break;case Projection.PROJ_MERCATOR:s=AstroMath.tanh(i),r=1/AstroMath.cosh(i),a=r*Math.cos(e),n=r*Math.sin(e);break;case Projection.PROJ_LAMBERT:if(s=i,r=1-s*s,r<0)return null;r=Math.sqrt(r),a=r*Math.cos(e),n=r*Math.sin(e);break;case Projection.PROJ_TAN:a=1/Math.sqrt(1+e*e+i*i),n=e*a,s=i*a;break;case Projection.PROJ_TAN2:r=(e*e+i*i)/4,o=1+r,a=(1-r)/o,n=e/o,s=i/o;break;case Projection.PROJ_ARC:if(r=AstroMath.hypot(e,i),r>Math.PI)return null;o=AstroMath.sinc(r),a=Math.cos(r),n=o*e,s=o*i;break;case Projection.PROJ_SIN:if(o=1-e*e-i*i,o<0)return null;a=Math.sqrt(o),n=e,s=i;break;case Projection.PROJ_SIN2:if(r=(e*e+i*i)/4,r>1)return null;o=Math.sqrt(1-r),a=1-2*r,n=o*e,s=o*i}return[a,n,s]},tr_oR:function(t,e){var i=new Array(3);return i[0]=new Array(3),i[1]=new Array(3),i[2]=new Array(3),i[2][2]=AstroMath.cosd(e),i[0][2]=AstroMath.sind(e),i[1][1]=AstroMath.cosd(t),i[1][0]=-AstroMath.sind(t),i[1][2]=0,i[0][0]=i[2][2]*i[1][1],i[0][1]=-i[2][2]*i[1][0],i[2][0]=-i[0][2]*i[1][1],i[2][1]=i[0][2]*i[1][0],i},tr_ou:function(t,e){var i=new Array(3),r=AstroMath.cosd(e);return i[0]=r*AstroMath.cosd(t),i[1]=r*AstroMath.sind(t),i[2]=AstroMath.sind(e),i},tr_uu:function(t,e){var i=new Array(3),r=t[0],o=t[1],a=t[2];return i[0]=e[0][0]*r+e[0][1]*o+e[0][2]*a,i[1]=e[1][0]*r+e[1][1]*o+e[1][2]*a,i[2]=e[2][0]*r+e[2][1]*o+e[2][2]*a,i},tr_uu1:function(t,e){var i=new Array(3),r=t[0],o=t[1],a=t[2];return i[0]=e[0][0]*r+e[1][0]*o+e[2][0]*a,i[1]=e[0][1]*r+e[1][1]*o+e[2][1]*a,i[2]=e[0][2]*r+e[1][2]*o+e[2][2]*a,i},tr_uo:function(t){var e=t[0],i=t[1],r=t[2],o=e*e+i*i,a,n;if(0==o){if(0==r)return null;a=0,n=r>0?90:-90}else n=AstroMath.atand(r/Math.sqrt(o)),a=AstroMath.atan2d(i,e),a<0&&(a+=360);return[a,n]}},Coo.factor=[3600,60,1],Coo.prototype={setFrame:function(t){this.frame=t},computeDirCos:function(){var t=AstroMath.cosd(this.lat);this.x=t*AstroMath.cosd(this.lon),this.y=t*AstroMath.sind(this.lon),this.z=AstroMath.sind(this.lat)},computeLonLat:function(){var t=this.x*this.x+this.y*this.y;this.lon=0,0==t?0==this.z?(this.lon=NaN,this.lat=NaN):this.lat=this.z>0?90:-90:(this.lon=AstroMath.atan2d(this.y,this.x),this.lat=AstroMath.atan2d(this.z,Math.sqrt(t)),this.lon<0&&(this.lon+=360))},dist2:function(t){var e=t.x-this.x,i=e*e;return e=t.y-this.y,i+=e*e,e=t.z-this.z,i+=e*e},distance:function(t){return 0==t.x&&0==t.y&&0==t.z?NaN:0==this.x&&0==this.y&&0==this.z?NaN:2*AstroMath.asind(.5*Math.sqrt(this.dist2(t)))},convertTo:function(t){this.frame.equals(t)||(this.frame.toICRS(this.coo),t.fromICRS(this.coo),this.frame=t,this.lon=this.lat=NaN)},rotate:function(t){var e,i,r;t!=Umatrix3&&(e=t[0][0]*this.x+t[0][1]*this.y+t[0][2]*this.z,i=t[1][0]*this.x+t[1][1]*this.y+t[1][2]*this.z,r=t[2][0]*this.x+t[2][1]*this.y+t[2][2]*this.z,this.x=e,this.y=i,this.z=r,this.lon=this.lat=NaN)},rotate_1:function(t){var e,i,r;t!=Umatrix3&&(e=t[0][0]*this.x+t[1][0]*this.y+t[2][0]*this.z,i=t[0][1]*this.x+t[1][1]*this.y+t[2][1]*this.z,r=t[0][2]*this.x+t[1][2]*this.y+t[2][2]*this.z,this.x=e,this.y=i,this.z=r,this.lon=this.lat=NaN)},equals:function(t){return this.x==t.x&&this.y==t.y&&this.z==t.z},parse:function(t){var e=t.indexOf("+");if(e<0&&(e=t.indexOf("-")),e<0&&(e=t.indexOf(" ")),e<0)return this.lon=NaN,this.lat=NaN,this.prec=0,!1;var i=t.substring(0,e),r=t.substring(e);return this.lon=this.parseLon(i),this.lat=this.parseLat(r),!0},parseLon:function(t){var t=t.trim();if(t=t.replace(/:/g," "),t.indexOf(" ")<0){var e=t.indexOf(".");return this.prec=e<0?0:t.length-e-1,parseFloat(t)}for(var i=new Tokenizer(t," "),r=0,o=0,a=0;i.hasMore();){var n=i.nextToken(),s=n.indexOf(".");switch(o+=parseFloat(n)*Coo.factor[r],r){case 0:a=s<0?1:2;break;case 1:a=s<0?3:4;break;case 2:a=s<0?5:4+n.length-s}r++}return this.prec=a,15*o/3600},parseLat:function(t){var t=t.trim();t=t.replace(/:/g," ");var e;if("-"==t.charAt(0)?(e=-1,t=t.substring(1)):"-"==t.charAt(0)?(e=1,t=t.substring(1)):e=1,t.indexOf(" ")<0){var i=t.indexOf(".");return this.prec=i<0?0:t.length-i-1,parseFloat(t)*e}for(var r=new Tokenizer(t," "),o=0,a=0,n=0;r.hasMore();){var s=r.nextToken(),l=s.indexOf(".");switch(a+=parseFloat(s)*Coo.factor[o],o){case 0:n=l<0?1:2;break;case 1:n=l<0?3:4;break;case 2:n=l<0?5:4+s.length-l}o++}return this.prec=n,a*e/3600},format:function(t){isNaN(this.lon)&&this.computeLonLat();var e="",i="";if(t.indexOf("d")>=0)e=Numbers.format(this.lon,this.prec),i=Numbers.format(this.lat,this.prec);else var r=this.lon/15,e=Numbers.toSexagesimal(r,this.prec+1,!1),i=Numbers.toSexagesimal(this.lat,this.prec,!1);return this.lat>0&&(i="+"+i),t.indexOf("/")>=0?e+" "+i:t.indexOf("2")>=0?[e,i]:e+i}},Tokenizer.prototype={hasMore:function(){return this.pos<this.string.length},nextToken:function(){for(var t=this.pos;t<this.string.length&&this.string.charAt(t)==this.sep;)t++;for(var e=t;e<this.string.length&&this.string.charAt(e)!=this.sep;)e++;return this.pos=e,this.string.substring(t,e)}},Strings.trim=function(t,e){for(var i=0,r=t.length-1;i<t.length&&t.charAt(i)==e;)i++;if(i==t.length)return"";for(;r>i&&t.charAt(r)==e;)r--;return t.substring(i,r+1)},Numbers.pow10=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13,1e14],Numbers.rndval=[.5,.05,.005,5e-4,5e-5,5e-6,5e-7,5e-8,5e-9,5e-10,5e-11,5e-12,5e-13,5e-14,5e-14],Numbers.format=function(t,e){if(e<=0)return Math.round(t).toString();var i=t.toString(),r=i.indexOf("."),o=r>=0?i.length-r-1:0;if(e>=o){r<0&&(i+=".");for(var a=0;a<e-o;a++)i+="0";return i}return i=(t+Numbers.rndval[e]).toString(),i.substr(0,r+e+1)},Numbers.toSexagesimal=function(t,e,i){var r="",o=t<0?"-":i?"+":"",a=Math.abs(t);switch(e){case 1:var n=Math.round(a);return o+n.toString();case 2:return o+Numbers.format(a,1);case 3:var n=Math.floor(a),s=Math.round(60*(a-n));return o+n+" "+s;case 4:var n=Math.floor(a),s=60*(a-n);return o+n+" "+Numbers.format(s,1);case 5:var n=Math.floor(a),s=60*(a-n),l=Math.floor(s),c=Math.round(60*(s-l));return o+n+" "+l+" "+c;case 6:case 7:case 8:var n=Math.floor(a);n<10&&(n="0"+n);var s=60*(a-n),l=Math.floor(s);l<10&&(l="0"+l);var c=60*(s-l);return o+n+" "+l+" "+Numbers.format(c,e-5);default:return o+Numbers.format(a,1)}},CooConversion=function(){var t={};return t.GALACTIC_TO_J2000=[-.0548755604024359,.4941094279435681,-.867666148981161,-.8734370902479237,-.4448296299195045,-.1980763734646737,-.4838350155267381,.7469822444763707,.4559837762325372],t.J2000_TO_GALACTIC=[-.0548755604024359,-.873437090247923,-.4838350155267381,.4941094279435681,-.4448296299195045,.7469822444763707,-.867666148981161,-.1980763734646737,.4559837762325372],t.Transform=function(t,e){t[0]=t[0]*Math.PI/180,t[1]=t[1]*Math.PI/180;var i=new Array(Math.cos(t[0])*Math.cos(t[1]),Math.sin(t[0])*Math.cos(t[1]),Math.sin(t[1])),r=new Array(i[0]*e[0]+i[1]*e[1]+i[2]*e[2],i[0]*e[3]+i[1]*e[4]+i[2]*e[5],i[0]*e[6]+i[1]*e[7]+i[2]*e[8]),o=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]),a=new Array(0,0);a[1]=Math.asin(r[2]/o);var n=r[0]/o/Math.cos(a[1]),s=r[1]/o/Math.cos(a[1]);return a[0]=Math.atan2(s,n),a[0]<0&&(a[0]=a[0]+2*Math.PI),a[0]=180*a[0]/Math.PI,a[1]=180*a[1]/Math.PI,a},t.GalacticToJ2000=function(e){return t.Transform(e,t.GALACTIC_TO_J2000)},t.J2000ToGalactic=function(e){return t.Transform(e,t.J2000_TO_GALACTIC)},t}(),Sesame=function(){return Sesame={},Sesame.cache={},Sesame.resolve=function(t,e,i){var r="http://cds.u-strasbg.fr/cgi-bin/nph-sesame.jsonp?";$.ajax({url:r,data:{object:t},method:"GET",dataType:"jsonp",success:function(t){t.Target&&t.Target.Resolver&&t.Target.Resolver?e(t):i(t)},error:i})},Sesame}(),HealpixCache=function(){var t={};return t.staticCache={corners:{nside8:[]}},t.dynamicCache={},t.lastNside=8,t.hpxIdxCache=null,t.init=function(){var e=new HealpixIndex(8);e.init();for(var i=HealpixIndex.nside2Npix(8),r=0;r<i;r++)t.staticCache.corners.nside8[r]=e.corners_nest(r,1);t.hpxIdxCache=e},t.corners_nest=function(e,i){return 8==i?t.staticCache.corners.nside8[e]:(i!=t.lastNside&&(t.hpxIdxCache=new HealpixIndex(i),t.hpxIdxCache.init(),t.lastNside=i),t.hpxIdxCache.corners_nest(e,1))},t}(),Utils=Utils||{},Utils.cssScale=void 0,HTMLCanvasElement.prototype.relMouseCoords=relMouseCoords,Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=[].slice,i=e.call(arguments,1),r=this,o=function(){},a=function(){return r.apply(this instanceof o?this:t||{},i.concat(e.call(arguments)))};return a.prototype=this.prototype,a}),$=$||jQuery,$.urlParam=function(t,e){return void 0===e&&(e=location.search),decodeURIComponent((new RegExp("[?|&]"+t+"=([^&;]+?)(&|#|;|$)").exec(e)||[,""])[1].replace(/\+/g,"%20"))||null},Utils.isNumber=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},Utils.debounce=function(t,e){var i=null;return function(){var r=this,o=arguments;clearTimeout(i),i=setTimeout(function(){t.apply(r,o)},e)}},Utils.LRUCache=function(t){this._keys=[],this._items={},this._expires={},this._size=0,this._maxsize=t||1024},Utils.LRUCache.prototype={set:function(t,e){var i=this._keys,r=this._items,o=this._expires,a=this._size,n=this._maxsize;a>=n&&(i.sort(function(t,e){return o[t]>o[e]?-1:o[t]<o[e]?1:0}),a--,delete o[i[a]],delete r[i[a]]),i[a]=t,r[t]=e,o[t]=Date.now(),a++,this._keys=i,this._items=r,this._expires=o,this._size=a},get:function(t){var e=this._items[t];return e&&(this._expires[t]=Date.now()),e},keys:function(){return this._keys}},Color={},Color.curIdx=0,Color.colors=["#ff0000","#0000ff","#99cc00","#ffff00","#000066","#00ffff","#9900cc","#0099cc","#cc9900","#cc0099","#00cc99","#663333","#ffcc9a","#ff9acc","#ccff33","#660000","#ffcc33","#ff00ff","#00ff00","#ffffff"],Color.getNextColor=function(){var t=Color.colors[Color.curIdx%Color.colors.length];return Color.curIdx++,t},AladinUtils=function(){return{xyToView:function(t,e,i,r,o,a,n){return void 0==n&&(n=!1),n?{vx:o/2*(1+a*t)-(o-i)/2,vy:o/2*(1+a*e)-(o-r)/2}:{vx:AladinUtils.myRound(o/2*(1+a*t)-(o-i)/2),vy:AladinUtils.myRound(o/2*(1+a*e)-(o-r)/2)}},viewToXy:function(t,e,i,r,o,a){return{x:((2*t+(o-i))/o-1)/a,y:((2*e+(o-r))/o-1)/a}},radecToViewXy:function(t,e,i,r,o,a,n,s){var l;if(r!=CooFrameEnum.J2000){var c=CooConversion.J2000ToGalactic([t,e]);l=i.project(c[0],c[1])}else l=i.project(t,e);return l?AladinUtils.xyToView(l.X,l.Y,o,a,n,s,!0):null},myRound:function(t){return t<0?-1*(0|-t):0|t},isHpxPixVisible:function(t,e,i){for(var r=0;r<t.length;r++)if(t[r].vx>=-20&&t[r].vx<e+20&&t[r].vy>=-20&&t[r].vy<i+20)return!0;return!1},ipixToIpix:function(t,e,i){var r=[]},getZoomFactorForAngle:function(t,e){var i={ra:0,dec:0},r={ra:t,dec:0},o=new Projection(t/2,0);o.setProjection(e);var a=o.project(i.ra,i.dec),n=o.project(r.ra,r.dec),s=1/(a.X-n.Y);return s}}}(),ProjectionEnum={SIN:Projection.PROJ_SIN,AITOFF:Projection.PROJ_AITOFF},CooFrameEnum=function(){return{J2000:"J2000",GAL:"Galactic"}}(),CooFrameEnum.fromString=function(t,e){return t?(t=t.toLowerCase().replace(/^\s+|\s+$/g,""),0==t.indexOf("j2000")||0==t.indexOf("icrs")?CooFrameEnum.J2000:0==t.indexOf("gal")?CooFrameEnum.GAL:e?e:null):e?e:null},CooFrameEnum.shortName=function(t){return t==CooFrameEnum.J2000?"J2000":t==CooFrameEnum.GAL?"GAL":null},Downloader=function(){var t=4,e=!1,i=700,r=function(t){this.view=t,this.nbDownloads=0,this.dlQueue=[],this.urlsInQueue={}};return r.prototype.requestDownload=function(t,e,i){e in this.urlsInQueue||(this.dlQueue.push({img:t,url:e,cors:i}),this.urlsInQueue[e]=1,this.tryDownload())},r.prototype.tryDownload=function(){for(;this.dlQueue.length>0&&this.nbDownloads<t;)this.startDownloadNext()},r.prototype.startDownloadNext=function(){var t=this.dlQueue.shift();if(t){this.nbDownloads++;var e=this;t.img.onload=function(){e.completeDownload(this,!0)},t.img.onerror=function(t){e.completeDownload(this,!1)},t.cors?t.img.crossOrigin="anonymous":void 0!==t.img.crossOrigin&&delete t.img.crossOrigin,t.img.src=t.url}},r.prototype.completeDownload=function(t,r){if(delete this.urlsInQueue[t.src],t.onerror=null,t.onload=null,this.nbDownloads--,r){if(e){var o=(new Date).getTime();t.fadingStart=o,t.fadingEnd=o+i}this.view.requestRedraw()}else t.dlError=!0;this.tryDownload()},r}(),CooGrid=function(){function t(t,e,i,r,o,a,n){var s=AladinUtils.viewToXy(e,i,r,o,a,n),l;try{l=t.unproject(s.x,s.y)}catch(t){return null}return{lon:l.ra,lat:l.dec}}var e=function(){},i=10,r=10;return e.prototype.redraw=function(e,i,r,o,a,n,s,l){if(!(l>60)){var c=0,h=359.9999,u=-90,d=90,p=t(i,0,0,o,a,n,s),f=t(i,o-1,a-1,o,a,n,s);h=Math.min(p.lon,f.lon),c=Math.max(p.lon,f.lon),d=Math.min(p.lat,f.lat),u=Math.max(p.lat,f.lat);var m=t(i,0,a-1,o,a,n,s);h=Math.min(h,m.lon),c=Math.max(c,m.lon),d=Math.min(d,m.lat),u=Math.max(u,m.lat);var g=t(i,o-1,0,o,a,n,s);h=Math.min(h,g.lon),c=Math.max(c,g.lon),d=Math.min(d,g.lat),u=Math.max(u,g.lat);var v=c-h,y=u-d,b,x;l>10?(b=4,x=4):l>1?(b=1,x=1):l>.1?(b=.1,x=.1):(b=.01,x=.01);var w=Math.round(h%b)*b,C=Math.round(d%x)*x;e.lineWidth=1,e.strokeStyle="rgb(120,120,255)";for(var S=C;S<u+x;S+=x){e.beginPath();var _;if(_=AladinUtils.radecToViewXy(h,S,i,CooFrameEnum.J2000,o,a,n,s)){e.moveTo(_.vx,_.vy);for(var M=0,T=h;T<c+b;T+=v/10)M++,_=AladinUtils.radecToViewXy(T,S,i,CooFrameEnum.J2000,o,a,n,s),e.lineTo(_.vx,_.vy),3==M&&e.strokeText(S.toFixed(2),_.vx,_.vy-2);e.stroke()}}for(var T=w;T<c+b;T+=b){e.beginPath();var _;if(_=AladinUtils.radecToViewXy(T,d,i,CooFrameEnum.J2000,o,a,n,s)){e.moveTo(_.vx,_.vy);for(var M=0,S=d;S<u+x;S+=y/10)M++,_=AladinUtils.radecToViewXy(T,S,i,CooFrameEnum.J2000,o,a,n,s),e.lineTo(_.vx,_.vy),3==M&&e.strokeText(T.toFixed(2),_.vx,_.vy-2);e.stroke()}}}},e}(),Footprint=function(){return Footprint=function(t){this.polygons=t,this.overlay=null,this.isShowing=!0,this.isSelected=!1},Footprint.prototype.setOverlay=function(t){this.overlay=t},Footprint.prototype.show=function(){this.isShowing||(this.isShowing=!0,this.overlay&&this.overlay.reportChange())},Footprint.prototype.hide=function(){this.isShowing&&(this.isShowing=!1,this.overlay&&this.overlay.reportChange())},Footprint.prototype.select=function(){this.isSelected||(this.isSelected=!0,this.overlay&&this.overlay.reportChange())},Footprint.prototype.deselect=function(){this.isSelected&&(this.isSelected=!1,this.overlay&&this.overlay.reportChange())},Footprint}(),Popup=function(){return Popup=function(t){this.domEl=$('<div class="aladin-popup-container"><div class="aladin-popup"><div class="aladin-popupTitle"></div><div class="aladin-popupText"></div></div><div class="aladin-popup-arrow"></div></div>'),this.domEl.appendTo(t);var e=this;this.domEl.find(".aladin-closeBtn").click(function(){e.hide()})},Popup.prototype.hide=function(){this.domEl.hide()},Popup.prototype.show=function(){this.domEl.show()},Popup.prototype.setTitle=function(t){this.domEl.find(".aladin-popupTitle").html(t)},Popup.prototype.setText=function(t){this.domEl.find(".aladin-popupText").html(t),this.w=this.domEl.outerWidth(),this.h=this.domEl.outerHeight()},Popup.prototype.setSource=function(t){this.source&&(this.source.popup=null),t.popup=this,this.source=t,this.setPosition(t.x,t.y)},Popup.prototype.setPosition=function(t,e){var i=t-this.w/2,r=e-this.h+this.source.catalog.sourceSize/2;this.domEl[0].style.left=i+"px",this.domEl[0].style.top=r+"px"},Popup}(),Circle=function(){return Circle=function(t,e,i){i=i||{},this.color=i.color||void 0,this.fillOpacity=i.fillOpacity||void 0,this.setCenter(t),this.setRadius(e),this.overlay=null,this.isShowing=!0,this.isSelected=!1},Circle.prototype.setOverlay=function(t){this.overlay=t},Circle.prototype.show=function(){this.isShowing||(this.isShowing=!0,this.overlay&&this.overlay.reportChange())},Circle.prototype.hide=function(){this.isShowing&&(this.isShowing=!1,this.overlay&&this.overlay.reportChange())},Circle.prototype.select=function(){this.isSelected||(this.isSelected=!0,this.overlay&&this.overlay.reportChange())},Circle.prototype.deselect=function(){this.isSelected&&(this.isSelected=!1,this.overlay&&this.overlay.reportChange())},Circle.prototype.setCenter=function(t){this.centerRaDec=t,this.overlay&&this.overlay.reportChange()},Circle.prototype.setRadius=function(t){this.radiusDegrees=t,this.overlay&&this.overlay.reportChange()},Circle.prototype.draw=function(t,e,i,r,o,a,n){if(this.isShowing){var s;if(i!=CooFrameEnum.J2000){var l=CooConversion.J2000ToGalactic([this.centerRaDec[0],this.centerRaDec[1]]);s=e.project(l[0],l[1])}else s=e.project(this.centerRaDec[0],this.centerRaDec[1]);if(s){var c=AladinUtils.xyToView(s.X,s.Y,r,o,a,n,!0),h,u=this.centerRaDec[0],d=this.centerRaDec[1]+(u>0?-this.radiusDegrees:this.radiusDegrees);if(i!=CooFrameEnum.J2000){var l=CooConversion.J2000ToGalactic([u,d]);h=e.project(l[0],l[1])}else h=e.project(u,d);if(h){var p=AladinUtils.xyToView(h.X,h.Y,r,o,a,n,!0),f=p.vx-c.vx,m=p.vy-c.vy,g=Math.sqrt(f*f+m*m);this.color&&(t.strokeStyle=this.color,this.fillOpacity&&(t.fillStyle=ColorOpacity(this.color,this.fillOpacity))),t.beginPath(),t.arc(c.vx,c.vy,g,0,2*Math.PI,!1),t.stroke(),this.fillOpacity&&t.fill()}}}},Circle}(),Polyline=function(){return Polyline=function(t,e){e=e||{},this.color=e.color||void 0,this.radecArray=t,this.overlay=null,this.isShowing=!0,this.isSelected=!1},Polyline.prototype.setOverlay=function(t){this.overlay=t},Polyline.prototype.show=function(){this.isShowing||(this.isShowing=!0,this.overlay&&this.overlay.reportChange())},Polyline.prototype.hide=function(){this.isShowing&&(this.isShowing=!1,this.overlay&&this.overlay.reportChange())},Polyline.prototype.select=function(){this.isSelected||(this.isSelected=!0,this.overlay&&this.overlay.reportChange())},Polyline.prototype.deselect=function(){this.isSelected&&(this.isSelected=!1,this.overlay&&this.overlay.reportChange())},Polyline.prototype.draw=function(t,e,i,r,o,a,n){if(this.isShowing&&this.radecArray&&!(this.radecArray.length<2)){this.color&&(t.strokeStyle=this.color);var s=AladinUtils.radecToViewXy(this.radecArray[0][0],this.radecArray[0][1],e,i,r,o,a,n);if(s){t.moveTo(s.vx,s.vy);for(var l,c=1;c<this.radecArray.length&&(l=AladinUtils.radecToViewXy(this.radecArray[c][0],this.radecArray[c][1],e,i,r,o,a,n),l);c++)t.lineTo(l.vx,l.vy);t.stroke()}}},Polyline}(),Overlay=function(){return Overlay=function(t){t=t||{},this.name=t.name||"overlay",this.color=t.color||Color.getNextColor(),this.lineWidth=t.lineWidth||2,this.overlays=[],this.overlay_items=[],this.isShowing=!0},Overlay.prototype.show=function(){this.isShowing||(this.isShowing=!0,this.reportChange())},Overlay.prototype.hide=function(){this.isShowing&&(this.isShowing=!1,this.reportChange())},Overlay.parseSTCS=function(t){for(var e=[],i=t.match(/\S+/g),r=0,o=i.length,a;r<o;){var n=i[r].toLowerCase();if("polygon"==n&&(a=[],r++,frame=i[r].toLowerCase(),"icrs"==frame||"j2000"==frame)){for(;r+2<o;){var s=parseFloat(i[r+1]);if(isNaN(s))break;var l=parseFloat(i[r+2]);a.push([s,l]),r+=2}a.push(a[0]),e.push(a)}r++}return e},Overlay.prototype.addFootprints=function(t){this.overlays=this.overlays.concat(t);for(var e=0,i=t.length;e<i;e++)t[e].setOverlay(this);this.view.requestRedraw()},Overlay.prototype.add=function(t){this.overlay_items.push(t),t.setOverlay(this),this.view.requestRedraw()},Overlay.prototype.getFootprint=function(t){return t<this.footprints.length?this.footprints[t]:null},Overlay.prototype.setView=function(t){this.view=t},Overlay.prototype.removeAll=function(){this.overlays=[],this.overlay_items=[]},Overlay.prototype.draw=function(t,e,i,r,o,a,n){if(this.isShowing){t.strokeStyle=this.color,t.lineWidth=this.lineWidth,t.beginPath(),xyviews=[];for(var s=0,l=this.overlays.length;s<l;s++)xyviews.push(this.drawFootprint(this.overlays[s],t,e,i,r,o,a,n));t.stroke(),t.strokeStyle=Overlay.increase_brightness(this.color,80),t.beginPath();for(var s=0,l=this.overlays.length;s<l;s++)this.overlays[s].isSelected&&this.drawFootprintSelected(t,xyviews[s]);t.stroke();for(var s=0;s<this.overlay_items.length;s++)this.overlay_items[s].draw(t,e,i,r,o,a,n)}},Overlay.increase_brightness=function(t,e){t=t.replace(/^\s*#|\s*$/g,""),3==t.length&&(t=t.replace(/(.)/g,"$1$1"));var i=parseInt(t.substr(0,2),16),r=parseInt(t.substr(2,2),16),o=parseInt(t.substr(4,2),16);return"#"+(0|256+i+(256-i)*e/100).toString(16).substr(1)+(0|256+r+(256-r)*e/100).toString(16).substr(1)+(0|256+o+(256-o)*e/100).toString(16).substr(1)},Overlay.prototype.drawFootprint=function(t,e,i,r,o,a,n,s){if(!t.isShowing)return null;for(var l=[],c=!1,h=t.polygons,u=0,d=h.length;u<d;u++){var p;if(r!=CooFrameEnum.J2000){var f=CooConversion.J2000ToGalactic([h[u][0],h[u][1]]);p=i.project(f[0],f[1])}else p=i.project(h[u][0],h[u][1]);if(!p)return null;var m=AladinUtils.xyToView(p.X,p.Y,o,a,n,s);l.push(m),!c&&m.vx<o&&m.vx>=0&&m.vy<=a&&m.vy>=0&&(c=!0)}if(c){e.moveTo(l[0].vx,l[0].vy);for(var u=1,d=l.length;u<d;u++)e.lineTo(l[u].vx,l[u].vy)}return l},Overlay.prototype.drawFootprintSelected=function(t,e){if(e){var i=e;t.moveTo(i[0].vx,i[0].vy);for(var r=1,o=i.length;r<o;r++)t.lineTo(i[r].vx,i[r].vy)}},Overlay.prototype.reportChange=function(){this.view.requestRedraw()},Overlay}(),cds.Source=function(){return cds.Source=function(t,e,i,r){this.ra=t,this.dec=e,this.data=i,this.catalog=null,this.marker=r&&r.marker||!1,this.marker&&(this.popupTitle=r&&r.popupTitle?r.popupTitle:"",this.popupDesc=r&&r.popupDesc?r.popupDesc:""),this.isShowing=!0,this.isSelected=!1},cds.Source.prototype.setCatalog=function(t){this.catalog=t},cds.Source.prototype.show=function(){this.isShowing||(this.isShowing=!0,this.catalog&&this.catalog.reportChange())},cds.Source.prototype.hide=function(){this.isShowing&&(this.isShowing=!1,this.catalog&&this.catalog.reportChange())},cds.Source.prototype.select=function(){this.isSelected||(this.isSelected=!0,this.catalog&&this.catalog.reportChange())},cds.Source.prototype.deselect=function(){this.isSelected&&(this.isSelected=!1,this.catalog&&this.catalog.reportChange())},cds.Source}(),ProgressiveCat=function(){function t(t,e){var i=["name","ID","ucd","utype","unit","datatype","arraysize","width","precision"],r=[],o=0;return t.keyRa=t.keyDec=null,$(e).find("FIELD").each(function(){for(var e={},a=0;a<i.length;a++){var n=i[a];$(this).attr(n)&&(e[n]=$(this).attr(n))}e.ID||(e.ID="col_"+o),t.keyRa||!e.ucd||0!=e.ucd.indexOf("pos.eq.ra")&&0!=e.ucd.indexOf("POS_EQ_RA")||(e.name?t.keyRa=e.name:t.keyRa=e.ID),t.keyDec||!e.ucd||0!=e.ucd.indexOf("pos.eq.dec")&&0!=e.ucd.indexOf("POS_EQ_DEC")||(e.name?t.keyDec=e.name:t.keyDec=e.ID),r.push(e),o++}),r}function e(t,e,i){if(!t.keyRa||!t.keyDec)return[];lines=e.split("\n");for(var r=[],o=0;o<i.length;o++)i[o].name?r.push(i[o].name):r.push(i[o].ID);for(var a=[],n=new Coo,s=2;s<lines.length;s++){var l={},c=lines[s].split("\t");if(!(c.length<r.length)){for(var h=0;h<r.length;h++)l[r[h]]=c[h];var u,d;Utils.isNumber(l[t.keyRa])&&Utils.isNumber(l[t.keyDec])?(u=parseFloat(l[t.keyRa]),d=parseFloat(l[t.keyDec])):(n.parse(l[t.keyRa]+" "+l[t.keyDec]),u=n.lon,d=n.lat),a.push(new cds.Source(u,d,l))}}return a}return ProgressiveCat=function(t,e,i,r){r=r||{},this.type="progressivecat",this.rootUrl=t,this.frame=CooFrameEnum.fromString(e)||CooFrameEnum.J2000,this.maxOrder=i,this.isShowing=!0,this.name=r.name||"progressive-cat",this.color=r.color||Color.getNextColor(),this.sourceSize=r.sourceSize||10,this.sourcesCache=new Utils.LRUCache(100),this.cacheCanvas=document.createElement("canvas"),this.cacheCanvas.width=this.sourceSize,this.cacheCanvas.height=this.sourceSize;var o=this.cacheCanvas.getContext("2d");o.beginPath(),o.strokeStyle=this.color,o.lineWidth=2,o.moveTo(0,0),o.lineTo(0,this.sourceSize),o.lineTo(this.sourceSize,this.sourceSize),o.lineTo(this.sourceSize,0),o.lineTo(0,0),o.stroke()},ProgressiveCat.prototype={init:function(t){this.view=t,this.level3Sources||this.loadLevel2Sources()},loadLevel2Sources:function(){var i=this;$.ajax({url:i.rootUrl+"/Norder2/Allsky.xml",method:"GET",success:function(r){i.fields=t(i,r),i.level2Sources=e(i,$(r).find("CSV").text(),i.fields),i.loadLevel3Sources()},error:function(t){console.log("Something went wrong: "+t)}})},loadLevel3Sources:function(){var t=this;$.ajax({url:t.rootUrl+"/Norder3/Allsky.xml",method:"GET",success:function(i){t.level3Sources=e(t,$(i).find("CSV").text(),t.fields),t.view.requestRedraw()},error:function(t){console.log("Something went wrong: "+t)}})},draw:function(t,e,i,r,o,a,n){if(this.isShowing&&this.level3Sources&&(this.drawSources(this.level2Sources,t,e,i,r,o,a,n),this.drawSources(this.level3Sources,t,e,i,r,o,a,n),this.tilesInView))for(var s,l,c,h=0;h<this.tilesInView.length;h++)c=this.tilesInView[h],l=c[0]+"-"+c[1],s=this.sourcesCache.get(l),s&&this.drawSources(s,t,e,i,r,o,a,n)},drawSources:function(t,e,i,r,o,a,n,s){for(var l=0,c=t.length;l<c;l++)this.drawSource(t[l],e,i,r,o,a,n,s)},getSources:function(){var t=[];if(this.level2Sources&&(t=t.concat(this.level2Sources)),this.level3Sources&&(t=t.concat(this.level3Sources)),this.tilesInView)for(var e,i,r,o=0;o<this.tilesInView.length;o++)r=this.tilesInView[o],i=r[0]+"-"+r[1],e=this.sourcesCache.get(i),e&&(t=t.concat(e));return t},drawSource:function(t,e,i,r,o,a,n,s){if(t.isShowing){var l=this.sourceSize,c;if(r!=CooFrameEnum.J2000){var h=CooConversion.J2000ToGalactic([t.ra,t.dec]);c=i.project(h[0],h[1])}else c=i.project(t.ra,t.dec);if(c){var u=AladinUtils.xyToView(c.X,c.Y,o,a,n,s);if(u){if(u.vx>o+l||u.vx<0-l||u.vy>a+l||u.vy<0-l)return void(t.x=t.y=void 0);t.x=u.vx,t.y=u.vy,e.drawImage(this.cacheCanvas,t.x-l/2,t.y-l/2)}}}},deselectAll:function(){for(var t=0;t<this.level2Sources.length;t++)this.level2Sources[t].deselect();for(var t=0;t<this.level3Sources.length;t++)this.level3Sources[t].deselect();var e=this.sourcesCache.keys();for(key in e)if(this.sourcesCache[key])for(var i=this.sourcesCache[key],t=0;t<i.length;t++)i[t].deselect()},show:function(){this.isShowing||(this.isShowing=!0,this.reportChange())},hide:function(){this.isShowing&&(this.isShowing=!1,this.reportChange())},reportChange:function(){this.view.requestRedraw()},getTileURL:function(t,e){var i=1e4*Math.floor(e/1e4);return this.rootUrl+"/Norder"+t+"/Dir"+i+"/Npix"+e+".tsv"},loadNeededTiles:function(){this.tilesInView=[],this.otherSources=[];var t=this.view.realNorder;if(t>this.maxOrder&&(t=this.maxOrder),!(t<=3)){for(var i=this.view.getVisibleCells(t,this.frame),r,o,a=4;a<=t;a++){r=[];for(var n=0;n<i.length;n++)o=Math.floor(i[n].ipix/Math.pow(4,t-a)),r.indexOf(o)<0&&r.push(o);for(var s=0;s<r.length;s++)this.tilesInView.push([a,r[s]])}for(var l,c,h=this,n=0;n<this.tilesInView.length;n++)l=this.tilesInView[n],c=l[0]+"-"+l[1],this.sourcesCache.get(c)||!function(t,i,r){var o=i+"-"+r;$.ajax({url:t.getTileURL(i,r),method:"GET",success:function(i){t.sourcesCache.set(o,e(t,i,t.fields)),t.view.requestRedraw()},error:function(){t.sourcesCache.set(o,[])}})}(this,l[0],l[1])}}},ProgressiveCat}(),cds.Catalog=function(){function t(t,e,i){var r,o;if(r=o=null,e)for(var a=0,n=t.length;a<n;a++){var s=t[a];if(Utils.isInt(e)&&e<t.length){r=e;break}if(s.ID&&s.ID===e||s.name&&s.name===e){r=a;break}}if(i)for(var a=0,n=t.length;a<n;a++){var s=t[a];if(Utils.isInt(i)&&i<t.length){o=i;break}if(s.ID&&s.ID===i||s.name&&s.name===i){o=a;break}}for(var a=0,n=t.length;a<n&&(null==r||null==o);a++){var s=t[a];if(!r&&s.ucd){var l=$.trim(s.ucd.toLowerCase());if(0==l.indexOf("pos.eq.ra")||0==l.indexOf("pos_eq_ra")){r=a;continue}}if(!o&&s.ucd){var l=$.trim(s.ucd.toLowerCase());if(0==l.indexOf("pos.eq.dec")||0==l.indexOf("pos_eq_dec")){o=a;continue}}}if(null==r&&null==o)for(var a=0,n=t.length;a<n;a++){var s=t[a],c=s.name||s.ID||"";c=c.toLowerCase(),r||0!=c.indexOf("ra")&&0!=c.indexOf("_ra")&&0!=c.indexOf("ra(icrs)")&&0!=c.indexOf("_ra")&&0!=c.indexOf("alpha")?o||0!=c.indexOf("dej2000")&&0!=c.indexOf("_dej2000")&&0!=c.indexOf("de")&&0!=c.indexOf("de(icrs)")&&0!=c.indexOf("_de")&&0!=c.indexOf("delta")||(o=a):r=a}return null!=r&&null!=o||(r=0,o=1),[r,o]}return cds.Catalog=function(t){t=t||{},this.type="catalog",this.name=t.name||"catalog",this.color=t.color||Color.getNextColor(),this.sourceSize=t.sourceSize||8,this.markerSize=t.sourceSize||12,this.shape=t.shape||"square",this.maxNbSources=t.limit||void 0,this.onClick=t.onClick||void 0,this.raField=t.raField||void 0,this.decField=t.decField||void 0,this.indexationNorder=5,this.sources=[],this.hpxIdx=new HealpixIndex(this.indexationNorder),this.hpxIdx.init(),this.displayLabel=t.displayLabel||!1,this.labelColor=t.labelColor||this.color,this.labelFont=t.labelFont||"10px sans-serif",this.displayLabel&&(this.labelColumn=t.labelColumn,this.labelColumn||(this.displayLabel=!1)),(this.shape instanceof Image||this.shape instanceof HTMLCanvasElement)&&(this.sourceSize=this.shape.width),this._shapeIsFunction=!1,$.isFunction(this.shape)&&(this._shapeIsFunction=!0),this.selectionColor="#00ff00",this.updateShape(t),this.cacheMarkerCanvas=document.createElement("canvas"),this.cacheMarkerCanvas.width=this.markerSize,this.cacheMarkerCanvas.height=this.markerSize;var e=this.cacheMarkerCanvas.getContext("2d");e.fillStyle=this.color,e.beginPath();var i=this.markerSize/2;e.arc(i,i,i-2,0,2*Math.PI,!1),e.fill(),e.lineWidth=2,e.strokeStyle="#ccc",e.stroke(),this.isShowing=!0},cds.Catalog.createShape=function(t,e,i){if(t instanceof Image||t instanceof HTMLCanvasElement)return t;var r=document.createElement("canvas");r.width=r.height=i;var o=r.getContext("2d");return o.beginPath(),o.strokeStyle=e,o.lineWidth=2,"plus"==t?(o.moveTo(i/2,0),o.lineTo(i/2,i),o.stroke(),o.moveTo(0,i/2),o.lineTo(i,i/2),o.stroke()):"cross"==t?(o.moveTo(0,0),o.lineTo(i-1,i-1),o.stroke(),o.moveTo(i-1,0),o.lineTo(0,i-1),o.stroke()):"rhomb"==t?(o.moveTo(i/2,0),o.lineTo(0,i/2),o.lineTo(i/2,i),o.lineTo(i,i/2),o.lineTo(i/2,0),o.stroke()):"triangle"==t?(o.moveTo(i/2,0),o.lineTo(0,i-1),o.lineTo(i-1,i-1),o.lineTo(i/2,0),o.stroke()):"circle"==t?(o.arc(i/2,i/2,i/2-1,0,2*Math.PI,!0),o.stroke()):(o.moveTo(1,0),o.lineTo(1,i-1),o.lineTo(i-1,i-1),o.lineTo(i-1,1),o.lineTo(1,1),o.stroke()),r},cds.Catalog.parseVOTable=function(e,i,r,o,a,n){function s(t){var e;if(t.find("RESOURCE").length>0)e="";else{if(e=t.find("*").first(),0==e.length)return"";e=e.prop("tagName");var i=e.indexOf(":");e=e.substring(0,i)+"\\:"}return e}function l(e,i){e=e.replace(/^\s+/g,"");var o=["name","ID","ucd","utype","unit","datatype","arraysize","width","precision"],l=[],c=0,h=$($.parseXML(e)),u=s(h);h.find(u+"FIELD").each(function(){for(var t={},e=0;e<o.length;e++){var i=o[e];$(this).attr(i)&&(t[i]=$(this).attr(i))}t.ID||(t.ID="col_"+c),l.push(t),c++});var d=t(l,a,n),p,f;p=d[0],f=d[1];var m=[],g=new Coo,v,y;h.find(u+"TR").each(function(){var t={},e=0;$(this).find(u+"TD").each(function(){var i=l[e].name?l[e].name:l[e].id;t[i]=$(this).text(),e++});var i=l[p].name?l[p].name:l[p].id,o=l[f].name?l[f].name:l[f].id;if(Utils.isNumber(t[i])&&Utils.isNumber(t[o])?(v=parseFloat(t[i]),y=parseFloat(t[o])):(g.parse(t[i]+" "+t[o]),v=g.lon,y=g.lat),m.push(new cds.Source(v,y,t)),r&&m.length==r)return!1}),i&&i(m)}var c=Utils.getAjaxObject(e,"GET","text",o);c.done(function(t){l(t,i)})},cds.Catalog.prototype.updateShape=function(t){
t=t||{},this.color=t.color||this.color||Color.getNextColor(),this.sourceSize=t.sourceSize||this.sourceSize||6,this.shape=t.shape||this.shape||"square",this.selectSize=this.sourceSize+2,this.cacheCanvas=cds.Catalog.createShape(this.shape,this.color,this.sourceSize),this.cacheSelectCanvas=cds.Catalog.createShape("square",this.selectionColor,this.selectSize),this.reportChange()},cds.Catalog.prototype.addSources=function(t){t=[].concat(t),this.sources=this.sources.concat(t);for(var e=0,i=t.length;e<i;e++)t[e].setCatalog(this);this.reportChange()},cds.Catalog.prototype.addSourcesAsArray=function(e,i){for(var r=[],o=0;o<e.length;o++)r.push({name:e[o]});var a=t(r,this.raField,this.decField),n,s;n=a[0],s=a[1];for(var l=[],c=new Coo,h,u,d,p,f=0;f<i.length;f++){d=i[f],Utils.isNumber(d[n])&&Utils.isNumber(d[s])?(h=parseFloat(d[n]),u=parseFloat(d[s])):(c.parse(d[n]+" "+d[s]),h=c.lon,u=c.lat),p={};for(var o=0;o<e.length;o++)p[e[o]]=d[o];l.push(A.source(h,u,p))}this.addSources(l)},cds.Catalog.prototype.getSources=function(){return this.sources},cds.Catalog.prototype.selectAll=function(){if(this.sources)for(var t=0;t<this.sources.length;t++)this.sources[t].select()},cds.Catalog.prototype.deselectAll=function(){if(this.sources)for(var t=0;t<this.sources.length;t++)this.sources[t].deselect()},cds.Catalog.prototype.getSource=function(t){return t<this.sources.length?this.sources[t]:null},cds.Catalog.prototype.setView=function(t){this.view=t,this.reportChange()},cds.Catalog.prototype.remove=function(t){var e=this.sources.indexOf(t);e<0||(this.sources[e].deselect(),this.sources.splice(e,1),this.reportChange())},cds.Catalog.prototype.removeAll=cds.Catalog.prototype.clear=function(){this.sources=[]},cds.Catalog.prototype.draw=function(t,e,i,r,o,a,n){if(this.isShowing){this._shapeIsFunction&&t.save();for(var s=[],l=0,c=this.sources.length;l<c;l++){var h=cds.Catalog.drawSource(this,this.sources[l],t,e,i,r,o,a,n);h&&s.push(this.sources[l])}this._shapeIsFunction&&t.restore(),t.strokeStyle=this.selectionColor;for(var u,l=0,c=s.length;l<c;l++)u=s[l],u.isSelected&&cds.Catalog.drawSourceSelection(this,u,t);if(this.displayLabel){t.fillStyle=this.labelColor,t.font=this.labelFont;for(var l=0,c=s.length;l<c;l++)cds.Catalog.drawSourceLabel(this,s[l],t)}}},cds.Catalog.drawSource=function(t,e,i,r,o,a,n,s,l){if(!e.isShowing)return!1;var c=t.sourceSize,h;if(o.system!=CooFrameEnum.SYSTEMS.J2000){var u=CooConversion.J2000ToGalactic([e.ra,e.dec]);h=r.project(u[0],u[1])}else h=r.project(e.ra,e.dec);if(h){var d=AladinUtils.xyToView(h.X,h.Y,a,n,s,l,!0),p=e.popup?100:e.sourceSize;if(d){if(d.vx>a+p||d.vx<0-p||d.vy>n+p||d.vy<0-p)return e.x=e.y=void 0,!1;e.x=d.vx,e.y=d.vy,t._shapeIsFunction?t.shape(e,i,t.view.getViewParams()):e.marker&&e.useMarkerDefaultIcon?i.drawImage(t.cacheMarkerCanvas,e.x-c/2,e.y-c/2):i.drawImage(t.cacheCanvas,e.x-t.cacheCanvas.width/2,e.y-t.cacheCanvas.height/2),e.popup&&e.popup.setPosition(e.x,e.y)}return!0}return!1},cds.Catalog.drawSourceSelection=function(t,e,i){if(e&&e.isShowing&&e.x&&e.y){var r=t.selectSize;i.drawImage(t.cacheSelectCanvas,e.x-r/2,e.y-r/2)}},cds.Catalog.drawSourceLabel=function(t,e,i){if(e&&e.isShowing&&e.x&&e.y){var r=e.data[t.labelColumn];r&&i.fillText(r,e.x,e.y)}},cds.Catalog.prototype.reportChange=function(){this.view&&this.view.requestRedraw()},cds.Catalog.prototype.show=function(){this.isShowing||(this.isShowing=!0,this.reportChange())},cds.Catalog.prototype.hide=function(){this.isShowing&&(this.isShowing=!1,this.view&&this.view.popup&&this.view.popup.source&&this.view.popup.source.catalog==this&&this.view.popup.hide(),this.reportChange())},cds.Catalog}(),Tile=function(){function t(t,e){this.img=t,this.url=e}return t.isImageOk=function(t){return!!t.allSkyTexture||!!t.src&&(!!t.complete&&("undefined"==typeof t.naturalWidth||0!=t.naturalWidth))},t}(),TileBuffer=function(){function t(){this.pointer=0,this.tilesMap={},this.tilesArray=new Array(e);for(var t=0;t<e;t++)this.tilesArray[t]=new Tile(new Image,null)}var e=800;return t.prototype.addTile=function(t){if(this.getTile(t))return null;var i=this.tilesArray[this.pointer];return null!=i.url&&(i.img.src=null,delete this.tilesMap[i.url]),this.tilesArray[this.pointer].url=t,this.tilesMap[t]=this.tilesArray[this.pointer],this.pointer++,this.pointer>=e&&(this.pointer=0),this.tilesMap[t]},t.prototype.getTile=function(t){return this.tilesMap[t]},t}(),ColorMap=function(){return ColorMap=function(t){this.view=t,this.reversed=!1,this.map="native",this.sig=this.signature()},ColorMap.MAPS={},ColorMap.MAPS.eosb={name:"Eos B",r:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,18,27,36,45,49,57,72,81,91,100,109,118,127,136,131,139,163,173,182,191,200,209,218,227,213,221,255,255,255,255,255,255,255,255,229,229,255,255,255,255,255,255,255,255,229,229,255,255,255,255,255,255,255,255,229,229,255,255,255,255,255,255,255,255,229,229,255,255,255,255,255,255,255,255,229,229,255,255,255,255,255,255,255,255,229,229,255,255,255,255,255,255,255,255,229,229,255,255,255,255,255,255,255,255,229,229,255,255,255,255,255,255,255,255,229,229,255,253,251,249,247,245,243,241,215,214,235,234,232,230,228,226,224,222,198,196,216,215,213,211,209,207,205,203,181,179,197,196,194,192,190,188,186,184,164,162,178,176,175,173,171,169,167,165,147,145,159,157,156,154,152,150,148,146,130,128,140,138,137,135,133,131,129,127,113,111,121,119,117,117],g:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,15,23,31,39,47,55,57,64,79,87,95,103,111,119,127,135,129,136,159,167,175,183,191,199,207,215,200,207,239,247,255,255,255,255,255,255,229,229,255,255,255,255,255,255,255,255,229,229,255,255,255,255,255,255,255,255,229,229,255,250,246,242,238,233,229,225,198,195,212,208,204,199,195,191,187,182,160,156,169,165,161,157,153,148,144,140,122,118,127,125,123,121,119,116,114,112,99,97,106,104,102,99,97,95,93,91,80,78,84,82,80,78,76,74,72,70,61,59,63,61,59,57,55,53,50,48,42,40,42,40,38,36,33,31,29,27,22,21,21,19,16,14,12,13,8,6,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],b:[116,121,127,131,136,140,144,148,153,157,145,149,170,174,178,182,187,191,195,199,183,187,212,216,221,225,229,233,238,242,221,225,255,247,239,231,223,215,207,199,172,164,175,167,159,151,143,135,127,119,100,93,95,87,79,71,63,55,47,39,28,21,15,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},ColorMap.MAPS.rainbow={name:"Rainbow",r:[0,4,9,13,18,22,27,31,36,40,45,50,54,58,61,64,68,69,72,74,77,79,80,82,83,85,84,86,87,88,86,87,87,87,85,84,84,84,83,79,78,77,76,71,70,68,66,60,58,55,53,46,43,40,36,33,25,21,16,12,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,8,12,21,25,29,33,42,46,51,55,63,67,72,76,80,89,93,97,101,110,114,119,123,131,135,140,144,153,157,161,165,169,178,182,187,191,199,203,208,212,221,225,229,233,242,246,250,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255],g:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,8,16,21,25,29,38,42,46,51,55,63,67,72,76,84,89,93,97,106,110,114,119,127,131,135,140,144,152,157,161,165,174,178,182,187,195,199,203,208,216,220,225,229,233,242,246,250,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,250,242,238,233,229,221,216,212,208,199,195,191,187,178,174,170,165,161,153,148,144,140,131,127,123,119,110,106,102,97,89,85,80,76,72,63,59,55,51,42,38,34,29,21,17,12,8,0],b:[0,3,7,10,14,19,23,28,32,38,43,48,53,59,63,68,72,77,81,86,91,95,100,104,109,113,118,122,127,132,136,141,145,150,154,159,163,168,173,177,182,186,191,195,200,204,209,214,218,223,227,232,236,241,245,250,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,246,242,238,233,225,220,216,212,203,199,195,191,187,178,174,170,165,157,152,148,144,135,131,127,123,114,110,106,102,97,89,84,80,76,67,63,59,55,46,42,38,34,25,21,16,12,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},ColorMap.MAPS_CUSTOM=["rainbow","eosb"],ColorMap.MAPS_NAMES=["native","grayscale"].concat(ColorMap.MAPS_CUSTOM),ColorMap.prototype.reverse=function(t){t?this.reversed=t:this.reversed=!this.reversed,this.sig=this.signature(),this.view.requestRedraw()},ColorMap.prototype.signature=function(){var t=this.map;return this.reversed&&(t+=" reversed"),t},ColorMap.prototype.update=function(t){this.map=t,this.sig=this.signature(),this.view.requestRedraw()},ColorMap.prototype.apply=function(t){if("native"==this.sig)return t;if(t.cmSig==this.sig)return t.cmImg;var e=document.createElement("canvas");e.width=t.width,e.height=t.height;var i=e.getContext("2d");i.drawImage(t,0,0);var r=i.getImageData(0,0,e.width,e.height),o=r.data,a=o.length,n,s,l,c=3;"grayscale"==this.map?c=1:ColorMap.MAPS_CUSTOM.indexOf(this.map)>=0&&(c=2);for(var h=0;h<a;h+=4){switch(c){case 1:n=s=l=AladinUtils.myRound((o[h]+o[h+1]+o[h+2])/3);break;case 2:this.reversed?(n=ColorMap.MAPS[this.map].r[255-o[h]],s=ColorMap.MAPS[this.map].g[255-o[h+1]],l=ColorMap.MAPS[this.map].b[255-o[h+2]]):(n=ColorMap.MAPS[this.map].r[o[h]],s=ColorMap.MAPS[this.map].g[o[h+1]],l=ColorMap.MAPS[this.map].b[o[h+2]]);break;default:n=o[h],s=o[h+1],l=o[h+2]}2!=c&&this.reversed&&(n=255-n,s=255-s,l=255-l),o[h]=n,o[h+1]=s,o[h+2]=l}return r.data=o,i.putImageData(r,0,0),t.cmSig=this.sig,t.cmImg=e,t.cmImg},ColorMap}(),HpxImageSurvey=function(){function t(t,e,i,r){return Math.pow(i-t,2)+Math.pow(r-e,2)}function e(t,e,i,r,o,a,n,s,l,c,h,u,d,p,f,m,g,v){m=m||0,g=g||0,v||(v=!1),l+=m,h+=m,d+=m,c+=g,u+=g,p+=g;var y=(i+o+n)/3,b=(r+a+s)/3,y=(i+o+n)/3,b=(r+a+s)/3;t.save(),f&&(t.globalAlpha=f);var x=.01;v&&(x=.01),t.beginPath(),t.moveTo((1+x)*i-y*x,(1+x)*r-b*x),t.lineTo((1+x)*o-y*x,(1+x)*a-b*x),t.lineTo((1+x)*n-y*x,(1+x)*s-b*x),t.closePath(),t.clip(),v&&(x=.03,i=(1+x)*i-y*x,r=(1+x)*r-b*x,o=(1+x)*o-y*x,a=(1+x)*a-b*x,n=(1+x)*n-y*x,s=(1+x)*s-b*x);var w=1/(l*(p-u)-h*p+d*u+(h-d)*c);t.transform(-(c*(n-o)-u*n+p*o+(u-p)*i)*w,(u*s+c*(a-s)-p*a+(p-u)*r)*w,(l*(n-o)-h*n+d*o+(h-d)*i)*w,-(h*s+l*(a-s)-d*a+(d-h)*r)*w,(l*(p*o-u*n)+c*(h*n-d*o)+(d*u-h*p)*i)*w,(l*(p*a-u*s)+c*(h*s-d*a)+(d*u-h*p)*r)*w),t.drawImage(e,0,0),t.restore()}function i(t,e){for(var i=new Array(t.length),r=0;r<4;r++)i[r]={vx:t[r].vx,vy:t[r].vy};for(var r=0;r<2;r++){var o=1==r?1:0,a=1==r?2:3,n=Math.atan2(i[a].vy-i[o].vy,i[a].vx-i[o].vx),s=e*Math.cos(n);i[o].vx-=s,i[a].vx+=s,s=e*Math.sin(n),i[o].vy-=s,i[a].vy+=s}return i}var r=function(t,e,i,o,a,n){this.id=t,this.name=e,"/"===i.slice(-1)?this.rootUrl=i.substr(0,i.length-1):this.rootUrl=i,n=n||{},this.imgFormat=n.imgFormat||"jpg",this.minOrder=n.minOrder||null,this.cooFrame=CooFrameEnum.fromString(o,CooFrameEnum.J2000),this.rootUrl.indexOf("/glimpse360/aladin/data")>=0&&(this.cooFrame=CooFrameEnum.J2000),this.maxOrder=a,this.allskyTexture=null,this.alpha=0,this.allskyTextureSize=0,this.lastUpdateDateNeededTiles=0;for(var s=!1,l=0;l<r.SURVEYS.length;l++)r.SURVEYS[l].id==this.id&&(s=!0);s||r.SURVEYS.push({id:this.id,url:this.rootUrl,name:this.name,maxOrder:this.maxOrder,frame:this.cooFrame}),r.SURVEYS_OBJECTS[this.id]=this};r.UPDATE_NEEDED_TILES_DELAY=1e3,r.prototype.init=function(t,e){this.view=t,this.cm||(this.cm=new ColorMap(this.view)),this.tileBuffer=this.view.tileBuffer,this.useCors=!1;var i=this;$.support.cors?$.ajax({type:"GET",url:this.rootUrl+"/properties",contentType:"text/plain",xhrFields:{},headers:{},success:function(){i.useCors=!0,i.retrieveAllskyTextures(),e&&e()},error:function(){i.retrieveAllskyTextures(),e&&e()}}):(this.retrieveAllskyTextures(),e())},r.DEFAULT_SURVEY_ID="P/DSS2/color",r.SURVEYS_OBJECTS={},r.SURVEYS=[{id:"P/2MASS/color",url:"http://alasky.u-strasbg.fr/2MASS/Color",name:"2MASS colored",maxOrder:9,frame:"equatorial",format:"jpeg"},{id:"P/DSS2/color",url:"http://alasky.u-strasbg.fr/DSS/DSSColor",name:"DSS colored",maxOrder:9,frame:"equatorial",format:"jpeg"},{id:"P/DSS2/red",url:"http://alasky.u-strasbg.fr/DSS/DSS2Merged",name:"DSS2 Red (F+R)",maxOrder:9,frame:"equatorial",format:"jpeg fits"},{id:"P/Fermi/color",url:"http://alasky.u-strasbg.fr/Fermi/Color",name:"Fermi color",maxOrder:3,frame:"equatorial",format:"jpeg"},{id:"P/Finkbeiner",url:"http://alasky.u-strasbg.fr/FinkbeinerHalpha",maxOrder:3,frame:"galactic",format:"jpeg fits",name:"Halpha"},{id:"P/GALEXGR6/AIS/color",url:"http://alasky.u-strasbg.fr/GALEX/GR6-02-Color",name:"GALEX Allsky Imaging Survey colored",maxOrder:8,frame:"equatorial",format:"jpeg"},{id:"P/IRIS/color",url:"http://alasky.u-strasbg.fr/IRISColor",name:"IRIS colored",maxOrder:3,frame:"galactic",format:"jpeg"},{id:"P/Mellinger/color",url:"http://alasky.u-strasbg.fr/MellingerRGB",name:"Mellinger colored",maxOrder:4,frame:"galactic",format:"jpeg"},{id:"P/SDSS9/color",url:"http://alasky.u-strasbg.fr/SDSS/DR9/color",name:"SDSS9 colored",maxOrder:10,frame:"equatorial",format:"jpeg"},{id:"P/SPITZER/color",url:"http://alasky.u-strasbg.fr/SpitzerI1I2I4color",name:"IRAC color I1,I2,I4 - (GLIMPSE, SAGE, SAGE-SMC, SINGS)",maxOrder:9,frame:"galactic",format:"jpeg"},{id:"P/VTSS/Ha",url:"http://alasky.u-strasbg.fr/VTSS/Ha",maxOrder:3,frame:"galactic",format:"png jpeg fits",name:"VTSS-Ha"},{id:"P/XMM/EPIC",url:"http://saada.u-strasbg.fr/xmmallsky",name:"XMM-Newton stacked EPIC images (no phot. normalization)",maxOrder:7,frame:"equatorial",format:"png jpeg fits"},{id:"P/XMM/PN/color",url:"http://saada.unistra.fr/xmmpnsky",name:"XMM PN colored",maxOrder:7,frame:"equatorial",format:"png jpeg"},{id:"P/allWISE/color",url:"http://alasky.u-strasbg.fr/AllWISE/RGB-W4-W2-W1/",name:"AllWISE color",maxOrder:8,frame:"equatorial",format:"jpeg"},{id:"P/GLIMPSE360",url:"http://www.spitzer.caltech.edu/glimpse360/aladin/data",name:"GLIMPSE360",maxOrder:9,frame:"equatorial",format:"jpeg"}],r.getAvailableSurveys=function(){return r.SURVEYS},r.getSurveyInfoFromId=function(t){for(var e=r.getAvailableSurveys(),i=0;i<e.length;i++)if(e[i].id==t)return e[i];return null},r.getSurveyFromId=function(t){if(r.SURVEYS_OBJECTS[t])return r.SURVEYS_OBJECTS[t];var e=r.getSurveyInfoFromId(t);return e?new r(e.id,e.name,e.url,e.frame,e.maxOrder):null},r.prototype.getTileURL=function(t,e){var i=1e4*Math.floor(e/1e4);return this.rootUrl+"/Norder"+t+"/Dir"+i+"/Npix"+e+"."+this.imgFormat},r.prototype.retrieveAllskyTextures=function(){var t=new Image;this.useCors&&(t.crossOrigin="anonymous");var e=this;t.onload=function(){e.allskyTextureSize=t.width/27,e.allskyTexture=t,e.view.requestRedraw()},t.src=this.rootUrl+"/Norder3/Allsky."+this.imgFormat},r.prototype.redrawAllsky=function(t,e,i,r){if(!(this.view.curNorder>6)&&this.allskyTexture)for(var o,a=0,n,s,l=0,c=e.length;l<c;l++)if(o=e[l],s=o.ipix,this.allskyTexture&&Tile.isImageOk(this.allskyTexture)){var h=this.allskyTextureSize*Math.floor(s/27),u=this.allskyTextureSize*(s-27*Math.floor(s/27));if(i>40){a=.02,a=0,n={x:(o[0].vx+o[2].vx)/2,y:(o[0].vy+o[2].vy)/2};for(var d=0;d<4;d++){var p={x:o[d].vx-n.x,y:o[d].vy-n.y};o[d].vx+=a*p.x,o[d].vy+=a*p.y}}this.drawOneTile(t,this.allskyTexture,o,this.allskyTextureSize,null,u,h,!0)}},r.prototype.getColorMap=function(){return this.cm};var o=!0;return r.prototype.redrawHighres=function(t,e,i){if(0!=e.length){o=!o;var a=(new Date).getTime(),n=a-this.lastUpdateDateNeededTiles>r.UPDATE_NEEDED_TILES_DELAY,s,l,c,h,u=i-1,d,p,f=[],m=[],g={},v=!1,y=[],b=[],x,w;if(n){var C=[(e[0][0].vx+e[0][1].vx)/2,(e[0][0].vy+e[0][1].vy)/2],S=e.sort(function(t,e){var i=[(t[0].vx+t[2].vx)/2,(t[0].vy+t[2].vy)/2],r=[(e[0].vx+e[2].vx)/2,(e[0].vy+e[2].vy)/2],o=(i[0]-C[0])*(i[0]-C[0])+(i[1]-C[1])*(i[1]-C[1]),a=(r[0]-C[0])*(r[0]-C[0])+(r[1]-C[1])*(r[1]-C[1]);return o-a});e=S}for(var _=0,M=e.length;_<M;_++)if(d=e[_],w=d.ipix,x=~~(w/4),h=this.getTileURL(u,x),n&&u>=3&&(c=this.tileBuffer.addTile(h),c&&b.push({img:c.img,url:h})),l=this.getTileURL(i,w),s=this.tileBuffer.getTile(l))Tile.isImageOk(s.img)?f.push({img:s.img,corners:d}):(v=!0,n&&!s.img.dlError&&y.push({img:s.img,url:l}),u>=3&&!g[x]&&(c=this.tileBuffer.getTile(h),c&&Tile.isImageOk(c.img)&&(p=this.view.getPositionsInView(x,u),p&&m.push({img:c.img,corners:p,ipix:x})),g[x]=1));else{if(v=!0,n){var s=this.tileBuffer.addTile(l);s&&y.push({img:s.img,url:l})}u>=3&&!g[x]&&(c=this.tileBuffer.getTile(h),c&&Tile.isImageOk(c.img)&&(p=this.view.getPositionsInView(x,u),p&&m.push({img:c.img,corners:p,ipix:x})),g[x]=1)}for(var _=0,M=m.length;_<M;_++)this.drawOneTile(t,m[_].img,m[_].corners,m[_].img.width);for(var _=0,M=f.length;_<M;_++){var T=null,k=f[_].img;k.fadingStart&&k.fadingEnd&&a<k.fadingEnd&&(T=.2+(a-k.fadingStart)/(k.fadingEnd-k.fadingStart)*.8),this.drawOneTile(t,k,f[_].corners,k.width,T)}if(n){for(var _=0,M=y.length;_<M;_++)this.view.downloader.requestDownload(y[_].img,y[_].url,this.useCors);for(var _=0,M=b.length;_<M;_++)this.view.downloader.requestDownload(b[_].img,b[_].url,this.useCors);this.lastUpdateDateNeededTiles=a}v&&this.view.requestRedrawAtDate(a+r.UPDATE_NEEDED_TILES_DELAY+10)}},r.prototype.drawOneTile=function(t,i,r,o,a,n,s,l){var c=this.useCors?this.cm.apply(i):i;e(t,c,r[0].vx,r[0].vy,r[1].vx,r[1].vy,r[3].vx,r[3].vy,o-1,o-1,o-1,0,0,o-1,a,n,s,l),e(t,c,r[1].vx,r[1].vy,r[3].vx,r[3].vy,r[2].vx,r[2].vy,o-1,0,0,o-1,0,0,a,n,s,l)},r.prototype.setAlpha=function(t){t=+t,this.alpha=Math.max(0,Math.min(t,1)),this.view.requestRedraw()},r.prototype.getAlpha=function(){return this.alpha},r}(),HealpixGrid=function(){var t=function(){};return t.prototype.redraw=function(t,e,i,r){t.lineWidth=1,t.strokeStyle="rgb(150,150,220)",t.beginPath();for(var o,a=0,n=e.length;a<n;a++)o=e[a],ipix=o.ipix,t.moveTo(o[0].vx,o[0].vy),t.lineTo(o[1].vx,o[1].vy),t.lineTo(o[2].vx,o[2].vy);t.stroke(),t.strokeStyle="#FFDDDD",t.beginPath();for(var a=0,n=e.length;a<n;a++)o=e[a],ipix=o.ipix,t.strokeText(r+"/"+ipix,(o[0].vx+o[2].vx)/2,(o[0].vy+o[2].vy)/2);t.stroke()},t}(),Location=function(){return Location=function(t){this.div=$(t)},Location.prototype.update=function(t,e,i){var r=new Coo(t,e,7);i==CooFrameEnum.J2000?this.div.html(r.format("s/")):this.div.html(r.format("d/"))},Location}(),View=function(){function t(e,i,r,o,a){this.aladin=e,this.options=e.options,this.aladinDiv=this.aladin.aladinDiv,this.popup=new Popup(this.aladinDiv),this.createCanvases(),this.location=i,this.fovDiv=r,this.mustClearCatalog=!0,this.mustRedrawReticle=!0,this.mode=t.PAN,this.minFOV=this.maxFOV=null,this.healpixGrid=new HealpixGrid(this.imageCanvas),o?this.cooFrame=o:this.cooFrame=CooFrameEnum.GAL;var n,s;n=s=0,this.projectionMethod=ProjectionEnum.SIN,this.projection=new Projection(n,s),this.projection.setProjection(this.projectionMethod),this.zoomLevel=0,this.zoomFactor=this.computeZoomFactor(this.zoomLevel),this.viewCenter={lon:n,lat:s},a&&this.setZoom(a),this.imageSurvey=null,this.catalogs=[],this.overlays=[],this.tileBuffer=new TileBuffer,this.fixLayoutDimensions(),this.curNorder=1,this.realNorder=1,this.curOverlayNorder=1,this.dragging=!1,this.dragx=null,this.dragy=null,this.needRedraw=!0,this.downloader=new Downloader(this),this.flagForceRedraw=!1,this.fadingLatestUpdate=null,this.dateRequestRedraw=null,this.showGrid=!1,init(this),this.resizeTimer=null;var l=this;$(window).resize(function(){clearTimeout(l.resizeTimer),l.resizeTimer=setTimeout(function(){l.fixLayoutDimensions(l)},100)})}function e(t,e,i,r){if(t.projection){var o=AladinUtils.viewToXy(e,i,t.width,t.height,t.largestDim,t.zoomFactor),a;try{a=t.projection.unproject(o.x,o.y)}catch(t){}a&&t.location.update(a.ra,a.dec,t.cooFrame,r)}}t.PAN=0,t.SELECT=1,t.DRAW_SOURCES_WHILE_DRAGGING=!0,t.prototype.createCanvases=function(){var t=$(this.aladinDiv);t.find(".aladin-imageCanvas").remove(),t.find(".aladin-catalogCanvas").remove(),t.find(".aladin-reticleCanvas").remove(),this.imageCanvas=$("<canvas class='aladin-imageCanvas'></canvas>").appendTo(this.aladinDiv)[0],this.catalogCanvas=$("<canvas class='aladin-catalogCanvas'></canvas>").appendTo(this.aladinDiv)[0],this.reticleCanvas=$("<canvas class='aladin-reticleCanvas'></canvas>").appendTo(this.aladinDiv)[0]},t.prototype.fixLayoutDimensions=function(){Utils.cssScale=void 0,this.width=$(this.aladinDiv).width(),this.height=$(this.aladinDiv).height(),this.width=Math.max(this.width,1),this.height=Math.max(this.height,1),this.cx=this.width/2,this.cy=this.height/2,this.largestDim=Math.max(this.width,this.height),this.smallestDim=Math.min(this.width,this.height),this.ratio=this.largestDim/this.smallestDim,this.mouseMoveIncrement=160/this.largestDim,this.imageCtx=this.imageCanvas.getContext("2d"),this.catalogCtx=this.catalogCanvas.getContext("2d"),this.reticleCtx=this.reticleCanvas.getContext("2d"),this.imageCtx.canvas.width=this.width,this.catalogCtx.canvas.width=this.width,this.reticleCtx.canvas.width=this.width,this.imageCtx.canvas.height=this.height,this.catalogCtx.canvas.height=this.height,this.reticleCtx.canvas.height=this.height,this.computeNorder(),this.requestRedraw()},t.prototype.setMode=function(e){this.mode=e,this.mode==t.SELECT?this.setCursor("crosshair"):this.setCursor("default")},t.prototype.setCursor=function(t){this.reticleCanvas.style.cursor!=t&&(this.reticleCanvas.style.cursor=t)},t.prototype.getCanvasDataURL=function(){var t=document.createElement("canvas");t.width=this.width,t.height=this.height;var e=t.getContext("2d");return e.drawImage(this.imageCanvas,0,0),e.drawImage(this.catalogCanvas,0,0),e.drawImage(this.reticleCanvas,0,0),t.toDataURL("image/png")},computeFov=function(t){var e=doComputeFov(t,t.zoomFactor);return t.mouseMoveIncrement=e/t.imageCanvas.width,e},doComputeFov=function(t,e){if(t.zoomFactor<1)fov=180;else{var i=AladinUtils.viewToXy(0,t.cy,t.width,t.height,t.largestDim,e),r=t.projection.unproject(i.x,i.y),o=AladinUtils.viewToXy(t.imageCanvas.width-1,t.cy,t.width,t.height,t.largestDim,e),a=t.projection.unproject(o.x,o.y);fov=new Coo(r.ra,r.dec).distance(new Coo(a.ra,a.dec))}return fov},updateFovDiv=function(t){if(isNaN(t.fov))return void t.fovDiv.html("FoV:");var e;e=t.fov>1?Math.round(100*t.fov)/100+"°":60*t.fov>1?Math.round(60*t.fov*100)/100+"'":Math.round(3600*t.fov*100)/100+'"',t.fovDiv.html("FoV: "+e)},createListeners=function(i){var r=!1;"ontouchstart"in window&&(r=!0),onDblClick=function(t){var e=i.imageCanvas.relMouseCoords(t),r=AladinUtils.viewToXy(e.x,e.y,i.width,i.height,i.largestDim,i.zoomFactor);try{var o=i.projection.unproject(r.x,r.y)}catch(t){return}radec=[],i.cooFrame==CooFrameEnum.GAL?radec=CooConversion.GalacticToJ2000([o.ra,o.dec]):radec=[o.ra,o.dec],i.pointTo(radec[0],radec[1])},r||$(i.reticleCanvas).dblclick(onDblClick),$(i.reticleCanvas).bind("mousedown touchstart",function(e){var r=i.imageCanvas.relMouseCoords(e);return e.originalEvent&&e.originalEvent.targetTouches?(i.dragx=e.originalEvent.targetTouches[0].clientX,i.dragy=e.originalEvent.targetTouches[0].clientY):(i.dragx=r.x,i.dragy=r.y),i.dragging=!0,i.mode==t.PAN?i.setCursor("move"):i.mode==t.SELECT&&(i.selectStartCoo={x:i.dragx,y:i.dragy}),!1});var o;$(i.reticleCanvas).bind("mouseup mouseout touchend",function(e){if(i.mode==t.SELECT&&i.dragging&&i.aladin.fire("selectend",i.getObjectsInBBox(i.selectStartCoo.x,i.selectStartCoo.y,i.dragx-i.selectStartCoo.x,i.dragy-i.selectStartCoo.y)),i.dragging&&(i.setCursor("default"),i.dragging=!1),i.mustClearCatalog=!0,i.mustRedrawReticle=!0,i.dragx=i.dragy=null,"mouseout"===e.type)return void i.requestRedraw();var r=i.imageCanvas.relMouseCoords(e),a=i.closestObjects(r.x,r.y,5);if(a){for(var n=a[0],s=1;!n.marker&&a.length>=s;){var n=a[s];s++}if(n.marker)i.popup.setTitle(n.popupTitle),i.popup.setText(n.popupDesc),i.popup.setSource(n),i.popup.show();else{if(i.aladin.objClickedFunction)var l=i.aladin.objClickedFunction(n);o=n}}else if(i.aladin.objClickedFunction&&o){o=null;var l=i.aladin.objClickedFunction(null)}i.refreshProgressiveCats(),i.requestRedraw()});var a;$(i.reticleCanvas).bind("mousemove touchmove",function(o){o.preventDefault();var n=i.imageCanvas.relMouseCoords(o);if(!i.dragging||r){if(e(i,n.x,n.y,!0),!i.dragging&&!i.mode==t.SELECT){var s=i.closestObjects(n.x,n.y,5);if(s){if(i.setCursor("pointer"),i.aladin.objHoveredFunction&&s[0]!=a)var l=i.aladin.objHoveredFunction(s[0]);a=s[0];for(var c=s[0],h=1;!c.marker&&s.length>=h;){var c=s[h];a=s[h],h++}c.marker?(i.popup.setTitle(c.popupTitle),i.popup.setText(c.popupDesc),i.popup.setSource(c),i.popup.show()):a&&a.marker&&(i.popup.setSource(a),i.popup.hide())}else if(i.setCursor("default"),a&&a.marker&&(i.popup.setSource(a),i.popup.hide()),i.aladin.objHoveredFunction&&a){a=null;var l=i.aladin.objHoveredFunction(null)}}if(!r)return}var u,d,p,f;if(o.originalEvent&&o.originalEvent.targetTouches){u=o.originalEvent.targetTouches[0].clientX-i.dragx,d=o.originalEvent.targetTouches[0].clientY-i.dragy;var m=AladinUtils.viewToXy(o.originalEvent.targetTouches[0].clientX,o.originalEvent.targetTouches[0].clientY,i.width,i.height,i.largestDim,i.zoomFactor),g=AladinUtils.viewToXy(i.dragx,i.dragy,i.width,i.height,i.largestDim,i.zoomFactor);p=i.projection.unproject(m.x,m.y),f=i.projection.unproject(g.x,g.y)}else{u=n.x-i.dragx,d=n.y-i.dragy;var m=AladinUtils.viewToXy(n.x,n.y,i.width,i.height,i.largestDim,i.zoomFactor),g=AladinUtils.viewToXy(i.dragx,i.dragy,i.width,i.height,i.largestDim,i.zoomFactor);p=i.projection.unproject(m.x,m.y),f=i.projection.unproject(g.x,g.y)}return o.originalEvent&&o.originalEvent.targetTouches?(i.dragx=o.originalEvent.targetTouches[0].clientX,i.dragy=o.originalEvent.targetTouches[0].clientY):(i.dragx=n.x,i.dragy=n.y),i.mode==t.SELECT?void i.requestRedraw():(i.viewCenter.lon+=f.ra-p.ra,i.viewCenter.lat+=f.dec-p.dec,i.viewCenter.lat>90?i.viewCenter.lat=90:i.viewCenter.lat<-90&&(i.viewCenter.lat=-90),i.viewCenter.lon<0?i.viewCenter.lon=360+i.viewCenter.lon:i.viewCenter.lon>360&&(i.viewCenter.lon=i.viewCenter.lon%360),void i.requestRedraw())}),$(i.aladinDiv).onselectstart=function(){return!1},$(i.reticleCanvas).bind("mousewheel",function(t,e){t.preventDefault(),t.stopPropagation();var r=i.zoomLevel;return e>0?r+=1:r-=1,i.setZoomLevel(r),!1})},init=function(t){var e=new Stats;e.domElement.style.top="50px",$("#aladin-statsDiv").length>0&&$("#aladin-statsDiv")[0].appendChild(e.domElement),t.stats=e,createListeners(t),t.displayHpxGrid=!1,t.displaySurvey=!0,t.displayCatalog=!1,t.displayReticle=!0,t.fov=computeFov(t),updateFovDiv(t),t.redraw()},t.prototype.requestRedrawAtDate=function(t){this.dateRequestDraw=t},t.prototype.redraw=function(){var e=this.needRedraw;requestAnimFrame(this.redraw.bind(this));var i=(new Date).getTime();if(this.dateRequestDraw&&i>this.dateRequestDraw)this.dateRequestDraw=null;else if(!this.needRedraw){if(!this.flagForceRedraw)return;this.flagForceRedraw=!1}this.stats.update();var r=this.imageCtx;r.clearRect(0,0,this.imageCanvas.width,this.imageCanvas.height),this.projectionMethod==ProjectionEnum.SIN&&(this.fov>80?(r.fillStyle="rgb(0,0,0)",r.beginPath(),r.arc(this.cx,this.cy,this.cx*this.zoomFactor,0,2*Math.PI,!0),r.fill()):this.fov<60&&(r.fillStyle="rgb(0,0,0)",r.fillRect(0,0,this.imageCanvas.width,this.imageCanvas.height))),this.projection?this.projection.setCenter(this.viewCenter.lon,this.viewCenter.lat):this.projection=new Projection(this.viewCenter.lon,this.viewCenter.lat),this.projection.setProjection(this.projectionMethod);var o=this.getVisibleCells(3),a=null;if(this.curNorder>=3&&(a=3==this.curNorder?o:this.getVisibleCells(this.curNorder)),this.imageSurvey&&this.imageSurvey.isReady&&this.displaySurvey&&(this.imageSurvey.redrawAllsky(r,o,this.fov,this.curNorder),this.curNorder>=3&&this.imageSurvey.redrawHighres(r,a,this.curNorder)),this.overlayImageSurvey&&this.overlayImageSurvey.isReady){if(r.globalAlpha=this.overlayImageSurvey.getAlpha(),this.fov>50&&this.overlayImageSurvey.redrawAllsky(r,o,this.fov,this.curOverlayNorder),this.curOverlayNorder>=3){var n=Math.min(this.curOverlayNorder,this.overlayImageSurvey.maxOrder);n!=this.curNorder&&(a=this.getVisibleCells(n)),this.overlayImageSurvey.redrawHighres(r,a,n)}r.globalAlpha=1}this.displayHpxGrid&&(a&&this.curNorder>3?this.healpixGrid.redraw(r,a,this.fov,this.curNorder):this.healpixGrid.redraw(r,o,this.fov,3)),this.showGrid&&(null==this.cooGrid&&(this.cooGrid=new CooGrid),this.cooGrid.redraw(r,this.projection,this.cooFrame,this.width,this.height,this.largestDim,this.zoomFactor,this.fov));var s=this.catalogCtx,l=!1;this.mustClearCatalog&&(s.clearRect(0,0,this.width,this.height),l=!0,this.mustClearCatalog=!1);var c=this.catalogCtx;if(this.overlays&&this.overlays.length>0&&(!this.dragging||t.DRAW_SOURCES_WHILE_DRAGGING)){l||(s.clearRect(0,0,this.width,this.height),l=!0);for(var h=0;h<this.overlays.length;h++)this.overlays[h].draw(c,this.projection,this.cooFrame,this.width,this.height,this.largestDim,this.zoomFactor,this.cooFrame)}if(this.catalogs&&this.catalogs.length>0&&this.displayCatalog&&(!this.dragging||t.DRAW_SOURCES_WHILE_DRAGGING)){l||(s.clearRect(0,0,this.width,this.height),l=!0);for(var h=0;h<this.catalogs.length;h++)this.catalogs[h].draw(s,this.projection,this.cooFrame,this.width,this.height,this.largestDim,this.zoomFactor,this.cooFrame)}this.mode==t.SELECT&&(mustRedrawReticle=!0);var u=this.reticleCtx;if((this.mustRedrawReticle||this.mode==t.SELECT)&&u.clearRect(0,0,this.width,this.height),this.displayReticle){if(!this.reticleCache){var d=document.createElement("canvas"),p=this.options.reticleSize;d.width=p,d.height=p;var f=d.getContext("2d");f.lineWidth=2,f.strokeStyle=this.options.reticleColor,f.beginPath(),f.moveTo(p/2,p/2+(p/2-1)),f.lineTo(p/2,p/2+2),f.moveTo(p/2,p/2-(p/2-1)),f.lineTo(p/2,p/2-2),f.moveTo(p/2+(p/2-1),p/2),f.lineTo(p/2+2,p/2),f.moveTo(p/2-(p/2-1),p/2),f.lineTo(p/2-2,p/2),f.stroke(),this.reticleCache=d}u.drawImage(this.reticleCache,this.width/2-this.reticleCache.width/2,this.height/2-this.reticleCache.height/2),this.mustRedrawReticle=!1}if(this.mode==t.SELECT&&this.dragging){u.fillStyle="rgba(100, 240, 110, 0.25)";var m=this.dragx-this.selectStartCoo.x,g=this.dragy-this.selectStartCoo.y;u.fillRect(this.selectStartCoo.x,this.selectStartCoo.y,m,g)}e==this.needRedraw&&(this.needRedraw=!1),this.dragging||this.updateObjectsLookup()},t.prototype.forceRedraw=function(){this.flagForceRedraw=!0},t.prototype.refreshProgressiveCats=function(){if(this.catalogs)for(var t=0;t<this.catalogs.length;t++)"progressivecat"==this.catalogs[t].type&&this.catalogs[t].loadNeededTiles()},t.prototype.getVisibleCells=function(t,e){!e&&this.imageSurvey&&(e=this.imageSurvey.cooFrame);var i=[],r=[],o=new SpatialVector,a=Math.pow(2,t),n=HealpixIndex.nside2Npix(a),s=null,l;if(this.fov>80){l=[];for(var c=0;c<n;c++)l.push(c)}else{var h=new HealpixIndex(a);h.init();var u=new SpatialVector,d=AladinUtils.viewToXy(this.cx,this.cy,this.width,this.height,this.largestDim,this.zoomFactor),p=this.projection.unproject(d.x,d.y),f=[];e&&e!=this.cooFrame?e==CooFrameEnum.J2000?f=CooConversion.GalacticToJ2000([p.ra,p.dec]):e==CooFrameEnum.GAL&&(f=CooConversion.J2000ToGalactic([p.ra,p.dec])):f=[p.ra,p.dec],u.set(f[0],f[1]);
var m=.5*this.fov*this.ratio;m*=this.fov>60?1.6:this.fov>12?1.45:1.1,l=h.queryDisc(u,m*Math.PI/180,!0,!0);var g=Utils.radecToPolar(f[0],f[1]);s=h.ang2pix_nest(g.theta,g.phi),l.unshift(s)}for(var c,v,y,b=0,x=l.length;b<x;b++)if(c=l[b],!(c==s&&b>0)){var w=[];corners=HealpixCache.corners_nest(c,a);for(var C=0;C<4;C++){if(o.setXYZ(corners[C].x,corners[C].y,corners[C].z),e&&e!=this.cooFrame){if(e==CooFrameEnum.J2000){var p=CooConversion.J2000ToGalactic([o.ra(),o.dec()]);v=p[0],y=p[1]}else if(e==CooFrameEnum.GAL){var p=CooConversion.GalacticToJ2000([o.ra(),o.dec()]);v=p[0],y=p[1]}}else v=o.ra(),y=o.dec();r[C]=this.projection.project(v,y)}if(null!=r[0]&&null!=r[1]&&null!=r[2]&&null!=r[3]){for(var C=0;C<4;C++)w[C]=AladinUtils.xyToView(r[C].X,r[C].Y,this.width,this.height,this.largestDim,this.zoomFactor);var S=10;if(!(w[0].vx<0&&w[1].vx<0&&w[2].vx<0&&w[3].vx<0||w[0].vy<0&&w[1].vy<0&&w[2].vy<0&&w[3].vy<0||w[0].vx>=this.width&&w[1].vx>=this.width&&w[2].vx>=this.width&&w[3].vx>=this.width||w[0].vy>=this.height&&w[1].vy>=this.height&&w[2].vy>=this.height&&w[3].vy>=this.height)){if(this.projection.PROJECTION==ProjectionEnum.AITOFF){var _=w[0].vx-w[2].vx,M=w[0].vy-w[2].vy,T=Math.sqrt(_*_+M*M);if(T>this.largestDim/5)continue;if(_=w[1].vx-w[3].vx,M=w[1].vy-w[3].vy,T=Math.sqrt(_*_+M*M),T>this.largestDim/5)continue}w.ipix=c,i.push(w)}}}return i},t.prototype.getPositionsInView=function(t,e){for(var i=[],r,o,a=new SpatialVector,n=Math.pow(2,e),s=[],l=HealpixCache.corners_nest(t,n),c=0;c<4;c++){if(a.setXYZ(l[c].x,l[c].y,l[c].z),this.imageSurvey&&this.imageSurvey.cooFrame!=this.cooFrame){if(this.imageSurvey.cooFrame==CooFrameEnum.J2000){var h=CooConversion.J2000ToGalactic([a.ra(),a.dec()]);r=h[0],o=h[1]}else if(this.imageSurvey.cooFrame==CooFrameEnum.GAL){var h=CooConversion.GalacticToJ2000([a.ra(),a.dec()]);r=h[0],o=h[1]}}else r=a.ra(),o=a.dec();i[c]=this.projection.project(r,o)}if(null==i[0]||null==i[1]||null==i[2]||null==i[3])return null;for(var c=0;c<4;c++)s[c]=AladinUtils.xyToView(i[c].X,i[c].Y,this.width,this.height,this.largestDim,this.zoomFactor);return s},t.prototype.computeZoomFactor=function(t){return t>0?AladinUtils.getZoomFactorForAngle(180/Math.pow(1.15,t),this.projectionMethod):1+.1*t},t.prototype.setZoom=function(t){if(!(t<0||t>180)){var e=Math.log(180/t)/Math.log(1.15);this.setZoomLevel(e)}},t.prototype.setShowGrid=function(t){this.showGrid=t,this.requestRedraw()},t.prototype.setZoomLevel=function(t){if(this.minFOV||this.maxFOV){var e=doComputeFov(this,this.computeZoomFactor(Math.max(-2,t)));if(this.maxFOV&&e>this.maxFOV||this.minFOV&&e<this.minFOV)return}if(this.projectionMethod==ProjectionEnum.SIN?this.zoomLevel=Math.max(-2,t):this.zoomLevel=Math.max(-7,t),this.zoomFactor=this.computeZoomFactor(this.zoomLevel),this.fov=computeFov(this),updateFovDiv(this),this.computeNorder(),this.forceRedraw(),this.requestRedraw(),!this.debounceProgCatOnZoom){var i=this;this.debounceProgCatOnZoom=Utils.debounce(function(){i.refreshProgressiveCats()},300)}this.debounceProgCatOnZoom()},t.prototype.computeNorder=function(){var t=this.fov/this.largestDim,e=512,i=HealpixIndex.calculateNSide(3600*e*t),r=Math.log(i)/Math.log(2);r=Math.max(r,1),this.realNorder=r,this.fov<=50&&r<=2&&(r=3),this.imageSurvey&&r<=2&&this.imageSurvey.minOrder>2&&(r=this.imageSurvey.minOrder);var o=r;this.imageSurvey&&r>this.imageSurvey.maxOrder&&(r=this.imageSurvey.maxOrder),this.overlayImageSurvey&&o>this.overlayImageSurvey.maxOrder&&(o=this.overlayImageSurvey.maxOrder),r>HealpixIndex.ORDER_MAX&&(r=HealpixIndex.ORDER_MAX),o>HealpixIndex.ORDER_MAX&&(o=HealpixIndex.ORDER_MAX),this.curNorder=r,this.curOverlayNorder=o},t.prototype.untaintCanvases=function(){this.createCanvases(),createListeners(this),this.fixLayoutDimensions()},t.prototype.setOverlayImageSurvey=function(t,e){if(!t)return this.overlayImageSurvey=null,void this.requestRedraw();$.support.cors&&this.overlayImageSurvey&&!this.overlayImageSurvey.useCors&&this.untaintCanvases();var i;"string"==typeof t?(i=HpxImageSurvey.getSurveyFromId(t),i||(i=HpxImageSurvey.getSurveyFromId(HpxImageSurvey.DEFAULT_SURVEY_ID))):i=t,i.isReady=!1,this.overlayImageSurvey=i;var r=this;i.init(this,function(){r.computeNorder(),i.isReady=!0,r.requestRedraw(),r.updateObjectsLookup(),e&&e()})},t.prototype.setUnknownSurveyIfNeeded=function(){i&&(this.setImageSurvey(i),i=void 0)};var i=void 0;return t.prototype.setImageSurvey=function(t,e){if(t){$.support.cors&&this.imageSurvey&&!this.imageSurvey.useCors&&this.untaintCanvases();var r;"string"==typeof t?(r=HpxImageSurvey.getSurveyFromId(t),r||(r=HpxImageSurvey.getSurveyFromId(HpxImageSurvey.DEFAULT_SURVEY_ID),i=t,console.log(i))):r=t,this.tileBuffer=new TileBuffer,r.isReady=!1,this.imageSurvey=r;var o=this;r.init(this,function(){o.computeNorder(),r.isReady=!0,o.requestRedraw(),o.updateObjectsLookup(),e&&e()})}},t.prototype.requestRedraw=function(){this.needRedraw=!0},t.prototype.changeProjection=function(t){this.projectionMethod=t,this.requestRedraw()},t.prototype.changeFrame=function(t){if(this.cooFrame=t,this.cooFrame==CooFrameEnum.GAL){var e=CooConversion.J2000ToGalactic([this.viewCenter.lon,this.viewCenter.lat]);this.viewCenter.lon=e[0],this.viewCenter.lat=e[1]}else if(this.cooFrame==CooFrameEnum.J2000){var i=CooConversion.GalacticToJ2000([this.viewCenter.lon,this.viewCenter.lat]);this.viewCenter.lon=i[0],this.viewCenter.lat=i[1]}this.requestRedraw()},t.prototype.showHealpixGrid=function(t){this.displayHpxGrid=t,this.requestRedraw()},t.prototype.showSurvey=function(t){this.displaySurvey=t,this.requestRedraw()},t.prototype.showCatalog=function(t){this.displayCatalog=t,this.displayCatalog||(this.mustClearCatalog=!0),this.requestRedraw()},t.prototype.showReticle=function(t){this.displayReticle=t,this.mustRedrawReticle=!0,this.requestRedraw()},t.prototype.pointTo=function(t,e){if(t=parseFloat(t),e=parseFloat(e),!isNaN(t)&&!isNaN(e)){if(this.cooFrame==CooFrameEnum.J2000)this.viewCenter.lon=t,this.viewCenter.lat=e;else if(this.cooFrame==CooFrameEnum.GAL){var i=CooConversion.J2000ToGalactic([t,e]);this.viewCenter.lon=i[0],this.viewCenter.lat=i[1]}this.forceRedraw(),this.requestRedraw();var r=this;setTimeout(function(){r.refreshProgressiveCats()},1e3)}},t.prototype.makeUniqLayerName=function(t){if(!this.layerNameExists(t))return t;for(var e=1;;++e){var i=t+"_"+e;if(!this.layerNameExists(i))return i}},t.prototype.layerNameExists=function(t){for(var e=this.catalogs,i=0;i<e.length;i++)if(t==e[i].name)return!0;return!1},t.prototype.removeLayers=function(){this.catalogs=[],this.overlays=[],this.requestRedraw()},t.prototype.addCatalog=function(t){t.name=this.makeUniqLayerName(t.name),this.catalogs.push(t),"catalog"==t.type?t.setView(this):"progressivecat"==t.type&&t.init(this)},t.prototype.addOverlay=function(t){this.overlays.push(t),t.setView(this)},t.prototype.getObjectsInBBox=function(t,e,i,r){i<0&&(t+=i,i=-i),r<0&&(e+=r,r=-r);var o=[],a,n,s;if(this.catalogs)for(var l=0;l<this.catalogs.length;l++)if(a=this.catalogs[l],a.isShowing){n=a.getSources();for(var c=0;c<n.length;c++)s=n[c],s.isShowing&&s.x&&s.y&&s.x>=t&&s.x<=t+i&&s.y>=e&&s.y<=e+r&&o.push(s)}return o},t.prototype.updateObjectsLookup=function(){this.objLookup=[];var t,e,i,r,o;if(this.catalogs)for(var a=0;a<this.catalogs.length;a++)if(t=this.catalogs[a],t.isShowing){e=t.getSources();for(var n=0;n<e.length;n++)i=e[n],i.isShowing&&i.x&&i.y&&(r=i.x,o=i.y,this.objLookup[r]||(this.objLookup[r]=[]),this.objLookup[r][o]||(this.objLookup[r][o]=[]),this.objLookup[r][o].push(i))}},t.prototype.closestObjects=function(t,e,i){if(!this.objLookup)return null;for(var r,o,a=0;a<=i;a++){r=o=null;for(var n=-i;n<=i;n++)if(this.objLookup[t+n])for(var s=-i;s<=i;s++)if(this.objLookup[t+n][e+s])if(r){var l=n*n+s*s;l<o&&(o=l,r=this.objLookup[t+n][e+s])}else r=this.objLookup[t+n][e+s];if(r)return r}return null},t}(),Aladin=function(){var t=function(e,i){if(0==$(e).length)return void console.log("Could not find div "+e+". Aborting creation of Aladin Lite instance");HealpixCache.init();var r=this;if(void 0===i&&(i=this.getOptionsFromQueryString()),i=i||{},"zoom"in i){var o=i.zoom;delete i.zoom,i.fov=o}var a={};for(var n in t.DEFAULT_OPTIONS)void 0!==i[n]?a[n]=i[n]:a[n]=t.DEFAULT_OPTIONS[n];for(var n in i)void 0===t.DEFAULT_OPTIONS[n]&&(a[n]=i[n]);this.options=a,this.aladinDiv=e,$(e).addClass("aladin-container");var s=CooFrameEnum.fromString(a.cooFrame,CooFrameEnum.J2000),l=s==CooFrameEnum.J2000,c=$('<div class="aladin-location">'+(a.showFrame?'<select class="aladin-frameChoice"><option value="'+CooFrameEnum.J2000+'" '+(l?'selected="selected"':"")+'>J2000</option><option value="'+CooFrameEnum.GAL+'" '+(l?"":'selected="selected"')+">GAL</option></select>":"")+'<span class="aladin-location-text"></span></div>').appendTo(e),h=$('<div class="aladin-fov"></div>').appendTo(e);a.showZoomControl&&$('<div class="aladin-zoomControl"><a href="#" class="zoomPlus" title="Zoom in">+</a><a href="#" class="zoomMinus" title="Zoom out">&ndash;</a></div>').appendTo(e),a.showFullscreenControl&&$('<div class="aladin-fullscreenControl aladin-maximize" title="Full screen"><i class="icon-resize-enlarge"></i></div>').appendTo(e),this.fullScreenBtn=$(e).find(".aladin-fullscreenControl"),this.fullScreenBtn.click(function(){r.toggleFullscreen()}),$("<div class='aladin-logo-container'><a href='http://aladin.u-strasbg.fr/' title='Powered by Aladin Lite' target='_blank'><div class='aladin-logo'></div></a></div>").appendTo(e),this.boxes=[];var u=new Location(c.find(".aladin-location-text"));if(this.view=new View(this,u,h,s,a.fov),this.view.setShowGrid(a.showCooGrid),$.ajax({url:"http://aladin.u-strasbg.fr/java/nph-aladin.pl",data:{frame:"aladinLiteDic"},method:"GET",dataType:"jsonp",success:function(t){for(var e={},i=0;i<t.length;i++)e[t[i].id]=!0;for(var i=0;i<HpxImageSurvey.SURVEYS.length;i++)e[HpxImageSurvey.SURVEYS[i].id]||t.push(HpxImageSurvey.SURVEYS[i]);HpxImageSurvey.SURVEYS=t,r.view.setUnknownSurveyIfNeeded()},error:function(){}}),a.showLayersControl){var d=$('<div class="aladin-layersControl-container" title="Manage layers"><div class="aladin-layersControl"></div></div>');d.appendTo(e);var p=$('<div class="aladin-box aladin-layerBox aladin-cb-list"></div>');p.appendTo(e),this.boxes.push(p),d.click(function(){return r.hideBoxes(),r.showLayerBox(),!1})}if(a.showGotoControl){var d=$('<div class="aladin-gotoControl-container" title="Go to position"><div class="aladin-gotoControl"></div></div>');d.appendTo(e);var f=$('<div class="aladin-box aladin-gotoBox"><a class="aladin-closeBtn">&times;</a><div style="clear: both;"></div><form class="aladin-target-form">Go to: <input type="text" placeholder="Object name/position" /></form></div>');f.appendTo(e),this.boxes.push(f);var m=f.find(".aladin-target-form input");m.on("paste keydown",function(){$(this).removeClass("aladin-unknownObject")}),d.click(function(){return r.hideBoxes(),m.val(""),m.removeClass("aladin-unknownObject"),f.show(),m.focus(),!1}),f.find(".aladin-closeBtn").click(function(){return r.hideBoxes(),!1})}if(a.showShareControl){var d=$('<div class="aladin-shareControl-container" title="Share current view"><div class="aladin-shareControl"></div></div>');d.appendTo(e);var g=$('<div class="aladin-box aladin-shareBox"><a class="aladin-closeBtn">&times;</a><div style="clear: both;"></div><b>Share</b><input type="text" class="aladin-shareInput" /></div>');g.appendTo(e),this.boxes.push(g),d.click(function(){return r.hideBoxes(),g.show(),!1}),g.find(".aladin-closeBtn").click(function(){return r.hideBoxes(),!1})}if(this.gotoObject(a.target),a.log){var v=i;v.version=t.VERSION,Logger.log("startup",v)}if(this.showReticle(a.showReticle),a.catalogUrls)for(var y=0,b=a.catalogUrls.length;y<b;y++)this.createCatalogFromVOTable(a.catalogUrls[y]);this.setImageSurvey(a.survey),this.view.showCatalog(a.showCatalog);var x=this;$(e).find(".aladin-frameChoice").change(function(){x.setFrame($(this).val())}),$("#projectionChoice").change(function(){x.setProjection($(this).val())}),$(e).find(".aladin-target-form").submit(function(){return x.gotoObject($(this).find("input").val(),function(){$(e).find(".aladin-target-form input").addClass("aladin-unknownObject")}),!1});var w=$(e).find(".zoomPlus");w.click(function(){return x.increaseZoom(),!1}),w.bind("mousedown",function(t){t.preventDefault()});var C=$(e).find(".zoomMinus");C.click(function(){return x.decreaseZoom(),!1}),C.bind("mousedown",function(t){t.preventDefault()}),a.fullScreen&&window.setTimeout(function(){r.toggleFullscreen()},1e3)};t.VERSION="{ALADIN-LITE-VERSION-NUMBER}",t.JSONP_PROXY="http://alasky.u-strasbg.fr/cgi/JSONProxy",t.DEFAULT_OPTIONS={target:"0 +0",cooFrame:"J2000",survey:"P/DSS2/color",fov:60,showReticle:!0,showZoomControl:!0,showFullscreenControl:!0,showLayersControl:!0,showGotoControl:!0,showShareControl:!1,showCatalog:!0,showFrame:!0,showCooGrid:!1,fullScreen:!1,reticleColor:"rgb(178, 50, 178)",reticleSize:22,log:!0},t.prototype.toggleFullscreen=function(){this.fullScreenBtn.toggleClass("aladin-maximize aladin-restore");var t=this.fullScreenBtn.hasClass("aladin-restore");this.fullScreenBtn.attr("title",t?"Restore original size":"Full screen"),$(this.aladinDiv).toggleClass("aladin-fullscreen"),t?this.fullScreenBtn.html('<i class="icon-resize-shrink"></i>'):this.fullScreenBtn.html('<i class="icon-resize-enlarge"></i>'),this.view.fixLayoutDimensions()},t.prototype.updateSurveysDropdownList=function(t){t=t.sort(function(t,e){return t.order?t.order&&t.order>e.order?1:-1:t.id>e.id});var e=$(this.aladinDiv).find(".aladin-surveySelection");e.empty();for(var i=0;i<t.length;i++){var r=this.view.imageSurvey.id==t[i].id;e.append($("<option />").attr("selected",r).val(t[i].id).text(t[i].name))}},t.prototype.getOptionsFromQueryString=function(){var t={},e=$.urlParam("target");e&&(t.target=e);var i=$.urlParam("frame");i&&CooFrameEnum[i]&&(t.frame=i);var r=$.urlParam("survey");r&&HpxImageSurvey.getSurveyInfoFromId(r)&&(t.survey=r);var o=$.urlParam("zoom");o&&o>0&&o<180&&(t.zoom=o);var a=$.urlParam("showReticle");a&&(t.showReticle="true"==a.toLowerCase());var n=$.urlParam("cooFrame");n&&(t.cooFrame=n);var s=$.urlParam("fullScreen");return void 0!==s&&(t.fullScreen=s),t},t.prototype.setZoom=function(t){this.view.setZoom(t)},t.prototype.setFoV=function(t){this.view.setZoom(t)},t.prototype.setFrame=function(t){if(t){var e=CooFrameEnum.fromString(t,CooFrameEnum.J2000);e!=this.view.cooFrame&&(this.view.changeFrame(e),$(this.aladinDiv).find(".aladin-frameChoice").val(e))}},t.prototype.setProjection=function(t){if(t)switch(t=t.toLowerCase()){case"aitoff":this.view.changeProjection(ProjectionEnum.AITOFF);break;case"sinus":default:this.view.changeProjection(ProjectionEnum.SIN)}},t.prototype.gotoObject=function(t,e){var i=/[a-zA-Z]/.test(t);if(i){var r=this;Sesame.resolve(t,function(t){var e=t.Target.Resolver.jradeg,i=t.Target.Resolver.jdedeg;r.view.pointTo(e,i)},function(i){console&&(console.log("Could not resolve object name "+t),console.log(i)),e&&e()})}else{var o=new Coo;o.parse(t);var a=[o.lon,o.lat];this.view.cooFrame==CooFrameEnum.GAL&&(a=CooConversion.GalacticToJ2000(a)),this.view.pointTo(a[0],a[1])}},t.prototype.gotoPosition=function(t,e){var i;i=this.view.cooFrame==CooFrameEnum.GAL?CooConversion.GalacticToJ2000([t,e]):[t,e],this.view.pointTo(i[0],i[1])};var e=function(t){var i=t.animationParams;if(null!=i){var r=(new Date).getTime();if(r>i.end)return t.gotoRaDec(i.raEnd,i.decEnd),void(i.complete&&i.complete());var o=i.raStart+(i.raEnd-i.raStart)*(r-i.start)/(i.end-i.start),a=i.decStart+(i.decEnd-i.decStart)*(r-i.start)/(i.end-i.start);t.gotoRaDec(o,a),setTimeout(function(){e(t)},50)}};return t.prototype.animateToRaDec=function(t,i,r,o){r=r||5,this.animationParams=null,e(this);var a={};a.start=(new Date).getTime(),a.end=(new Date).getTime()+1e3*r;var n=this.getRaDec();a.raStart=n[0],a.decStart=n[1],a.raEnd=t,a.decEnd=i,a.complete=o,this.animationParams=a,e(this)},t.prototype.getRaDec=function(){if(this.view.cooFrame==CooFrameEnum.J2000)return[this.view.viewCenter.lon,this.view.viewCenter.lat];var t=CooConversion.GalacticToJ2000([this.view.viewCenter.lon,this.view.viewCenter.lat]);return t},t.prototype.gotoRaDec=function(t,e){this.view.pointTo(t,e)},t.prototype.showHealpixGrid=function(t){this.view.showHealpixGrid(t)},t.prototype.showSurvey=function(t){this.view.showSurvey(t)},t.prototype.showCatalog=function(t){this.view.showCatalog(t)},t.prototype.showReticle=function(t){this.view.showReticle(t),$("#displayReticle").attr("checked",t)},t.prototype.removeLayers=function(){this.view.removeLayers()},t.prototype.addCatalog=function(t){this.view.addCatalog(t)},t.prototype.addOverlay=function(t){this.view.addOverlay(t)},t.prototype.createImageSurvey=function(t,e,i,r,o,a){return new HpxImageSurvey(t,e,i,r,o,a)},t.prototype.getBaseImageLayer=function(){return this.view.imageSurvey},t.prototype.setImageSurvey=function(t,e){if(this.view.setImageSurvey(t,e),this.updateSurveysDropdownList(HpxImageSurvey.getAvailableSurveys()),this.options.log){var i=t;"string"!=typeof t&&(i=t.rootUrl),Logger.log("changeImageSurvey",i)}},t.prototype.setBaseImageLayer=t.prototype.setImageSurvey,t.prototype.getOverlayImageLayer=function(){return this.view.overlayImageSurvey},t.prototype.setOverlayImageLayer=function(t,e){this.view.setOverlayImageSurvey(t,e)},t.prototype.increaseZoom=function(t){t||(t=5),this.view.setZoomLevel(this.view.zoomLevel+t)},t.prototype.decreaseZoom=function(t){t||(t=5),this.view.setZoomLevel(this.view.zoomLevel-t)},t.prototype.createCatalog=function(t){return A.catalog(t)},t.prototype.createProgressiveCatalog=function(t,e,i,r){return new ProgressiveCat(t,e,i,r)},t.prototype.createSource=function(t,e,i){return new cds.Source(t,e,i)},t.prototype.createMarker=function(t,e,i,r){return i=i||{},i.marker=!0,new cds.Source(t,e,r,i)},t.prototype.createOverlay=function(t){return new Overlay(t)},t.prototype.createFootprintsFromSTCS=function(t){for(var e=Overlay.parseSTCS(t),i=[],r=0,o=e.length;r<o;r++)i.push(new Footprint(e[r]));return i},t.prototype.createCatalogFromVOTable=function(t,e){return A.catalogFromURL(t,e)},A.catalogFromURL=function(t,e,i){var r=A.catalog(e);return cds.Catalog.parseVOTable(t,function(t){r.addSources(t),i&&i(t)}),r},t.prototype.on=function(t,e){"select"===t?this.selectFunction=e:"objectClicked"==t?this.objClickedFunction=e:"objectHovered"==t&&(this.objHoveredFunction=e)},t.prototype.select=function(){this.fire("selectstart")},t.prototype.fire=function(t,e){"selectstart"===t?this.view.setMode(View.SELECT):"selectend"===t&&(this.view.setMode(View.PAN),this.selectFunction&&this.selectFunction(e))},t.prototype.hideBoxes=function(){if(this.boxes)for(var t=0;t<this.boxes.length;t++)this.boxes[t].hide()},t.prototype.updateCM=function(){},t.prototype.showLayerBox=function(){var t=this,e=$(this.aladinDiv).find(".aladin-layerBox");e.empty(),e.append('<a class="aladin-closeBtn">&times;</a><div style="clear: both;"></div><div class="aladin-label">Base image layer</div><select class="aladin-surveySelection"></select><div class="aladin-cmap">Color map:<div><select class="aladin-cmSelection"></select><button class="aladin-btn aladin-btn-small aladin-reverseCm" type="button">Reverse</button></div></div><div class="aladin-box-separator"></div><div class="aladin-label">Overlay layers</div>');for(var i=e.find(".aladin-cmap"),r=e.find(".aladin-cmSelection"),o=0;o<ColorMap.MAPS_NAMES.length;o++)r.append($("<option />").text(ColorMap.MAPS_NAMES[o]));r.val(t.getBaseImageLayer().getColorMap().map);for(var a=this.view.catalogs,n="<ul>",o=a.length-1;o>=0;o--){var s=a[o].name,l="";a[o].isShowing&&(l='checked="checked"');var c=a[o].getSources().length,h=c+" source"+(c>1?"s":"");n+='<li><div class="aladin-layerIcon" style="background: '+a[o].color+';"></div><input type="checkbox" '+l+' id="aladin_lite_'+s+'"></input><label for="aladin_lite_'+s+'" class="aladin-layer-label" style="background: '+a[o].color+';" title="'+h+'">'+s+"</label></li>"}n+="</ul>",e.append(n),e.append('<div class="aladin-blank-separator"></div>');var l="";this.view.displayReticle&&(l='checked="checked"');var u=$('<input type="checkbox" '+l+' id="displayReticle" />');e.append(u).append('<label for="displayReticle">Reticle</label><br/>'),u.change(function(){t.showReticle($(this).is(":checked"))}),l="",this.view.displayHpxGrid&&(l='checked="checked"');var d=$('<input type="checkbox" '+l+' id="displayHpxGrid"/>');e.append(d).append('<label for="displayHpxGrid">HEALPix grid</label><br/>'),d.change(function(){t.showHealpixGrid($(this).is(":checked"))}),e.append('<div class="aladin-box-separator"></div><div class="aladin-label">Tools</div>');var p=$('<button class="aladin-btn" type="button">Export view as PNG</button>');e.append(p),p.click(function(){t.exportAsPNG()}),e.find(".aladin-closeBtn").click(function(){return t.hideBoxes(),!1}),this.updateSurveysDropdownList(HpxImageSurvey.getAvailableSurveys());var f=$(this.aladinDiv).find(".aladin-surveySelection");f.change(function(){var e=HpxImageSurvey.getAvailableSurveys()[$(this)[0].selectedIndex];t.setImageSurvey(e.id,function(){var e=t.getBaseImageLayer();e.useCors?(r.val(e.getColorMap().map),i.show(),p.show()):(i.hide(),p.hide())})}),i.find(".aladin-cmSelection").change(function(){var e=$(this).find(":selected").val();t.getBaseImageLayer().getColorMap().update(e)}),i.find(".aladin-reverseCm").click(function(){t.getBaseImageLayer().getColorMap().reverse()}),this.getBaseImageLayer().useCors?(i.show(),p.show()):(i.hide(),p.hide()),e.find(".aladin-reverseCm").parent().attr("disabled",!0),$(this.aladinDiv).find(".aladin-layerBox ul input").change(function(){var e=$(this).attr("id").substr(12),i=t.layerByName(e);$(this).is(":checked")?i.show():i.hide()}),e.show()},t.prototype.layerByName=function(t){for(var e=this.view.catalogs,i=0;i<this.view.catalogs.length;i++)if(t==e[i].name)return e[i];return null},t.prototype.exportAsPNG=function(){var t=this.view.getCanvasDataURL();window.open(t,"Aladin Lite snapshot")},t.prototype.setFOVRange=function(t,e){if(t>e){var i=t;t=e,e=i}this.view.minFOV=t,this.view.maxFOV=e},t.prototype.pix2world=function(t,e){var i=AladinUtils.viewToXy(t,e,this.view.width,this.view.height,this.view.largestDim,this.view.zoomFactor),r=this.view.projection.unproject(i.x,i.y),o;return o=this.view.cooFrame==CooFrameEnum.GAL?CooConversion.GalacticToJ2000([r.ra,r.dec]):[r.ra,r.dec]},t.prototype.world2pix=function(t,e){var i;if(this.view.cooFrame==CooFrameEnum.GAL){var r=CooConversion.J2000ToGalactic([t,e]);i=this.view.projection.project(r[0],r[1])}else i=this.view.projection.project(t,e);if(i){var o=AladinUtils.xyToView(i.X,i.Y,this.view.width,this.view.height,this.view.largestDim,this.view.zoomFactor);return[o.vx,o.vy]}return null},t.prototype.getFovCorners=function(t){(!t||t<1)&&(t=1);for(var e=[],i,r,o,a,n=0;n<4;n++){i=0==n||3==n?0:this.view.width-1,r=n<2?0:this.view.height-1,o=n<2?this.view.width-1:0,a=1==n||2==n?this.view.height-1:0;for(var s=0;s<t;s++)e.push(this.pix2world(i+s/t*(o-i),r+s/t*(a-r)))}return e},t.prototype.getFov=function(){var t=this.view.fov,e=this.getSize(),i=e[1]/e[0]*t;return t=Math.min(t,180),i=Math.min(i,180),[t,i]},t.prototype.getSize=function(){return[this.view.width,this.view.height]},t.prototype.getParentDiv=function(){return $(this.aladinDiv)},t}(),A.aladin=function(t,e){return new Aladin($(t)[0],e)},A.imageLayer=function(t,e,i,r){return new HpxImageSurvey(t,e,i,null,null,r)},A.source=function(t,e,i,r){return new cds.Source(t,e,i,r)},A.marker=function(t,e,i,r){return i=i||{},i.marker=!0,A.source(t,e,r,i)},A.polygon=function(t){var e=t.length;return e>0&&(t[0][0]==t[e-1][0]&&t[0][1]==t[e-1][1]||t.push([t[0][0],t[0][1]])),new Footprint(t)},A.polyline=function(t,e){return new Polyline(t,e)},A.circle=function(t,e,i,r){return new Circle([t,e],i,r)},A.graphicOverlay=function(t){return new Overlay(t)},A.catalog=function(t){return new cds.Catalog(t)},Aladin.prototype.displayFITS=function(t,e){e=e||{};var i={url:t};e.color&&(i.color=!0),e.outputFormat&&(i.format=e.outputFormat),e.order&&(i.order=e.order),e.nocache&&(i.nocache=e.nocache),$.ajax({url:"http://alasky.u-strasbg.fr/cgi/fits2HiPS",data:i,method:"GET",dataType:"json",success:function(t){if("success"!=t.status)return void alert("An error occured: "+t.message);var i=e.label||"FITS image";aladin.setOverlayImageLayer(aladin.createImageSurvey(i,i,t.data.url,"equatorial",t.data.meta.max_norder,{imgFormat:"png"})),aladin.setFoV(t.data.meta.fov),aladin.gotoRaDec(t.data.meta.ra,t.data.meta.dec);var r=e&&e.transparency||1;aladin.getOverlayImageLayer().setAlpha(r)}})},Aladin.prototype.displayJPG=Aladin.prototype.displayPNG=function(t,e){e=e||{},e.color=!0,e.label="JPG/PNG image",e.outputFormat="png",this.displayFITS(t,e)},$&&($.aladin=A.aladin),!function($){var t='[data-dismiss="alert"]',e=function(e){$(e).on("click",t,this.close)};e.prototype.close=function(t){function e(){o.trigger("closed").remove()}var i=$(this),r=i.attr("data-target"),o;r||(r=i.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,"")),o=$(r),t&&t.preventDefault(),o.length||(o=i.hasClass("alert")?i:i.parent()),o.trigger(t=$.Event("close")),t.isDefaultPrevented()||(o.removeClass("in"),$.support.transition&&o.hasClass("fade")?o.on($.support.transition.end,e):e())};var i=$.fn.alert;$.fn.alert=function(t){return this.each(function(){var i=$(this),r=i.data("alert");r||i.data("alert",r=new e(this)),"string"==typeof t&&r[t].call(i)})},$.fn.alert.Constructor=e,$.fn.alert.noConflict=function(){return $.fn.alert=i,this},$(document).on("click.alert.data-api",t,e.prototype.close)}(window.jQuery);var post_to_url_in_background=function(t){t.preventDefault();var e=$(this).attr("href"),i=$(this).attr("action");"undefined"!=typeof e&&e!==!1&&$.get(e,function(t,e){});var r=$(this).attr("notification");if("undefined"!=typeof r&&r!==!1){var r=decodeURIComponent(r),o=$("span#dynamicNotification");o.html(r)}},multi_link_exploder=function(){var t=$(this).siblings("ul.dropdown-menu").children("li");t.each(function(t){var e=$(this).children("a").attr("href");window.open(e,"_blank")})};$(function(){$(document.body).on("click","a.postInBackground",post_to_url_in_background),$("div.objectLinkExploder").on("click","button:first",multi_link_exploder)});var ra_sex2degrees=function(t){t=t.replace(/ /g,":"),t=t.replace(/h/g,":"),t=t.replace(/m/g,":"),t=t.replace(/s/g,"");var e=t.split(":"),i=15*parseInt(e[0],10),r=15*parseInt(e[1],10),o=15*parseFloat(e[2],10),a=i+r/60+o/3600;return a},dec_sex2degrees=function(t){var e;t=t.replace(/ /g,":"),t=t.replace(/d/g,":"),t=t.replace(/m/g,":"),t=t.replace(/s/g,"");var i=t.split(":");e="-"==i[0][0]?-1:1;var r=parseInt(i[0],10),o=parseInt(i[1],10),a=parseFloat(i[2],10);r=Math.abs(r);var n=(r+o/60+a/3600)*e;return n},date_to_mjd=function(t){var e=t/864e5-t.getTimezoneOffset()/1440+2440587.5-2400000.5;return e},fade_and_hide=function(t){t.animate({opacity:.25},150),t.delay(600).slideUp(300)},show_and_unfade=function(t){t.animate({opacity:1},150),t.delay(600).slideDown(300)};!function($){var t=function(t,e){this.$element=$(t),this.options=$.extend({},$.fn.collapse.defaults,e),this.options.parent&&(this.$parent=$(this.options.parent)),this.options.toggle&&this.toggle()};t.prototype={constructor:t,dimension:function(){var t=this.$element.hasClass("width");return t?"width":"height"},show:function(){var t,e,i,r;if(!this.transitioning&&!this.$element.hasClass("in")){if(t=this.dimension(),e=$.camelCase(["scroll",t].join("-")),i=this.$parent&&this.$parent.find("> .accordion-group > .in"),i&&i.length){if(r=i.data("collapse"),r&&r.transitioning)return;i.collapse("hide"),r||i.data("collapse",null)}this.$element[t](0),this.transition("addClass",$.Event("show"),"shown"),$.support.transition&&this.$element[t](this.$element[0][e])}},hide:function(){var t;!this.transitioning&&this.$element.hasClass("in")&&(t=this.dimension(),this.reset(this.$element[t]()),this.transition("removeClass",$.Event("hide"),"hidden"),this.$element[t](0))},reset:function(t){var e=this.dimension();return this.$element.removeClass("collapse")[e](t||"auto")[0].offsetWidth,this.$element[null!==t?"addClass":"removeClass"]("collapse"),this},transition:function(t,e,i){var r=this,o=function(){"show"==e.type&&r.reset(),r.transitioning=0,r.$element.trigger(i)};this.$element.trigger(e),e.isDefaultPrevented()||(this.transitioning=1,this.$element[t]("in"),$.support.transition&&this.$element.hasClass("collapse")?this.$element.one($.support.transition.end,o):o())},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}};var e=$.fn.collapse;$.fn.collapse=function(e){return this.each(function(){var i=$(this),r=i.data("collapse"),o=$.extend({},$.fn.collapse.defaults,i.data(),"object"==typeof e&&e);r||i.data("collapse",r=new t(this,o)),"string"==typeof e&&r[e]()})},$.fn.collapse.defaults={toggle:!0},$.fn.collapse.Constructor=t,$.fn.collapse.noConflict=function(){return $.fn.collapse=e,this},$(document).on("click.collapse.data-api","[data-toggle=collapse]",function(t){var e=$(this),i,r=e.attr("data-target")||t.preventDefault()||(i=e.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,""),o=$(r).data("collapse")?"toggle":e.data();e[$(r).hasClass("in")?"addClass":"removeClass"]("collapsed"),$(r).collapse(o)})}(window.jQuery),!function($){$(function(){$.support.transition=function(){var t=function(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},i;for(i in e)if(void 0!==t.style[i])return e[i]}();return t&&{end:t}}()})}(window.jQuery),!function($){var t=function(t,e){this.$element=$(t),this.options=$.extend({},$.fn.button.defaults,e)};t.prototype.setState=function(t){var e="disabled",i=this.$element,r=i.data(),o=i.is("input")?"val":"html";t+="Text",r.resetText||i.data("resetText",i[o]()),i[o](r[t]||this.options[t]),setTimeout(function(){"loadingText"==t?i.addClass(e).attr(e,e):i.removeClass(e).removeAttr(e)},0)},t.prototype.toggle=function(){var t=this.$element.closest('[data-toggle="buttons-radio"]');t&&t.find(".active").removeClass("active"),this.$element.toggleClass("active")};var e=$.fn.button;$.fn.button=function(e){return this.each(function(){var i=$(this),r=i.data("button"),o="object"==typeof e&&e;r||i.data("button",r=new t(this,o)),"toggle"==e?r.toggle():e&&r.setState(e)})},$.fn.button.defaults={loadingText:"loading..."},$.fn.button.Constructor=t,$.fn.button.noConflict=function(){return $.fn.button=e,this},$(document).on("click.button.data-api","[data-toggle^=button]",function(t){var e=$(t.target);e.hasClass("btn")||(e=e.closest(".btn")),e.button("toggle")})}(window.jQuery),!function($){function t(){$(i).each(function(){e($(this)).removeClass("open")})}function e(t){var e=t.attr("data-target"),i;return e||(e=t.attr("href"),e=e&&/#/.test(e)&&e.replace(/.*(?=#[^\s]*$)/,"")),i=e&&$(e),i&&i.length||(i=t.parent()),i}var i="[data-toggle=dropdown]",r=function(t){var e=$(t).on("click.dropdown.data-api",this.toggle);$("html").on("click.dropdown.data-api",function(){e.closest(":not(span)").removeClass("open")})};r.prototype={constructor:r,toggle:function(i){var r=$(this),o,a;if(!r.is(".disabled, :disabled"))return o=e(r),a=o.hasClass("open"),t(),a||o.toggleClass("open"),r.focus(),!1},keydown:function(t){var r,o,a,n,s,l;if(/(38|40|27)/.test(t.keyCode)&&(r=$(this),t.preventDefault(),t.stopPropagation(),!r.is(".disabled, :disabled"))){if(n=e(r),s=n.hasClass("open"),!s||s&&27==t.keyCode)return 27==t.which&&n.find(i).focus(),r.click();o=$("[role=menu] li:not(.divider):visible a",n),o.length&&(l=o.index(o.filter(":focus")),38==t.keyCode&&l>0&&l--,40==t.keyCode&&l<o.length-1&&l++,~l||(l=0),o.eq(l).focus())}}};var o=$.fn.dropdown;$.fn.dropdown=function(t){return this.each(function(){var e=$(this),i=e.data("dropdown");i||e.data("dropdown",i=new r(this)),"string"==typeof t&&i[t].call(e)})},$.fn.dropdown.Constructor=r,$.fn.dropdown.noConflict=function(){return $.fn.dropdown=o,this},$(document).on("click.dropdown.data-api",t).on("click.dropdown.data-api",".dropdown form",function(t){
t.stopPropagation()}).on("click.dropdown-menu",function(t){t.stopPropagation()}).on("click.dropdown.data-api",i,r.prototype.toggle).on("keydown.dropdown.data-api",i+", [role=menu]",r.prototype.keydown)}(window.jQuery);var _markdownwiki_move_page_form=function(){var t=$("form[action*='change_parent_id_of_md_page']"),e=t.find("select[branch=0]"),i=e.closest("div.control-group"),r=void 0,o=void 0,a=void 0,n=void 0,s=void 0,l=void 0,c=void 0,h=void 0,u=new Array,d="";t.on("change","select[branch]",function(){r=$(this).attr("branch"),$(this).attr("name","parentId"),parentId=$(this).find("option:selected").attr("value"),l=$(this).find("option:selected").text(),$("select[branch]").each(function(t){$(this).attr("branch")>r&&$(this).closest(".controls").fadeOut(200,function(){$(this).remove()})}),$("p.textAlert").fadeOut(200,function(){$("p.textAlert").remove()}),a="select distinct title, pageId from base_md_pages where pageId in (select * from (select distinct pageId from base_md_pages where parentPageId = "+parentId+") as alais) order by pageId, revisionNumber desc;",a=encodeURIComponent(a),d=window.location.toString();var i=d.split("/apollo/");d=i.length>1?"/apollo/assets/scripts/dryxScripts/sql_to_json.py?sqlQuery=":"/assets/scripts/dryxScripts/sql_to_json.py?sqlQuery=",n=$.ajax({url:d+a,success:function(i){0===i.length?(text='<p class="textAlert text-center text-info"><em>`'+l+"`</em> has no sub-pages</p>",t.append(text),$("p.textAlert").hide().fadeIn(200)):(c=e.closest(".control-group").clone(),c.find(".control-label").remove(),o=c.find("select[branch]"),o.html(""),o.attr("branch",r+1).hide().fadeIn(200),o.attr("name","unselected"),thisOption='<option value="none">select a sub-page</option>',o.append(thisOption),u=[],$.each(i,function(t,e){$.inArray(i[t].pageId,u)===-1&&(thisOption='<option value="'+i[t].pageId+'">'+i[t].title+"</option>",o.append(thisOption),u.push(i[t].pageId))}),t.append(c))}})})}(),_no_project_status_selection_form=function(){var t=$("a.projectStatus");return t.bind("click",function(t){var e=$(this).closest("tr");fade_and_hide(e)}),{}}();!function($){var t=function(t,e){this.$element=$(t),this.options=$.extend({},$.fn.typeahead.defaults,e),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.source=this.options.source,this.$menu=$(this.options.menu),this.shown=!1,this.listen()};t.prototype={constructor:t,select:function(){var t=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(t)).change(),this.hide()},updater:function(t){return t},show:function(){var t=$.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return this.$menu.insertAfter(this.$element).css({top:t.top+t.height,left:t.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(t){var e;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(e=$.isFunction(this.source)?this.source(this.query,$.proxy(this.process,this)):this.source,e?this.process(e):this)},process:function(t){var e=this;return t=$.grep(t,function(t){return e.matcher(t)}),t=this.sorter(t),t.length?this.render(t.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(t){return~t.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(t){for(var e=[],i=[],r=[],o;o=t.shift();)o.toLowerCase().indexOf(this.query.toLowerCase())?~o.indexOf(this.query)?i.push(o):r.push(o):e.push(o);return e.concat(i,r)},highlighter:function(t){var e=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return t.replace(new RegExp("("+e+")","ig"),function(t,e){return"<strong>"+e+"</strong>"})},render:function(t){var e=this;return t=$(t).map(function(t,i){return t=$(e.options.item).attr("data-value",i),t.find("a").html(e.highlighter(i)),t[0]}),t.first().addClass("active"),this.$menu.html(t),this},next:function(t){var e=this.$menu.find(".active").removeClass("active"),i=e.next();i.length||(i=$(this.$menu.find("li")[0])),i.addClass("active")},prev:function(t){var e=this.$menu.find(".active").removeClass("active"),i=e.prev();i.length||(i=this.$menu.find("li").last()),i.addClass("active")},listen:function(){this.$element.on("focus",$.proxy(this.focus,this)).on("blur",$.proxy(this.blur,this)).on("keypress",$.proxy(this.keypress,this)).on("keyup",$.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",$.proxy(this.keydown,this)),this.$menu.on("click",$.proxy(this.click,this)).on("mouseenter","li",$.proxy(this.mouseenter,this)).on("mouseleave","li",$.proxy(this.mouseleave,this))},eventSupported:function(t){var e=t in this.$element;return e||(this.$element.setAttribute(t,"return;"),e="function"==typeof this.$element[t]),e},move:function(t){if(this.shown){switch(t.keyCode){case 9:case 13:case 27:t.preventDefault();break;case 38:t.preventDefault(),this.prev();break;case 40:t.preventDefault(),this.next()}t.stopPropagation()}},keydown:function(t){this.suppressKeyPressRepeat=~$.inArray(t.keyCode,[40,38,9,13,27]),this.move(t)},keypress:function(t){this.suppressKeyPressRepeat||this.move(t)},keyup:function(t){switch(t.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}t.stopPropagation(),t.preventDefault()},focus:function(t){this.focused=!0},blur:function(t){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(t){t.stopPropagation(),t.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(t){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),$(t.currentTarget).addClass("active")},mouseleave:function(t){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var e=$.fn.typeahead;$.fn.typeahead=function(e){return this.each(function(){var i=$(this),r=i.data("typeahead"),o="object"==typeof e&&e;r||i.data("typeahead",r=new t(this,o)),"string"==typeof e&&r[e]()})},$.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},$.fn.typeahead.Constructor=t,$.fn.typeahead.noConflict=function(){return $.fn.typeahead=e,this},$(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var e=$(this);e.data("typeahead")||e.typeahead(e.data())})}(window.jQuery),!function($){var t=function(t,e){this.$element=$(t),this.$indicators=this.$element.find(".carousel-indicators"),this.options=e,"hover"==this.options.pause&&this.$element.on("mouseenter",$.proxy(this.pause,this)).on("mouseleave",$.proxy(this.cycle,this))};t.prototype={cycle:function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval($.proxy(this.next,this),this.options.interval)),this},getActiveIndex:function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(),this.$items.index(this.$active)},to:function(t){var e=this.getActiveIndex(),i=this;if(!(t>this.$items.length-1||t<0))return this.sliding?this.$element.one("slid",function(){i.to(t)}):e==t?this.pause().cycle():this.slide(t>e?"next":"prev",$(this.$items[t]))},pause:function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&$.support.transition.end&&(this.$element.trigger($.support.transition.end),this.cycle(!0)),clearInterval(this.interval),this.interval=null,this},next:function(){if(!this.sliding)return this.slide("next")},prev:function(){if(!this.sliding)return this.slide("prev")},slide:function(t,e){var i=this.$element.find(".item.active"),r=e||i[t](),o=this.interval,a="next"==t?"left":"right",n="next"==t?"first":"last",s=this,l;if(this.sliding=!0,o&&this.pause(),r=r.length?r:this.$element.find(".item")[n](),l=$.Event("slide",{relatedTarget:r[0],direction:a}),!r.hasClass("active")){if(this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid",function(){var t=$(s.$indicators.children()[s.getActiveIndex()]);t&&t.addClass("active")})),$.support.transition&&this.$element.hasClass("slide")){if(this.$element.trigger(l),l.isDefaultPrevented())return;r.addClass(t),r[0].offsetWidth,i.addClass(a),r.addClass(a),this.$element.one($.support.transition.end,function(){r.removeClass([t,a].join(" ")).addClass("active"),i.removeClass(["active",a].join(" ")),s.sliding=!1,setTimeout(function(){s.$element.trigger("slid")},0)})}else{if(this.$element.trigger(l),l.isDefaultPrevented())return;i.removeClass("active"),r.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return o&&this.cycle(),this}}};var e=$.fn.carousel;$.fn.carousel=function(e){return this.each(function(){var i=$(this),r=i.data("carousel"),o=$.extend({},$.fn.carousel.defaults,"object"==typeof e&&e),a="string"==typeof e?e:o.slide;r||i.data("carousel",r=new t(this,o)),"number"==typeof e?r.to(e):a?r[a]():o.interval&&r.pause().cycle()})},$.fn.carousel.defaults={interval:5e3,pause:"hover"},$.fn.carousel.Constructor=t,$.fn.carousel.noConflict=function(){return $.fn.carousel=e,this},$(document).on("click.carousel.data-api","[data-slide], [data-slide-to]",function(t){var e=$(this),i,r=$(e.attr("data-target")||(i=e.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,"")),o=$.extend({},r.data(),e.data()),a;r.carousel(o),(a=e.attr("data-slide-to"))&&r.data("carousel").pause().to(a).cycle(),t.preventDefault()})}(window.jQuery),!function($){var t=function(t,e){this.options=$.extend({},$.fn.affix.defaults,e),this.$window=$(window).on("scroll.affix.data-api",$.proxy(this.checkPosition,this)).on("click.affix.data-api",$.proxy(function(){setTimeout($.proxy(this.checkPosition,this),1)},this)),this.$element=$(t),this.checkPosition()};t.prototype.checkPosition=function(){if(this.$element.is(":visible")){var t=$(document).height(),e=this.$window.scrollTop(),i=this.$element.offset(),r=this.options.offset,o=r.bottom,a=r.top,n="affix affix-top affix-bottom",s;"object"!=typeof r&&(o=a=r),"function"==typeof a&&(a=r.top()),"function"==typeof o&&(o=r.bottom()),s=!(null!=this.unpin&&e+this.unpin<=i.top)&&(null!=o&&i.top+this.$element.height()>=t-o?"bottom":null!=a&&e<=a&&"top"),this.affixed!==s&&(this.affixed=s,this.unpin="bottom"==s?i.top-e:null,this.$element.removeClass(n).addClass("affix"+(s?"-"+s:"")))}};var e=$.fn.affix;$.fn.affix=function(e){return this.each(function(){var i=$(this),r=i.data("affix"),o="object"==typeof e&&e;r||i.data("affix",r=new t(this,o)),"string"==typeof e&&r[e]()})},$.fn.affix.Constructor=t,$.fn.affix.defaults={offset:0},$.fn.affix.noConflict=function(){return $.fn.affix=e,this},$(window).on("load",function(){$('[data-spy="affix"]').each(function(){var t=$(this),e=t.data();e.offset=e.offset||{},e.offsetBottom&&(e.offset.bottom=e.offsetBottom),e.offsetTop&&(e.offset.top=e.offsetTop),t.affix(e)})})}(window.jQuery),!function($){function t(t,e){var i=$.proxy(this.process,this),r=$($(t).is("body")?window:t),o;this.options=$.extend({},$.fn.scrollspy.defaults,e),this.$scrollElement=r.on("scroll.scroll-spy.data-api",i),this.selector=(this.options.target||(o=$(t).attr("href"))&&o.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.$body=$("body"),this.refresh(),this.process()}t.prototype={constructor:t,refresh:function(){var t=this,e;this.offsets=$([]),this.targets=$([]),e=this.$body.find(this.selector).map(function(){var e=$(this),i=e.data("target")||e.attr("href"),r=/^#\w/.test(i)&&$(i);return r&&r.length&&[[r.position().top+(!$.isWindow(t.$scrollElement.get(0))&&t.$scrollElement.scrollTop()),i]]||null}).sort(function(t,e){return t[0]-e[0]}).each(function(){t.offsets.push(this[0]),t.targets.push(this[1])})},process:function(){var t=this.$scrollElement.scrollTop()+this.options.offset,e=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,i=e-this.$scrollElement.height(),r=this.offsets,o=this.targets,a=this.activeTarget,n;if(t>=i)return a!=(n=o.last()[0])&&this.activate(n);for(n=r.length;n--;)a!=o[n]&&t>=r[n]&&(!r[n+1]||t<=r[n+1])&&this.activate(o[n])},activate:function(t){var e,i;this.activeTarget=t,$(this.selector).parent(".active").removeClass("active"),i=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',e=$(i).parent("li").addClass("active"),e.parent(".dropdown-menu").length&&(e=e.closest("li.dropdown").addClass("active")),e.trigger("activate")}};var e=$.fn.scrollspy;$.fn.scrollspy=function(e){return this.each(function(){var i=$(this),r=i.data("scrollspy"),o="object"==typeof e&&e;r||i.data("scrollspy",r=new t(this,o)),"string"==typeof e&&r[e]()})},$.fn.scrollspy.Constructor=t,$.fn.scrollspy.defaults={offset:10},$.fn.scrollspy.noConflict=function(){return $.fn.scrollspy=e,this},$(window).on("load",function(){$('[data-spy="scroll"]').each(function(){var t=$(this);t.scrollspy(t.data())})})}(window.jQuery),!function($){var t=function(t){this.element=$(t)};t.prototype={constructor:t,show:function(){var t=this.element,e=t.closest("ul:not(.dropdown-menu)"),i=t.attr("data-target"),r,o,a;i||(i=t.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,"")),t.parent("li").hasClass("active")||(r=e.find(".active:last a")[0],a=$.Event("show",{relatedTarget:r}),t.trigger(a),a.isDefaultPrevented()||(o=$(i),this.activate(t.parent("li"),e),this.activate(o,o.parent(),function(){t.trigger({type:"shown",relatedTarget:r})})))},activate:function(t,e,i){function r(){o.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),a?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),i&&i()}var o=e.find("> .active"),a=i&&$.support.transition&&o.hasClass("fade");a?o.one($.support.transition.end,r):r(),o.removeClass("in")}};var e=$.fn.tab;$.fn.tab=function(e){return this.each(function(){var i=$(this),r=i.data("tab");r||i.data("tab",r=new t(this)),"string"==typeof e&&r[e]()})},$.fn.tab.Constructor=t,$.fn.tab.noConflict=function(){return $.fn.tab=e,this},$(document).on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),$(this).tab("show")})}(window.jQuery),$(function(){var t=$("div#leftSidebar");$(window).innerWidth()>1040&&$(window).innerHeight()>1.2*t.height()&&$("div#leftSidebar").affix({offset:{top:170,bottom:100}})});var submit_modal_forms=function(){var t=$("button[formId]"),e=void 0,i=void 0;return t.bind("click",function(t){i=$(this).attr("formId"),e=$("#"+i),e.submit()}),{}}();!function($){var t=function(t,e){this.options=e,this.$element=$(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",$.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};t.prototype={constructor:t,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,e=$.Event("show");this.$element.trigger(e),this.isShown&&console.log("this is shown already"),e.isDefaultPrevented()&&console.log("event prevented"),this.isShown||e.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.backdrop(function(){var e=$.support.transition&&t.$element.hasClass("fade");t.$element.parent().length||t.$element.appendTo(document.body),t.$element.show(),e&&t.$element[0].offsetWidth,t.$element.addClass("in").attr("aria-hidden",!1),t.enforceFocus(),e?t.$element.one($.support.transition.end,function(){t.$element.focus().trigger("shown")}):t.$element.focus().trigger("shown")}))},hide:function(t){t&&t.preventDefault();var e=this;t=$.Event("hide"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,this.escape(),$(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),$.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal())},enforceFocus:function(){var t=this;$(document).on("focusin.modal",function(e){t.$element[0]===e.target||t.$element.has(e.target).length||t.$element.focus()})},escape:function(){var t=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(e){27==e.which&&t.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var t=this,e=setTimeout(function(){t.$element.off($.support.transition.end),t.hideModal()},500);this.$element.one($.support.transition.end,function(){clearTimeout(e),t.hideModal()})},hideModal:function(){var t=this;this.$element.hide(),this.backdrop(function(){t.removeBackdrop(),t.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(t){var e=this,i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var r=$.support.transition&&i;if(this.$backdrop=$('<div class="modal-backdrop '+i+'" />').appendTo(document.body),this.$backdrop.click("static"==this.options.backdrop?$.proxy(this.$element[0].focus,this.$element[0]):$.proxy(this.hide,this)),r&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;r?this.$backdrop.one($.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),$.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one($.support.transition.end,t):t()):t&&t()}};var e=$.fn.modal;$.fn.modal=function(e){return this.each(function(){var i=$(this),r=i.data("modal"),o=$.extend({},$.fn.modal.defaults,i.data(),"object"==typeof e&&e);r||i.data("modal",r=new t(this,o)),"string"==typeof e?r[e]():o.show&&r.show()})},$.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},$.fn.modal.Constructor=t,$.fn.modal.noConflict=function(){return $.fn.modal=e,this},$(document).on("click.modal.data-api",'[data-toggle="modal"]',function(t){var e=$(this),i=e.attr("href"),r=$(e.attr("data-target")||i&&i.replace(/.*(?=#[^\s]+$)/,"")),o=r.data("modal")?"toggle":$.extend({remote:!/#/.test(i)&&i},r.data(),e.data());t.preventDefault(),r.modal(o).one("hide",function(){e.focus()})})}(window.jQuery),!function($){var t=function(t,e){this.init("tooltip",t,e)};t.prototype={constructor:t,init:function(t,e,i){var r,o,a,n,s;for(this.type=t,this.$element=$(e),this.options=this.getOptions(i),this.enabled=!0,a=this.options.trigger.split(" "),s=a.length;s--;)n=a[s],"click"==n?this.$element.on("click."+this.type,this.options.selector,$.proxy(this.toggle,this)):"manual"!=n&&(r="hover"==n?"mouseenter":"focus",o="hover"==n?"mouseleave":"blur",this.$element.on(r+"."+this.type,this.options.selector,$.proxy(this.enter,this)),this.$element.on(o+"."+this.type,this.options.selector,$.proxy(this.leave,this)));this.options.selector?this._options=$.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){return t=$.extend({},$.fn[this.type].defaults,this.$element.data(),t),t.delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},enter:function(t){var e=$.fn[this.type].defaults,i={},r;return this._options&&$.each(this._options,function(t,r){e[t]!=r&&(i[t]=r)},this),r=$(t.currentTarget)[this.type](i).data(this.type),r.options.delay&&r.options.delay.show?(clearTimeout(this.timeout),r.hoverState="in",void(this.timeout=setTimeout(function(){"in"==r.hoverState&&r.show()},r.options.delay.show))):r.show()},leave:function(t){var e=$(t.currentTarget)[this.type](this._options).data(this.type);return this.timeout&&clearTimeout(this.timeout),e.options.delay&&e.options.delay.hide?(e.hoverState="out",void(this.timeout=setTimeout(function(){"out"==e.hoverState&&e.hide()},e.options.delay.hide))):e.hide()},show:function(){$("div.tooltip").not(this).each(function(t){var e=$(this).hide()}),$("div.popover").not(this).each(function(t){var e=$(this).hide()});var t,e,i,r,o,a,n=$.Event("show");if(this.hasContent()&&this.enabled){if(this.$element.trigger(n),n.isDefaultPrevented())return;switch(t=this.tip(),this.setContent(),this.options.animation&&t.addClass("fade"),o="function"==typeof this.options.placement?this.options.placement.call(this,t[0],this.$element[0]):this.options.placement,t.detach().css({top:0,left:0,display:"block"}),this.options.container?t.appendTo(this.options.container):t.insertBefore(this.$element),e=this.getPosition(),i=t[0].offsetWidth,r=t[0].offsetHeight,o){case"bottom":a={top:e.top+e.height,left:e.left+e.width/2-i/2};break;case"top":a={top:e.top-r,left:e.left+e.width/2-i/2};break;case"left":a={top:e.top+e.height/2-r/2,left:e.left-i};break;case"right":a={top:e.top+e.height/2-r/2,left:e.left+e.width}}this.applyPlacement(a,o),this.$element.trigger("shown")}},applyPlacement:function(t,e){var i=this.tip(),r=i[0].offsetWidth,o=i[0].offsetHeight,a,n,s,l;i.offset(t).addClass(e).addClass("in"),a=i[0].offsetWidth,n=i[0].offsetHeight,"top"==e&&n!=o&&(t.top=t.top+o-n,l=!0),"bottom"==e||"top"==e?(s=0,t.left<0&&(s=t.left*-2,t.left=0,i.offset(t),a=i[0].offsetWidth,n=i[0].offsetHeight),this.replaceArrow(s-r+a,a,"left")):this.replaceArrow(n-o,n,"top"),l&&i.offset(t)},replaceArrow:function(t,e,i){this.arrow().css(i,t?50*(1-t/e)+"%":"")},setContent:function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},hide:function(){function t(){var t=setTimeout(function(){i.off($.support.transition.end).detach()},500);i.one($.support.transition.end,function(){clearTimeout(t),i.detach()})}var e=this,i=this.tip(),r=$.Event("hide");if(this.$element.trigger(r),!r.isDefaultPrevented())return i.removeClass("in"),$.support.transition&&this.$tip.hasClass("fade")?t():i.detach(),this.$element.trigger("hidden"),this},fixTitle:function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},hasContent:function(){return this.getTitle()},getPosition:function(){var t=this.$element[0];return $.extend({},"function"==typeof t.getBoundingClientRect?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},getTitle:function(){var t,e=this.$element,i=this.options;return t=e.attr("data-original-title")||("function"==typeof i.title?i.title.call(e[0]):i.title)},tip:function(){return this.$tip=this.$tip||$(this.options.template)},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(t){var e=t?$(t.currentTarget)[this.type](this._options).data(this.type):this;e.tip().hasClass("in")?e.hide():e.show()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};var e=$.fn.tooltip;$.fn.tooltip=function(e){return this.each(function(){var i=$(this),r=i.data("tooltip"),o="object"==typeof e&&e;r||i.data("tooltip",r=new t(this,o)),"string"==typeof e&&r[e]()})},$.fn.tooltip.Constructor=t;var i=$.fn.tooltip.Constructor.prototype.leave;$.fn.tooltip.Constructor.prototype.leave=function(t){var e,r;if(r=$(t.currentTarget)[this.type](this._options).data(this.type),t.currentTarget)return e=$(".tooltip"),this.timeout=setTimeout(function(){r.hide()},100),e.one("mouseenter",function(){return clearTimeout(r.timeout),e.one("mouseleave",function(){return i.call(r,t)})})},$.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},$.fn.tooltip.noConflict=function(){return $.fn.tooltip=e,this}}(window.jQuery),$("[rel='tooltip']").tooltip(),!function($){var t=function(t,e){this.init("popover",t,e)};t.prototype=$.extend({},$.fn.tooltip.Constructor.prototype,{constructor:t,setContent:function(){var t=this.tip(),e=this.getTitle(),i=this.getContent();t.find(".popover-title")[this.options.html?"html":"text"](e),t.find(".popover-content")[this.options.html?"html":"text"](i),t.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var t,e=this.$element,i=this.options;return t=("function"==typeof i.content?i.content.call(e[0]):i.content)||e.attr("data-content")},tip:function(){return this.$tip||(this.$tip=$(this.options.template)),this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}});var e=$.fn.popover;$.fn.popover=function(e){return this.each(function(){var i=$(this),r=i.data("popover"),o="object"==typeof e&&e;r||i.data("popover",r=new t(this,o)),"string"==typeof e&&r[e]()})},$.fn.popover.Constructor=t;var i=$.fn.popover.Constructor.prototype.leave;$.fn.popover.Constructor.prototype.leave=function(t){var e,r;if(r=$(t.currentTarget)[this.type](this._options).data(this.type),i.call(this,t),t.currentTarget)return e=$(".popover"),e.one("mouseenter",function(){return clearTimeout(r.timeout),e.one("mouseleave",function(){return i.call(r,t)})})},$.fn.popover.defaults=$.extend({},$.fn.tooltip.defaults,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),$.fn.popover.noConflict=function(){return $.fn.popover=e,this}}(window.jQuery),$("[rel='popover']").popover(),!function($){$(document.body).on("click","th.link",function(t){href=$(this).attr("href"),window.location=href}),$(document.body).on("click","tr.link > td",function(t){t.target===this&&(href=$(this).closest("tr.link").attr("href"),window.location=href)})}(window.jQuery),function(){for(var t,e=function(){},i=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],r=i.length,o=window.console=window.console||{};r--;)t=i[r],o[t]||(o[t]=e)}();var pause=function(t){var e=new Date,i=null;do i=new Date;while(i-e<t)},update_chart_element=function(){var t=!0,e=void 0,i=void 0,r=void 0,o=function(r){e=r.parent_element,a(e,r,t),n(i,t,r),s(i,r),h(i,r),l(i,r),c(r),void 0!==r.transform&&i.attr("transform",r.transform),void 0!==r.element_call&&i.call(r.element_call)},a=function(t,e,r){i="datapoint"==e.element_selector||"tooltips"==e.element_selector?t.selectAll(e.element_selector):t.select(e.elemet_selector),i.empty()||void 0!==e.remove_if&&(i.remove(),i=t.select(e.element_selector)),i.empty()?e.element_type&&(i=t.append(e.element_type).attr("class",e.element_class)):(t=e.parent_element.transition(),i="datapoint"==e.element_selector||"tooltips"==e.element_selector?t.selectAll(e.element_selector).duration(750):t.select(e.element_selector).duration(750),r=!1)},n=function(t,e,i){void 0!=i.element_data&&void 0!=i.element_data.data&&"datapoint"!=i.element_selector&&"tooltips"!=i.element_selector&&(e&&t.data([i.element_data.data]),void 0!==i.element_data.attr&&t.attr("d",i.element_data.attr))},s=function(t,e){if("datapoint"===e.element_selector)var i=t.data(e.element_data.datapoints.data).enter().append(e.element_data.datapoints.shape).attr("r",e.element_data.datapoints.attrs.radius).attr("cx",e.element_data.datapoints.datapoints.x).attr("cy",e.element_data.datapoints.datapoints.y)},l=function(t,e){void 0!==e.element_id&&t.attr("id",e.element_id),void 0!==e.element_class&&t.attr("class",e.element_class)},c=function(t){if(void 0!=t.extras){if(void 0!==t.extras.attr){var e=t.extras.attr;for(aa=0;aa<e.length;aa++){var r=e[aa];i.attr(r.attr,r.value)}}if(void 0!==t.extras.text){var o=t.extras.text;for(ta=0;ta<o.length;ta++){var a=o[ta];i.text(a)}}}},h=function(t,e){if("tooltips"===e.element_selector){var i=t.data(e.element_data.tooltips.data).enter().append(e.element_data.tooltips.shape).attr("r",e.element_data.tooltips.attrs.radius).attr("cx",e.element_data.tooltips.datapoints.x).attr("cy",e.element_data.tooltips.datapoints.y).attr("rel","tooltip").attr("title",e.element_data.tooltips.datapoints.tooltip).attr("data-container","body").attr("data-placement","top").attr("data-trigger","hover").attr("data-html",!0);$('[rel="tooltip"]').tooltip()}};return{update:o}}(),chartCanvas=function(){var t=null,e=null,r=null,o=null,a=null,n=null,s=null,l=null,c=null,h={top:null,right:null,bottom:null,left:null},u=null,d=function(t){return l=t,u=$(l),r=d3.select(l),S(r,u),r=r.append("g").attr("transform","translate("+h.left+","+h.top+")"),{canvas:r,width:n,height:s,update_settings:p}},p=function(t){return void 0!==t.axes&&(y(t.axes.x1Gridlines),b(t.axes.y1Gridlines)),void 0!==t.axes&&(f(t.axes),g(t.axes),m(t.axes),v(t.axes)),void 0!==t.dataline&&void 0!==t.dataline.dataline&&void 0!==t.dataline.dataline.line&&x(t.dataline),void 0!==t.dataline&&void 0!==t.dataline.dataline&&void 0!==t.dataline.dataline.area&&w(t.dataline),void 0!==t.chartTitle&&C(t.chartTitle),void 0!==t.datapoints&&k(t.datapoints),void 0!==t.errorBars&&N(t.errorBars),void 0!==t.tooltips&&A(t.tooltips),{canvas:r,width:n,height:s,update_settings:p}},f=function(t){update_chart_element.update({element_type:"g",element_selector:"g.x1axis",element_class:"x1axis axis",element_call:t.x1Axis,parent_element:r,transform:"translate(0,"+M()+")"}),void 0!==t.x1LabelsRotate?r.select("g.x1axis").selectAll("text").style("text-anchor","end").attr("dx","-.5em").attr("dy",".2em").attr("transform",function(e){return"rotate("+t.x1LabelsRotate+")"}):r.select("g.x1axis").selectAll("text").attr("dy","1em")},m=function(t){void 0!=t.x2Axis&&(update_chart_element.update({element_type:"g",element_selector:"g.x2axis",element_class:"x2axis axis",element_call:t.x2Axis,parent_element:r,transform:"translate(0,0)"}),void 0!==t.x2LabelsRotate?r.select("g.x2axis").selectAll("text").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform",function(e){return"rotate("+t.x2LabelsRotate+")"}):r.select("g.x2axis").selectAll("text").attr("dy","-.4em"))},g=function(t){update_chart_element.update({element_type:"g",element_selector:"g.y1axis",element_class:"y1axis axis",element_call:t.y1Axis,parent_element:r,update_if:void 0!==t.dataline}),void 0!==t.y1LabelsRotate&&0!==t.y1LabelsRotate?r.select("g.y1axis").selectAll("text").style("text-anchor","end").attr("dx","-.1em").attr("dy",".7em").attr("transform",function(e){return"rotate("+t.y1LabelsRotate+")"}):r.select("g.y1axis").selectAll("text").attr("dx","-.1em")},v=function(t){void 0!=t.y2Axis&&(update_chart_element.update({element_type:"g",element_selector:"g.y2axis",element_class:"y2axis axis",element_call:t.y2Axis,parent_element:r,update_if:void 0!==t.dataline,transform:"translate("+_()+",0)"}),void 0!==t.y2LabelsRotate&&0!==t.y1LabelsRotate?r.select("g.y2axis").selectAll("text").style("text-anchor","end").attr("dx","-.1em").attr("dy",".7em").attr("transform",function(e){return"rotate("+t.y2LabelsRotate+")"}):r.select("g.y2axis").selectAll("text").attr("dx","+.1em"))},y=function(t){update_chart_element.update({element_type:"g",element_selector:"g.x1grid",element_class:"grid x1grid",element_call:t,parent_element:r,transform:"translate(0,"+M()+")",update_if:!0})},b=function(t){update_chart_element.update({element_type:"g",element_selector:"g.y1grid",element_class:"grid y1grid",element_call:t,parent_element:r,transform:void 0,update_if:!0})},x=function(t){update_chart_element.update({element_type:"path",element_selector:"path#line"+t.dataline.id,element_class:"line "+t.dataline.color,element_id:"line"+t.dataline.id,element_call:void 0,element_data:{data:t.data,attr:t.dataline.line},parent_element:r,transform:void 0})},w=function(t){update_chart_element.update({element_type:"path",element_selector:"path#area"+t.dataline.id,element_class:"area "+t.dataline.color,element_id:"area"+t.dataline.id,element_call:void 0,element_data:{data:t.data,attr:t.dataline.area},parent_element:r,transform:void 0})},C=function(t){update_chart_element.update({
element_type:"text",element_selector:"text.chartTitle",element_class:"text chartTitle",extras:{attr:[{attr:"x",value:o/3},{attr:"y",value:0-h.top/2}],text:[t]},parent_element:r,transform:void 0})},S=function(t,e){o=e.width(),t.attr("width",o),a=t.classed("square",!0)?o:e.height(),t.attr("height",a),h.top=.1*a,h.bottom=.2*a,h.left=.1*o,h.right=.1*o,n=_(),s=M()},_=function(){return n=o-h.left-h.right},M=function(){return s=a-h.top-h.bottom},T=function(t){f(t.x1Axis),g(t.y1Axis),y(t.x1Gridlines),b(t.y1Gridlines)},k=function(t){t=t.datapoints,update_chart_element.update({element_selector:"datapoint",element_class:"datapoint "+t.color,element_id:"datapoint"+t.id,element_data:{datapoints:t},element_call:void 0,parent_element:r,transform:void 0,parent_element:r,transform:void 0})},N=function(t){var e=t.data;for(i=0;i<e.length;i++){var o=e[i];update_chart_element.update({element_type:"path",element_selector:"path#line"+t.line.id,element_class:"line "+t.line.color+" "+t.line.htmlclass,element_id:"line"+t.line.id,element_call:void 0,element_data:{data:o,attr:t.line.line},parent_element:r,transform:void 0})}},A=function(t){update_chart_element.update({element_selector:"tooltips",element_class:"tooltips "+t.color,element_id:"tooltips"+t.id,element_data:{tooltips:t},element_call:void 0,parent_element:r,transform:void 0,parent_element:r,transform:void 0})};return{set_canvas_element:d}},chartAxes=function(){var t=void 0,e=void 0,i=void 0,r=void 0,o=void 0,a=void 0,n=void 0,s=void 0,l=void 0,c=void 0,h=void 0,u=void 0,d=void 0,p=void 0,f=void 0,m=void 0,g=void 0,v=1,y=1,b=1,x=1,w=3,C=3,S=3,_=3,M=function(e){return t=e,{y1:k(),x1:T(),y1Axis:U(),x1Axis:z(),y1Gridlines:J(w),x1Gridlines:V(S),x1LabelsRotate:a,y1LabelsRotate:n,y2:A(),x2:N(),y2Axis:B(),x2Axis:q(),y2Gridlines:H(C),x2Gridlines:G(_),x2LabelsRotate:u,y2LabelsRotate:d,update_settings:I}},T=function(){return c=d3.scale.linear().range([0,t.width])},k=function(){return h=d3.scale.linear().range([t.height,0])},N=function(){return m=d3.time.scale().range([0,t.width])},A=function(){return g=d3.scale.linear().range([t.height,0])},I=function(t){void 0!==t.x1Range&&R(t.x1Range),void 0!==t.y1Range&&E(t.y1Range),void 0!==t.x1Title&&L(t.x1Title),void 0!==t.y1Title&&F(t.y1Title),void 0!==t.x1LabelsRotate&&(t.axes.x1LabelsRotate=+t.x1LabelsRotate),void 0!==t.y1LabelsRotate&&(t.axes.y1LabelsRotate=+t.y1LabelsRotate),void 0!==t.y1TickFormat&&t.axes.y1Axis.tickFormat(t.y1TickFormat),void 0!==t.x1TickFormat&&t.axes.x1Axis.tickFormat(t.x1TickFormat),void 0!==t.x2Range&&O(t.x2Range),void 0!==t.y2Range&&P(t.y2Range),void 0!==t.x2Title&&D(t.x2Title),void 0!==t.y2Title&&j(t.y2Title),void 0!==t.x2LabelsRotate&&(t.axes.x2LabelsRotate=+t.x2LabelsRotate),void 0!==t.y2LabelsRotate&&(t.axes.y2LabelsRotate=+t.y2LabelsRotate),void 0!==t.y2TickFormat&&t.axes.y2Axis.tickFormat(t.y2TickFormat),void 0!==t.x2TickFormat&&t.axes.x2Axis.tickFormat(t.x2TickFormat),void 0!==t.x1TickSize&&t.axes.x1Axis.tickSize(-t.x1TickSize),void 0!==t.x2TickSize&&t.axes.x2Axis.tickSize(-t.x2TickSize),void 0!==t.y1TickSize&&t.axes.y1Axis.tickSize(-t.y1TickSize),void 0!==t.y2TickSize&&t.axes.y2Axis.tickSize(-t.y2TickSize),void 0!==t.y1NumberOfTicks&&(t.axes.y1Axis.ticks(t.y1NumberOfTicks),t.axes.y1Gridlines.ticks(t.y1NumberOfTicks)),void 0!==t.y2NumberOfTicks&&(t.axes.y2Axis.ticks(t.y2NumberOfTicks),t.axes.y2Gridlines.ticks(t.y2NumberOfTicks)),void 0!==t.x1NumberOfTicks&&(t.axes.x1Axis.ticks(t.x1NumberOfTicks),t.axes.x1Gridlines.ticks(t.x1NumberOfTicks)),void 0!==t.x2NumberOfTicks&&(t.axes.x2Axis.ticks(t.x2NumberOfTicks),t.axes.x2Gridlines.ticks(t.x2NumberOfTicks))},R=function(t){c.domain(t)},E=function(t){h.domain(t)},O=function(t){m.domain(t)},P=function(t){g.domain(t)},L=function(e){update_chart_element.update({element_type:"text",element_selector:"text.x1Title",element_class:"text x1Title",extras:{attr:[{attr:"x",value:t.width/2},{attr:"y",value:1.07*t.height}],text:[e]},parent_element:t.canvas,transform:void 0})},F=function(e){update_chart_element.update({element_type:"text",element_selector:"text.y1Title",element_class:"text y1Title",extras:{attr:[{attr:"x",value:0-t.height/2},{attr:"y",value:0-.07*t.width},{attr:"dy",value:"0em"},{attr:"dx",value:"-3em"}],text:[e]},parent_element:t.canvas,transform:"rotate(-90)"})},D=function(e){update_chart_element.update({element_type:"text",element_selector:"text.x2Title",element_class:"text x2Title",extras:{attr:[{attr:"x",value:t.width/2},{attr:"y",value:1.15*t.height}],text:[x1Title]},parent_element:t.canvas,transform:void 0})},j=function(e){update_chart_element.update({element_type:"text",element_selector:"text.y2Title",element_class:"text y2Title",extras:{attr:[{attr:"x",value:0-t.height/2},{attr:"y",value:0-.07*t.width},{attr:"dy",value:"1em"}],text:[y1Title]},parent_element:t.canvas,transform:"rotate(-90)"})},z=function(){return x1Axis=d3.svg.axis().scale(c).orient("bottom").ticks(S),x1Axis},U=function(){return y1Axis=d3.svg.axis().scale(h).orient("left").ticks(w),y1Axis},q=function(){return x2Axis=d3.svg.axis().scale(m).orient("top").ticks(_),x2Axis},B=function(){return y2Axis=d3.svg.axis().scale(g).orient("right").ticks(C),y2Axis},V=function(e){return r=d3.svg.axis().scale(c).orient("bottom").ticks(e).tickSize(-t.height,0,0).tickFormat("")},J=function(e){return o=d3.svg.axis().scale(h).orient("left").ticks(e).tickSize(-t.width,0,0).tickFormat("")},G=function(e){return x2GridLines=d3.svg.axis().scale(m).orient("top").ticks(e).tickSize(-t.height,0,0).tickFormat(""),x2GridLines},H=function(e){return y2GridLines=d3.svg.axis().scale(g).orient("right").ticks(e).tickSize(-t.width,0,0).tickFormat(""),y2GridLines};return{initialise_axes_for_chart:M}},chartPath=function(){var t=null,e=null,i=function(t){return e=t.area?a(t):void 0,{line:o(t),area:e,x1Values:t.x1Values,y1Values:t.y1Values,id:t.id,color:t.color,htmlclass:t.htmlclass}},r=function(t){},o=function(t){return valueline=d3.svg.line().interpolate("basis").x(function(e){return t.axes.x1(e[t.x1Values])}).y(function(e){return t.axes.y1(e[t.y1Values])}),valueline},a=function(t){return e=d3.svg.area().interpolate("basis").x(function(e){return t.axes.x1(e[t.x1Values])}).y0(t.chart.height).y1(function(e){return t.axes.y1(e[t.y1Values])})};return{initialise_path:i}},chartDatapoints=function(){var t=null,e=function(t){return{datapoints:r(t),id:t.id,color:t.color,shape:t.shape,attrs:o(t),data:t.data}},i=function(t){},r=function(t){return datapoints={x:function(e){return t.axes.x1(e[t.x1Values])},y:function(e){return t.axes.y1(e[t.y1Values])}},datapoints},o=function(t){var e={};return"circle"==t.shape&&(e={radius:t.radius}),e};return{init:e,update_settings:i}},chartErrorBars=function(){var t=function(t){return{line:r(t),data:o(t)}},e=function(t){},r=function(t){var e=d3.svg.line().interpolate("linear").x(function(t){return t.x}).y(function(t){return t.y});return e={line:e,x1Values:"x",y1Values:"y",id:t.id,color:t.color,htmlclass:t.htmlclass}},o=function(t){var e=new Array,r=t.data;for(i=0;i<r.length;i++){var o=r[i],a=[{x:t.axes.x1(o[t.x1Values]),y:t.axes.y1(o[t.y1Values]-o[t.y1Errors])},{x:t.axes.x1(o[t.x1Values]),y:t.axes.y1(o[t.y1Values]+o[t.y1Errors])}];e.push(a),thisRange=t.x1Range[0]-t.x1Range[1];var n=[{x:t.axes.x1(o[t.x1Values]-thisRange/150),y:t.axes.y1(o[t.y1Values]-o[t.y1Errors])},{x:t.axes.x1(o[t.x1Values]+thisRange/150),y:t.axes.y1(o[t.y1Values]-o[t.y1Errors])}];e.push(n);var s=[{x:t.axes.x1(o[t.x1Values]-thisRange/150),y:t.axes.y1(o[t.y1Values]+o[t.y1Errors])},{x:t.axes.x1(o[t.x1Values]+thisRange/150),y:t.axes.y1(o[t.y1Values]+o[t.y1Errors])}];e.push(s)}return e};return{init:t,update_attributes:e}},chartDataTooltips=function(){var t=void 0,e=function(t){return{div:r(),tooltipContents:t.tooltipContents,datapoints:o(t),id:t.id,color:t.color,shape:t.shape,attrs:a(t),data:t.data}},i=function(t){},r=function(){var t=d3.select("body").append("div").attr("class","tooltip-data").style("opacity",0);return t},o=function(t){return hoverpoints={x:function(e){return t.axes.x1(e[t.x1Values])},y:function(e){return t.axes.y1(e[t.y1Values])},tooltip:function(t){return t.tooltip}},hoverpoints},a=function(t){var e={};return"circle"==t.shape&&(e={radius:t.radius}),e};return{init:e,update_attributes:i}},transientLightcurve=function(){var t=void 0,e=void 0,i=void 0,r=void 0,o=void 0,a=void 0,n=d3.time.format("%Y-%m-%dT%H:%M:%S").parse,s=function(r){return o=d3.select(r),t=$(r).attr("data-src"),i=new chartCanvas,i=i.set_canvas_element(r),e=new chartAxes,e=e.initialise_axes_for_chart(i),{}},l=function(){d3.json(t,function(t){data=t.chartData,data.forEach(function(t){t.observationDate=n(t.observationDate),t.mjd=+t.mjd,t.magnitude=+t.magnitude,t.observationMJD=+t.observationMJD}),a=c(t),u(data),h(t),d(data,a),p(data)})},c=function(t){var i=d3.max(data,function(t){return t.observationDate}),r=d3.min(data,function(t){return t.observationDate}),o=(+i-+r)/864e5;if(o<3){minX2range=2592e5;var a=(+i+ +r)/2;i=a+minX2range/2,r=a-minX2range/2,i=new Date(i),r=new Date(r)}x2Range=[r,i];var n=date_to_mjd(i),s=date_to_mjd(r),l=[s,n],c=d3.max(data,function(t){return t.magnitude}),h=d3.min(data,function(t){return t.magnitude});if(y1Range=3,c-h<y1Range){var u=(c+h)/2;h=u-y1Range/2,c=u+y1Range/2}return y1Range=[c,h],thisRange=Math.floor(n-s),thisRange<6?x1NumberOfTicks=thisRange:x1NumberOfTicks=6,e.update_settings({chartTitle:t.chartAttributes.title,axes:e,x1Range:l,y1Range:y1Range,x2Range:x2Range,y2Range:y1Range,x1Title:t.chartAttributes.x1title,y1Title:t.chartAttributes.y1title,x1LabelsRotate:void 0,y1LabelsRotate:void 0,x1TickFormat:d3.format("d"),y1TickFormat:void 0,x2TickFormat:d3.time.format("%Y-%m-%d"),x1TickSize:6,y1TickSize:6,x2TickSize:6,y2TickSize:6,x1NumberOfTicks:x1NumberOfTicks,x2NumberOfTicks:x1NumberOfTicks,y1NumberOfTicks:6,y2NumberOfTicks:6}),l},h=function(t){i.update_settings({chartTitle:t.chartAttributes.title,axes:e,dataline:{}})},u=function(t){dataline=new chartPath,dataline=dataline.initialise_path({axes:e,chart:i,x1Values:"observationMJD",y1Values:"magnitude",color:"lightgrey",id:Math.floor(1e4*Math.random()+1).toString()}),datapoints=new chartDatapoints,datapoints=datapoints.init({data:t,x1Values:"observationMJD",y1Values:"magnitude",y1Errors:"magnitudeError",color:"red",id:Math.floor(1e4*Math.random()+1).toString(),shape:"circle",radius:3.5,axes:e,chart:i}),i.update_settings({dataline:{dataline:dataline,data:t},datapoints:{datapoints:datapoints}})},d=function(t,r){errorBars=new chartErrorBars,errorBars=errorBars.init({data:t,axes:e,chart:i,x1Range:r,x1Values:"observationMJD",y1Values:"magnitude",y1Errors:"magnitudeError",color:"black",id:Math.floor(1e4*Math.random()+1).toString(),htmlclass:"errorbar"}),i.update_settings({errorBars:errorBars})},p=function(t){tooltips=new chartDataTooltips,tooltips=tooltips.init({data:t,x1Values:"observationMJD",y1Values:"magnitude",color:"red",id:Math.floor(1e4*Math.random()+1).toString(),shape:"circle",radius:3.5,axes:e,chart:i,htmlclass:"tooltip"}),i.update_settings({tooltips:tooltips})};return{init:s,plot:l}},plot_lightcurves=function(){var t=new Array;$("svg[chartType='lightcurve']").each(function(e,i){var r=new transientLightcurve;r.init(i),r.plot(),t.push(r)})}(),hljs=new function(){function t(t){return t.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;")}function e(t){return t.nodeName.toLowerCase()}function i(t,e){var i=t&&t.exec(e);return i&&0==i.index}function r(t){return Array.prototype.map.call(t.childNodes,function(t){return 3==t.nodeType?y.useBR?t.nodeValue.replace(/\n/g,""):t.nodeValue:"br"==e(t)?"\n":r(t)}).join("")}function o(t){var e=(t.className+" "+(t.parentNode?t.parentNode.className:"")).split(/\s+/);return e=e.map(function(t){return t.replace(/^language-/,"")}),e.filter(function(t){return v(t)||"no-highlight"==t})[0]}function a(t,e){var i={};for(var r in t)i[r]=t[r];if(e)for(var r in e)i[r]=e[r];return i}function n(t){var i=[];return function t(r,o){for(var a=r.firstChild;a;a=a.nextSibling)3==a.nodeType?o+=a.nodeValue.length:"br"==e(a)?o+=1:1==a.nodeType&&(i.push({event:"start",offset:o,node:a}),o=t(a,o),i.push({event:"stop",offset:o,node:a}));return o}(t,0),i}function s(i,r,o){function a(){return i.length&&r.length?i[0].offset!=r[0].offset?i[0].offset<r[0].offset?i:r:"start"==r[0].event?i:r:i.length?i:r}function n(i){function r(e){return" "+e.nodeName+'="'+t(e.value)+'"'}h+="<"+e(i)+Array.prototype.map.call(i.attributes,r).join("")+">"}function s(t){h+="</"+e(t)+">"}function l(t){("start"==t.event?n:s)(t.node)}for(var c=0,h="",u=[];i.length||r.length;){var d=a();if(h+=t(o.substr(c,d[0].offset-c)),c=d[0].offset,d==i){u.reverse().forEach(s);do l(d.splice(0,1)[0]),d=a();while(d==i&&d.length&&d[0].offset==c);u.reverse().forEach(n)}else"start"==d[0].event?u.push(d[0].node):u.pop(),l(d.splice(0,1)[0])}return h+t(o.substr(c))}function l(t){function e(t){return t&&t.source||t}function i(i,r){return RegExp(e(i),"m"+(t.cI?"i":"")+(r?"g":""))}function r(o,n){function s(e,i){t.cI&&(i=i.toLowerCase()),i.split(" ").forEach(function(t){var i=t.split("|");l[i[0]]=[e,i[1]?Number(i[1]):1]})}if(!o.compiled){if(o.compiled=!0,o.k=o.k||o.bK,o.k){var l={};"string"==typeof o.k?s("keyword",o.k):Object.keys(o.k).forEach(function(t){s(t,o.k[t])}),o.k=l}o.lR=i(o.l||/\b[A-Za-z0-9_]+\b/,!0),n&&(o.bK&&(o.b=o.bK.split(" ").join("|")),o.b||(o.b=/\B|\b/),o.bR=i(o.b),o.e||o.eW||(o.e=/\B|\b/),o.e&&(o.eR=i(o.e)),o.tE=e(o.e)||"",o.eW&&n.tE&&(o.tE+=(o.e?"|":"")+n.tE)),o.i&&(o.iR=i(o.i)),void 0===o.r&&(o.r=1),o.c||(o.c=[]);var c=[];o.c.forEach(function(t){t.v?t.v.forEach(function(e){c.push(a(t,e))}):c.push("self"==t?o:t)}),o.c=c,o.c.forEach(function(t){r(t,o)}),o.starts&&r(o.starts,n);var h=o.c.map(function(t){return t.bK?"\\.?\\b("+t.b+")\\b\\.?":t.b}).concat([o.tE]).concat([o.i]).map(e).filter(Boolean);o.t=h.length?i(h.join("|"),!0):{exec:function(t){return null}},o.continuation={}}}r(t)}function c(e,r,o,a){function n(t,e){for(var r=0;r<e.c.length;r++)if(i(e.c[r].bR,t))return e.c[r]}function s(t,e){return i(t.eR,e)?t:t.eW?s(t.parent,e):void 0}function u(t,e){return!o&&i(e.iR,t)}function d(t,e){var i=C.cI?e[0].toLowerCase():e[0];return t.k.hasOwnProperty(i)&&t.k[i]}function p(t,e,i,r){var o=r?"":y.classPrefix,a='<span class="'+o,n=i?"":"</span>";return a+=t+'">',a+e+n}function f(){var e=t(T);if(!S.k)return e;var i="",r=0;S.lR.lastIndex=0;for(var o=S.lR.exec(e);o;){i+=e.substr(r,o.index-r);var a=d(S,o);a?(k+=a[1],i+=p(a[0],o[0])):i+=o[0],r=S.lR.lastIndex,o=S.lR.exec(e)}return i+e.substr(r)}function m(){if(S.sL&&!b[S.sL])return t(T);var e=S.sL?c(S.sL,T,!0,S.continuation.top):h(T);return S.r>0&&(k+=e.r),"continuous"==S.subLanguageMode&&(S.continuation.top=e.top),p(e.language,e.value,!1,!0)}function g(){return void 0!==S.sL?m():f()}function x(e,i){var r=e.cN?p(e.cN,"",!0):"";e.rB?(_+=r,T=""):e.eB?(_+=t(i)+r,T=""):(_+=r,T=i),S=Object.create(e,{parent:{value:S}})}function w(e,i){if(T+=e,void 0===i)return _+=g(),0;var r=n(i,S);if(r)return _+=g(),x(r,i),r.rB?0:i.length;var o=s(S,i);if(o){var a=S;a.rE||a.eE||(T+=i),_+=g();do S.cN&&(_+="</span>"),k+=S.r,S=S.parent;while(S!=o.parent);return a.eE&&(_+=t(i)),T="",o.starts&&x(o.starts,""),a.rE?0:i.length}if(u(i,S))throw new Error('Illegal lexeme "'+i+'" for mode "'+(S.cN||"<unnamed>")+'"');return T+=i,i.length||1}var C=v(e);if(!C)throw new Error('Unknown language: "'+e+'"');l(C);for(var S=a||C,_="",M=S;M!=C;M=M.parent)M.cN&&(_=p(M.cN,_,!0));var T="",k=0;try{for(var N,A,I=0;;){if(S.t.lastIndex=I,N=S.t.exec(r),!N)break;A=w(r.substr(I,N.index-I),N[0]),I=N.index+A}w(r.substr(I));for(var M=S;M.parent;M=M.parent)M.cN&&(_+="</span>");return{r:k,value:_,language:e,top:S}}catch(e){if(e.message.indexOf("Illegal")!=-1)return{r:0,value:t(r)};throw e}}function h(e,i){i=i||y.languages||Object.keys(b);var r={r:0,value:t(e)},o=r;return i.forEach(function(t){if(v(t)){var i=c(t,e,!1);i.language=t,i.r>o.r&&(o=i),i.r>r.r&&(o=r,r=i)}}),o.language&&(r.second_best=o),r}function u(t){return y.tabReplace&&(t=t.replace(/^((<[^>]+>|\t)+)/gm,function(t,e,i,r){return e.replace(/\t/g,y.tabReplace)})),y.useBR&&(t=t.replace(/\n/g,"<br>")),t}function d(t){var e=r(t),i=o(t);if("no-highlight"!=i){var a=i?c(i,e,!0):h(e),l=n(t);if(l.length){var d=document.createElementNS("http://www.w3.org/1999/xhtml","pre");d.innerHTML=a.value,a.value=s(l,n(d),e)}a.value=u(a.value),t.innerHTML=a.value,t.className+=" hljs "+(!i&&a.language||""),t.result={language:a.language,re:a.r},a.second_best&&(t.second_best={language:a.second_best.language,re:a.second_best.r})}}function p(t){y=a(y,t)}function f(){if(!f.called){f.called=!0;var t=document.querySelectorAll("pre code");Array.prototype.forEach.call(t,d)}}function m(){addEventListener("DOMContentLoaded",f,!1),addEventListener("load",f,!1)}function g(t,e){var i=b[t]=e(this);i.aliases&&i.aliases.forEach(function(e){x[e]=t})}function v(t){return b[t]||b[x[t]]}var y={classPrefix:"hljs-",tabReplace:null,useBR:!1,languages:void 0},b={},x={};this.highlight=c,this.highlightAuto=h,this.fixMarkup=u,this.highlightBlock=d,this.configure=p,this.initHighlighting=f,this.initHighlightingOnLoad=m,this.registerLanguage=g,this.getLanguage=v,this.inherit=a,this.IR="[a-zA-Z][a-zA-Z0-9_]*",this.UIR="[a-zA-Z_][a-zA-Z0-9_]*",this.NR="\\b\\d+(\\.\\d+)?",this.CNR="(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",this.BNR="\\b(0b[01]+)",this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",this.BE={b:"\\\\[\\s\\S]",r:0},this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE]},this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE]},this.CLCM={cN:"comment",b:"//",e:"$"},this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"},this.HCM={cN:"comment",b:"#",e:"$"},this.NM={cN:"number",b:this.NR,r:0},this.CNM={cN:"number",b:this.CNR,r:0},this.BNM={cN:"number",b:this.BNR,r:0},this.REGEXP_MODE={cN:"regexp",b:/\//,e:/\/[gim]*/,i:/\n/,c:[this.BE,{b:/\[/,e:/\]/,r:0,c:[this.BE]}]},this.TM={cN:"title",b:this.IR,r:0},this.UTM={cN:"title",b:this.UIR,r:0}};hljs.registerLanguage("bash",function(t){var e={cN:"variable",v:[{b:/\$[\w\d#@][\w\d_]*/},{b:/\$\{(.*?)\}/}]},i={cN:"string",b:/"/,e:/"/,c:[t.BE,e,{cN:"variable",b:/\$\(/,e:/\)/,c:[t.BE]}]},r={cN:"string",b:/'/,e:/'/};return{l:/-?[a-z\.]+/,k:{keyword:"if then else elif fi for break continue while in do done exit return set declare case esac export exec",literal:"true false",built_in:"printf echo read cd pwd pushd popd dirs let eval unset typeset readonly getopts source shopt caller type hash bind help sudo",operator:"-ne -eq -lt -gt -f -d -e -s -l -a"},c:[{cN:"shebang",b:/^#![^\n]+sh\s*$/,r:10},{cN:"function",b:/\w[\w\d_]*\s*\(\s*\)\s*\{/,rB:!0,c:[t.inherit(t.TM,{b:/\w[\w\d_]*/})],r:0},t.HCM,t.NM,i,r,e]}}),hljs.registerLanguage("cs",function(t){var e="abstract as base bool break byte case catch char checked const continue decimal default delegate do double else enum event explicit extern false finally fixed float for foreach goto if implicit in int interface internal is lock long new null object operator out override params private protected public readonly ref return sbyte sealed short sizeof stackalloc static string struct switch this throw true try typeof uint ulong unchecked unsafe ushort using virtual volatile void while async await ascending descending from get group into join let orderby partial select set value var where yield";return{k:e,c:[{cN:"comment",b:"///",e:"$",rB:!0,c:[{cN:"xmlDocTag",b:"///|<!--|-->"},{cN:"xmlDocTag",b:"</?",e:">"}]},t.CLCM,t.CBLCLM,{cN:"preprocessor",b:"#",e:"$",k:"if else elif endif define undef warning error line region endregion pragma checksum"},{cN:"string",b:'@"',e:'"',c:[{b:'""'}]},t.ASM,t.QSM,t.CNM,{bK:"protected public private internal",e:/[{;=]/,k:e,c:[{bK:"class namespace interface",starts:{c:[t.TM]}},{b:t.IR+"\\s*\\(",rB:!0,c:[t.TM]}]}]}}),hljs.registerLanguage("ruby",function(t){var e="[a-zA-Z_]\\w*[!?=]?|[-+~]\\@|<<|>>|=~|===?|<=>|[<>]=?|\\*\\*|[-/+%^&*~`|]|\\[\\]=?",i="and false then defined module in return redo if BEGIN retry end for true self when next until do begin unless END rescue nil else break undef not super class case require yield alias while ensure elsif or include attr_reader attr_writer attr_accessor",r={cN:"yardoctag",b:"@[A-Za-z]+"},o={cN:"comment",v:[{b:"#",e:"$",c:[r]},{b:"^\\=begin",e:"^\\=end",c:[r],r:10},{b:"^__END__",e:"\\n$"}]},a={cN:"subst",b:"#\\{",e:"}",k:i},n={cN:"string",c:[t.BE,a],v:[{b:/'/,e:/'/},{b:/"/,e:/"/},{b:"%[qw]?\\(",e:"\\)"},{b:"%[qw]?\\[",e:"\\]"},{b:"%[qw]?{",e:"}"},{b:"%[qw]?<",e:">",r:10},{b:"%[qw]?/",e:"/",r:10},{b:"%[qw]?%",e:"%",r:10},{b:"%[qw]?-",e:"-",r:10},{b:"%[qw]?\\|",e:"\\|",r:10},{b:/\B\?(\\\d{1,3}|\\x[A-Fa-f0-9]{1,2}|\\u[A-Fa-f0-9]{4}|\\?\S)\b/}]},s={cN:"params",b:"\\(",e:"\\)",k:i},l=[n,o,{cN:"class",bK:"class module",e:"$|;",i:/=/,c:[t.inherit(t.TM,{b:"[A-Za-z_]\\w*(::\\w+)*(\\?|\\!)?"}),{cN:"inheritance",b:"<\\s*",c:[{cN:"parent",b:"("+t.IR+"::)?"+t.IR}]},o]},{cN:"function",bK:"def",e:" |$|;",r:0,c:[t.inherit(t.TM,{b:e}),s,o]},{cN:"constant",b:"(::)?(\\b[A-Z]\\w*(::)?)+",r:0},{cN:"symbol",b:":",c:[n,{b:e}],r:0},{cN:"symbol",b:t.UIR+"(\\!|\\?)?:",r:0},{cN:"number",b:"(\\b0[0-7_]+)|(\\b0x[0-9a-fA-F_]+)|(\\b[1-9][0-9_]*(\\.[0-9_]+)?)|[0_]\\b",r:0},{cN:"variable",b:"(\\$\\W)|((\\$|\\@\\@?)(\\w+))"},{b:"("+t.RSR+")\\s*",c:[o,{cN:"regexp",c:[t.BE,a],i:/\n/,v:[{b:"/",e:"/[a-z]*"},{b:"%r{",e:"}[a-z]*"},{b:"%r\\(",e:"\\)[a-z]*"},{b:"%r!",e:"![a-z]*"},{b:"%r\\[",e:"\\][a-z]*"}]}],r:0}];return a.c=l,s.c=l,{k:i,c:l}}),hljs.registerLanguage("diff",function(t){return{c:[{cN:"chunk",r:10,v:[{b:/^\@\@ +\-\d+,\d+ +\+\d+,\d+ +\@\@$/},{b:/^\*\*\* +\d+,\d+ +\*\*\*\*$/},{b:/^\-\-\- +\d+,\d+ +\-\-\-\-$/}]},{cN:"header",v:[{b:/Index: /,e:/$/},{b:/=====/,e:/=====$/},{b:/^\-\-\-/,e:/$/},{b:/^\*{3} /,e:/$/},{b:/^\+\+\+/,e:/$/},{b:/\*{5}/,e:/\*{5}$/}]},{cN:"addition",b:"^\\+",e:"$"},{cN:"deletion",b:"^\\-",e:"$"},{cN:"change",b:"^\\!",e:"$"}]}}),hljs.registerLanguage("javascript",function(t){return{aliases:["js"],k:{keyword:"in if for while finally var new function do return void else break catch instanceof with throw case default try this switch continue typeof delete let yield const class",literal:"true false null undefined NaN Infinity",built_in:"eval isFinite isNaN parseFloat parseInt decodeURI decodeURIComponent encodeURI encodeURIComponent escape unescape Object Function Boolean Error EvalError InternalError RangeError ReferenceError StopIteration SyntaxError TypeError URIError Number Math Date String RegExp Array Float32Array Float64Array Int16Array Int32Array Int8Array Uint16Array Uint32Array Uint8Array Uint8ClampedArray ArrayBuffer DataView JSON Intl arguments require"},c:[{cN:"pi",b:/^\s*('|")use strict('|")/,r:10},t.ASM,t.QSM,t.CLCM,t.CBLCLM,t.CNM,{b:"("+t.RSR+"|\\b(case|return|throw)\\b)\\s*",k:"return throw case",c:[t.CLCM,t.CBLCLM,t.REGEXP_MODE,{b:/</,e:/>;/,r:0,sL:"xml"}],r:0},{cN:"function",bK:"function",e:/\{/,c:[t.inherit(t.TM,{b:/[A-Za-z$_][0-9A-Za-z$_]*/}),{cN:"params",b:/\(/,e:/\)/,c:[t.CLCM,t.CBLCLM],i:/["'\(]/}],i:/\[|%/},{b:/\$[(.]/},{b:"\\."+t.IR,r:0}]}}),hljs.registerLanguage("xml",function(t){var e="[A-Za-z0-9\\._:-]+",i={b:/<\?(php)?(?!\w)/,e:/\?>/,sL:"php",subLanguageMode:"continuous"},r={eW:!0,i:/</,r:0,c:[i,{cN:"attribute",b:e,r:0},{b:"=",r:0,c:[{cN:"value",v:[{b:/"/,e:/"/},{b:/'/,e:/'/},{b:/[^\s\/>]+/}]}]}]};return{aliases:["html"],cI:!0,c:[{cN:"doctype",b:"<!DOCTYPE",e:">",r:10,c:[{b:"\\[",e:"\\]"}]},{cN:"comment",b:"<!--",e:"-->",r:10},{cN:"cdata",b:"<\\!\\[CDATA\\[",e:"\\]\\]>",r:10},{cN:"tag",b:"<style(?=\\s|>|$)",e:">",k:{title:"style"},c:[r],starts:{e:"</style>",rE:!0,sL:"css"}},{cN:"tag",b:"<script(?=\\s|>|$)",e:">",k:{title:"script"},c:[r],starts:{e:"</script>",rE:!0,sL:"javascript"}},{b:"<%",e:"%>",sL:"vbscript"},i,{cN:"pi",b:/<\?\w+/,e:/\?>/,r:10},{cN:"tag",b:"</?",e:"/?>",c:[{cN:"title",b:"[^ /><]+",r:0},r]}]}}),hljs.registerLanguage("markdown",function(t){return{c:[{cN:"header",v:[{b:"^#{1,6}",e:"$"},{b:"^.+?\\n[=-]{2,}$"}]},{b:"<",e:">",sL:"xml",r:0},{cN:"bullet",b:"^([*+-]|(\\d+\\.))\\s+"},{cN:"strong",b:"[*_]{2}.+?[*_]{2}"},{cN:"emphasis",v:[{b:"\\*.+?\\*"},{b:"_.+?_",r:0}]},{cN:"blockquote",b:"^>\\s+",e:"$"},{cN:"code",v:[{b:"`.+?`"},{b:"^( {4}|\t)",e:"$",r:0}]},{cN:"horizontal_rule",b:"^[-\\*]{3,}",e:"$"},{b:"\\[.+?\\][\\(\\[].+?[\\)\\]]",rB:!0,c:[{cN:"link_label",b:"\\[",e:"\\]",eB:!0,rE:!0,r:0},{cN:"link_url",b:"\\]\\(",e:"\\)",eB:!0,eE:!0},{cN:"link_reference",b:"\\]\\[",e:"\\]",eB:!0,eE:!0}],r:10},{b:"^\\[.+\\]:",e:"$",rB:!0,c:[{cN:"link_reference",b:"\\[",e:"\\]",eB:!0,eE:!0},{cN:"link_url",b:"\\s",e:"$"}]}]}}),hljs.registerLanguage("css",function(t){var e="[a-zA-Z-][a-zA-Z0-9_-]*",i={cN:"function",b:e+"\\(",e:"\\)",c:["self",t.NM,t.ASM,t.QSM]};return{cI:!0,i:"[=/|']",c:[t.CBLCLM,{cN:"id",b:"\\#[A-Za-z0-9_-]+"},{cN:"class",b:"\\.[A-Za-z0-9_-]+",r:0},{cN:"attr_selector",b:"\\[",e:"\\]",i:"$"},{cN:"pseudo",b:":(:)?[a-zA-Z0-9\\_\\-\\+\\(\\)\\\"\\']+"},{cN:"at_rule",b:"@(font-face|page)",l:"[a-z-]+",k:"font-face page"},{cN:"at_rule",b:"@",e:"[{;]",c:[{cN:"keyword",b:/\S+/},{b:/\s/,eW:!0,eE:!0,r:0,c:[i,t.ASM,t.QSM,t.NM]}]},{cN:"tag",b:e,r:0},{cN:"rules",b:"{",e:"}",i:"[^\\s]",r:0,c:[t.CBLCLM,{cN:"rule",b:"[^\\s]",rB:!0,e:";",eW:!0,c:[{cN:"attribute",b:"[A-Z\\_\\.\\-]+",e:":",eE:!0,i:"[^\\s]",starts:{cN:"value",eW:!0,eE:!0,c:[i,t.NM,t.QSM,t.ASM,t.CBLCLM,{cN:"hexcolor",b:"#[0-9A-Fa-f]+"},{cN:"important",b:"!important"}]}}]}]}]}}),hljs.registerLanguage("profile",function(t){return{c:[t.CNM,{cN:"built_in",b:"{",e:"}$",eB:!0,eE:!0,c:[t.ASM,t.QSM],r:0},{cN:"filename",b:"[a-zA-Z_][\\da-zA-Z_]+\\.[\\da-zA-Z_]{1,3}",e:":",eE:!0},{cN:"header",b:"(ncalls|tottime|cumtime)",e:"$",k:"ncalls tottime|10 cumtime|10 filename",r:10},{cN:"summary",b:"function calls",e:"$",c:[t.CNM],r:10},t.ASM,t.QSM,{cN:"function",b:"\\(",e:"\\)$",c:[t.UTM],r:0}]}}),hljs.registerLanguage("http",function(t){return{i:"\\S",c:[{cN:"status",b:"^HTTP/[0-9\\.]+",e:"$",c:[{cN:"number",b:"\\b\\d{3}\\b"}]},{cN:"request",b:"^[A-Z]+ (.*?) HTTP/[0-9\\.]+$",rB:!0,e:"$",c:[{cN:"string",b:" ",e:" ",eB:!0,eE:!0}]},{cN:"attribute",b:"^\\w",e:": ",eE:!0,i:"\\n|\\s|=",starts:{cN:"string",e:"$"}},{b:"\\n\\n",starts:{sL:"",eW:!0}}]}}),hljs.registerLanguage("java",function(t){var e="false synchronized int abstract float private char boolean static null if const for true while long throw strictfp finally protected import native final return void enum else break transient new catch instanceof byte super volatile case assert short package default double public try this switch continue throws";return{k:e,i:/<\//,c:[{cN:"javadoc",b:"/\\*\\*",e:"\\*/",c:[{cN:"javadoctag",b:"(^|\\s)@[A-Za-z]+"}],r:10},t.CLCM,t.CBLCLM,t.ASM,t.QSM,{bK:"protected public private",e:/[{;=]/,k:e,c:[{cN:"class",bK:"class interface",eW:!0,i:/[:"<>]/,c:[{bK:"extends implements",r:10},t.UTM]},{b:t.UIR+"\\s*\\(",rB:!0,c:[t.UTM]}]},t.CNM,{cN:"annotation",b:"@[A-Za-z]+"}]}}),hljs.registerLanguage("php",function(t){var e={cN:"variable",b:"\\$+[a-zA-Z_-ÿ][a-zA-Z0-9_-ÿ]*"},i={cN:"preprocessor",b:/<\?(php)?|\?>/},r={cN:"string",c:[t.BE,i],v:[{b:'b"',e:'"'},{b:"b'",e:"'"},t.inherit(t.ASM,{i:null}),t.inherit(t.QSM,{i:null})]},o={v:[t.BNM,t.CNM]};return{cI:!0,k:"and include_once list abstract global private echo interface as static endswitch array null if endwhile or const for endforeach self var while isset public protected exit foreach throw elseif include __FILE__ empty require_once do xor return parent clone use __CLASS__ __LINE__ else break print eval new catch __METHOD__ case exception default die require __FUNCTION__ enddeclare final try switch continue endfor endif declare unset true false trait goto instanceof insteadof __DIR__ __NAMESPACE__ yield finally",c:[t.CLCM,t.HCM,{cN:"comment",b:"/\\*",e:"\\*/",c:[{cN:"phpdoc",b:"\\s@[A-Za-z]+"},i]},{cN:"comment",b:"__halt_compiler.+?;",eW:!0,k:"__halt_compiler",l:t.UIR},{cN:"string",b:"<<<['\"]?\\w+['\"]?$",e:"^\\w+;",c:[t.BE]},i,e,{cN:"function",bK:"function",e:/[;{]/,i:"\\$|\\[|%",c:[t.UTM,{cN:"params",b:"\\(",e:"\\)",c:["self",e,t.CBLCLM,r,o]}]},{cN:"class",bK:"class interface",e:"{",i:/[:\(\$"]/,c:[{bK:"extends implements",r:10},t.UTM]},{bK:"namespace",e:";",i:/[\.']/,c:[t.UTM]},{bK:"use",e:";",c:[t.UTM]},{b:"=>"},r,o]}}),hljs.registerLanguage("python",function(t){var e={cN:"prompt",b:/^(>>>|\.\.\.) /},i={cN:"string",c:[t.BE],v:[{b:/(u|b)?r?'''/,e:/'''/,c:[e],r:10},{b:/(u|b)?r?"""/,e:/"""/,c:[e],r:10},{b:/(u|r|ur)'/,e:/'/,r:10},{b:/(u|r|ur)"/,e:/"/,r:10},{b:/(b|br)'/,e:/'/},{b:/(b|br)"/,e:/"/},t.ASM,t.QSM]},r={cN:"number",r:0,v:[{b:t.BNR+"[lLjJ]?"},{b:"\\b(0o[0-7]+)[lLjJ]?"},{b:t.CNR+"[lLjJ]?"}]},o={cN:"params",b:/\(/,e:/\)/,c:["self",e,r,i]},a={e:/:/,i:/[${=;\n]/,c:[t.UTM,o]};return{k:{keyword:"and elif is global as in if from raise for except finally print import pass return exec else break not with class assert yield try while continue del or def lambda nonlocal|10 None True False",built_in:"Ellipsis NotImplemented"},i:/(<\/|->|\?)/,c:[e,r,i,t.HCM,t.inherit(a,{cN:"function",bK:"def",r:10}),t.inherit(a,{cN:"class",bK:"class"}),{cN:"decorator",b:/@/,e:/$/},{b:/\b(print|exec)\(/}]}}),hljs.registerLanguage("tex",function(t){var e={cN:"command",b:"\\\\[a-zA-Zа-яА-я]+[\\*]?"},i={cN:"command",b:"\\\\[^a-zA-Zа-яА-я0-9]"},r={cN:"special",b:"[{}\\[\\]\\&#~]",r:0};return{c:[{b:"\\\\[a-zA-Zа-яА-я]+[\\*]? *= *-?\\d*\\.?\\d+(pt|pc|mm|cm|in|dd|cc|ex|em)?",rB:!0,c:[e,i,{cN:"number",b:" *=",e:"-?\\d*\\.?\\d+(pt|pc|mm|cm|in|dd|cc|ex|em)?",eB:!0}],r:10},e,i,r,{cN:"formula",b:"\\$\\$",e:"\\$\\$",c:[e,i,r],r:0},{cN:"formula",b:"\\$",e:"\\$",c:[e,i,r],r:0},{cN:"comment",b:"%",e:"$",r:0}]}}),hljs.registerLanguage("sql",function(t){return{cI:!0,i:/[<>]/,c:[{cN:"operator",b:"\\b(begin|end|start|commit|rollback|savepoint|lock|alter|create|drop|rename|call|delete|do|handler|insert|load|replace|select|truncate|update|set|show|pragma|grant|merge)\\b(?!:)",e:";",eW:!0,k:{keyword:"all partial global month current_timestamp using go revoke smallint indicator end-exec disconnect zone with character assertion to add current_user usage input local alter match collate real then rollback get read timestamp session_user not integer bit unique day minute desc insert execute like ilike|2 level decimal drop continue isolation found where constraints domain right national some module transaction relative second connect escape close system_user for deferred section cast current sqlstate allocate intersect deallocate numeric public preserve full goto initially asc no key output collation group by union session both last language constraint column of space foreign deferrable prior connection unknown action commit view or first into float year primary cascaded except restrict set references names table outer open select size are rows from prepare distinct leading create only next inner authorization schema corresponding option declare precision immediate else timezone_minute external varying translation true case exception join hour default double scroll value cursor descriptor values dec fetch procedure delete and false int is describe char as at in varchar null trailing any absolute current_time end grant privileges when cross check write current_date pad begin temporary exec time update catalog user sql date on identity timezone_hour natural whenever interval work order cascade diagnostics nchar having left call do handler load replace truncate start lock show pragma exists number trigger if before after each row merge matched database",aggregate:"count sum min max avg"},c:[{cN:"string",b:"'",e:"'",c:[t.BE,{b:"''"}]},{cN:"string",b:'"',e:'"',c:[t.BE,{b:'""'}]},{cN:"string",b:"`",e:"`",c:[t.BE]},t.CNM]},t.CBLCLM,{cN:"comment",b:"--",e:"$"}]}}),hljs.registerLanguage("ini",function(t){return{cI:!0,i:/\S/,c:[{cN:"comment",b:";",e:"$"},{cN:"title",b:"^\\[",e:"\\]"},{cN:"setting",b:"^[a-z0-9\\[\\]_-]+[ \\t]*=[ \\t]*",e:"$",c:[{cN:"value",eW:!0,k:"on off true false yes no",c:[t.QSM,t.NM],r:0}]}]}}),hljs.registerLanguage("perl",function(t){var e="getpwent getservent quotemeta msgrcv scalar kill dbmclose undef lc ma syswrite tr send umask sysopen shmwrite vec qx utime local oct semctl localtime readpipe do return format read sprintf dbmopen pop getpgrp not getpwnam rewinddir qqfileno qw endprotoent wait sethostent bless s|0 opendir continue each sleep endgrent shutdown dump chomp connect getsockname die socketpair close flock exists index shmgetsub for endpwent redo lstat msgctl setpgrp abs exit select print ref gethostbyaddr unshift fcntl syscall goto getnetbyaddr join gmtime symlink semget splice x|0 getpeername recv log setsockopt cos last reverse gethostbyname getgrnam study formline endhostent times chop length gethostent getnetent pack getprotoent getservbyname rand mkdir pos chmod y|0 substr endnetent printf next open msgsnd readdir use unlink getsockopt getpriority rindex wantarray hex system getservbyport endservent int chr untie rmdir prototype tell listen fork shmread ucfirst setprotoent else sysseek link getgrgid shmctl waitpid unpack getnetbyname reset chdir grep split require caller lcfirst until warn while values shift telldir getpwuid my getprotobynumber delete and sort uc defined srand accept package seekdir getprotobyname semop our rename seek if q|0 chroot sysread setpwent no crypt getc chown sqrt write setnetent setpriority foreach tie sin msgget map stat getlogin unless elsif truncate exec keys glob tied closedirioctl socket readlink eval xor readline binmode setservent eof ord bind alarm pipe atan2 getgrent exp time push setgrent gt lt or ne m|0 break given say state when",i={
cN:"subst",b:"[$@]\\{",e:"\\}",k:e},r={b:"->{",e:"}"},o={cN:"variable",v:[{b:/\$\d/},{b:/[\$\%\@\*](\^\w\b|#\w+(\:\:\w+)*|{\w+}|\w+(\:\:\w*)*)/},{b:/[\$\%\@\*][^\s\w{]/,r:0}]},a={cN:"comment",b:"^(__END__|__DATA__)",e:"\\n$",r:5},n=[t.BE,i,o],s=[o,t.HCM,a,{cN:"comment",b:"^\\=\\w",e:"\\=cut",eW:!0},r,{cN:"string",c:n,v:[{b:"q[qwxr]?\\s*\\(",e:"\\)",r:5},{b:"q[qwxr]?\\s*\\[",e:"\\]",r:5},{b:"q[qwxr]?\\s*\\{",e:"\\}",r:5},{b:"q[qwxr]?\\s*\\|",e:"\\|",r:5},{b:"q[qwxr]?\\s*\\<",e:"\\>",r:5},{b:"qw\\s+q",e:"q",r:5},{b:"'",e:"'",c:[t.BE]},{b:'"',e:'"'},{b:"`",e:"`",c:[t.BE]},{b:"{\\w+}",c:[],r:0},{b:"-?\\w+\\s*\\=\\>",c:[],r:0}]},{cN:"number",b:"(\\b0[0-7_]+)|(\\b0x[0-9a-fA-F_]+)|(\\b[1-9][0-9_]*(\\.[0-9_]+)?)|[0_]\\b",r:0},{b:"(\\/\\/|"+t.RSR+"|\\b(split|return|print|reverse|grep)\\b)\\s*",k:"split return print reverse grep",r:0,c:[t.HCM,a,{cN:"regexp",b:"(s|tr|y)/(\\\\.|[^/])*/(\\\\.|[^/])*/[a-z]*",r:10},{cN:"regexp",b:"(m|qr)?/",e:"/[a-z]*",c:[t.BE],r:0}]},{cN:"sub",bK:"sub",e:"(\\s*\\(.*?\\))?[;{]",r:5},{cN:"operator",b:"-\\w\\b",r:0}];return i.c=s,r.c=s,{k:e,c:s}}),hljs.registerLanguage("objectivec",function(t){var e={keyword:"int float while char export sizeof typedef const struct for union unsigned long volatile static bool mutable if do return goto void enum else break extern asm case short default double register explicit signed typename this switch continue wchar_t inline readonly assign self synchronized id nonatomic super unichar IBOutlet IBAction strong weak @private @protected @public @try @property @end @throw @catch @finally @synthesize @dynamic @selector @optional @required",literal:"false true FALSE TRUE nil YES NO NULL",built_in:"NSString NSDictionary CGRect CGPoint UIButton UILabel UITextView UIWebView MKMapView UISegmentedControl NSObject UITableViewDelegate UITableViewDataSource NSThread UIActivityIndicator UITabbar UIToolBar UIBarButtonItem UIImageView NSAutoreleasePool UITableView BOOL NSInteger CGFloat NSException NSLog NSMutableString NSMutableArray NSMutableDictionary NSURL NSIndexPath CGSize UITableViewCell UIView UIViewController UINavigationBar UINavigationController UITabBarController UIPopoverController UIPopoverControllerDelegate UIImage NSNumber UISearchBar NSFetchedResultsController NSFetchedResultsChangeType UIScrollView UIScrollViewDelegate UIEdgeInsets UIColor UIFont UIApplication NSNotFound NSNotificationCenter NSNotification UILocalNotification NSBundle NSFileManager NSTimeInterval NSDate NSCalendar NSUserDefaults UIWindow NSRange NSArray NSError NSURLRequest NSURLConnection UIInterfaceOrientation MPMoviePlayerController dispatch_once_t dispatch_queue_t dispatch_sync dispatch_async dispatch_once"},i=/[a-zA-Z@][a-zA-Z0-9_]*/,r="@interface @class @protocol @implementation";return{k:e,l:i,i:"</",c:[t.CLCM,t.CBLCLM,t.CNM,t.QSM,{cN:"string",b:"'",e:"[^\\\\]'",i:"[^\\\\][^']"},{cN:"preprocessor",b:"#import",e:"$",c:[{cN:"title",b:'"',e:'"'},{cN:"title",b:"<",e:">"}]},{cN:"preprocessor",b:"#",e:"$"},{cN:"class",b:"("+r.split(" ").join("|")+")\\b",e:"({|$)",k:r,l:i,c:[t.UTM]},{cN:"variable",b:"\\."+t.UIR,r:0}]}}),hljs.registerLanguage("coffeescript",function(t){var e={keyword:"in if for while finally new do return else break catch instanceof throw try this switch continue typeof delete debugger super then unless until loop of by when and or is isnt not",literal:"true false null undefined yes no on off",reserved:"case default function var void with const let enum export import native __hasProp __extends __slice __bind __indexOf",built_in:"npm require console print module exports global window document"},i="[A-Za-z$_][0-9A-Za-z$_]*",r=t.inherit(t.TM,{b:i}),o={cN:"subst",b:/#\{/,e:/}/,k:e},a=[t.BNM,t.inherit(t.CNM,{starts:{e:"(\\s*/)?",r:0}}),{cN:"string",v:[{b:/'''/,e:/'''/,c:[t.BE]},{b:/'/,e:/'/,c:[t.BE]},{b:/"""/,e:/"""/,c:[t.BE,o]},{b:/"/,e:/"/,c:[t.BE,o]}]},{cN:"regexp",v:[{b:"///",e:"///",c:[o,t.HCM]},{b:"//[gim]*",r:0},{b:"/\\S(\\\\.|[^\\n])*?/[gim]*(?=\\s|\\W|$)"}]},{cN:"property",b:"@"+i},{b:"`",e:"`",eB:!0,eE:!0,sL:"javascript"}];return o.c=a,{k:e,c:a.concat([{cN:"comment",b:"###",e:"###"},t.HCM,{cN:"function",b:"("+i+"\\s*=\\s*)?(\\(.*\\))?\\s*\\B[-=]>",e:"[-=]>",rB:!0,c:[r,{cN:"params",b:"\\(",rB:!0,c:[{b:/\(/,e:/\)/,k:e,c:["self"].concat(a)}]}]},{cN:"class",bK:"class",e:"$",i:/[:="\[\]]/,c:[{bK:"extends",eW:!0,i:/[:="\[\]]/,c:[r]},r]},{cN:"attribute",b:i+":",e:":",rB:!0,eE:!0,r:0}])}}),hljs.registerLanguage("nginx",function(t){var e={cN:"variable",v:[{b:/\$\d+/},{b:/\$\{/,e:/}/},{b:"[\\$\\@]"+t.UIR}]},i={eW:!0,l:"[a-z/_]+",k:{built_in:"on off yes no true false none blocked debug info notice warn error crit select break last permanent redirect kqueue rtsig epoll poll /dev/poll"},r:0,i:"=>",c:[t.HCM,{cN:"string",c:[t.BE,e],v:[{b:/"/,e:/"/},{b:/'/,e:/'/}]},{cN:"url",b:"([a-z]+):/",e:"\\s",eW:!0,eE:!0},{cN:"regexp",c:[t.BE,e],v:[{b:"\\s\\^",e:"\\s|{|;",rE:!0},{b:"~\\*?\\s+",e:"\\s|{|;",rE:!0},{b:"\\*(\\.[a-z\\-]+)+"},{b:"([a-z\\-]+\\.)+\\*"}]},{cN:"number",b:"\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}(:\\d{1,5})?\\b"},{cN:"number",b:"\\b\\d+[kKmMgGdshdwy]*\\b",r:0},e]};return{c:[t.HCM,{b:t.UIR+"\\s",e:";|{",rB:!0,c:[t.inherit(t.UTM,{starts:i})],r:0}],i:"[^\\s\\}]"}}),hljs.registerLanguage("json",function(t){var e={literal:"true false null"},i=[t.QSM,t.CNM],r={cN:"value",e:",",eW:!0,eE:!0,c:i,k:e},o={b:"{",e:"}",c:[{cN:"attribute",b:'\\s*"',e:'"\\s*:\\s*',eB:!0,eE:!0,c:[t.BE],i:"\\n",starts:r}],i:"\\S"},a={b:"\\[",e:"\\]",c:[t.inherit(r,{cN:null})],i:"\\S"};return i.splice(i.length,0,o,a),{c:i,k:e,i:"\\S"}}),hljs.registerLanguage("apache",function(t){var e={cN:"number",b:"[\\$%]\\d+"};return{cI:!0,c:[t.HCM,{cN:"tag",b:"</?",e:">"},{cN:"keyword",b:/\w+/,r:0,k:{common:"order deny allow setenv rewriterule rewriteengine rewritecond documentroot sethandler errordocument loadmodule options header listen serverroot servername"},starts:{e:/$/,r:0,k:{literal:"on off all"},c:[{cN:"sqbracket",b:"\\s\\[",e:"\\]$"},{cN:"cbracket",b:"[\\$%]\\{",e:"\\}",c:["self",e]},e,t.QSM]}}],i:/\S/}}),hljs.registerLanguage("scss",function(t){var e="[a-zA-Z-][a-zA-Z0-9_-]*",i={cN:"function",b:e+"\\(",e:"\\)",c:["self",t.NM,t.ASM,t.QSM]},r={cN:"hexcolor",b:"#[0-9A-Fa-f]+"},o={cN:"attribute",b:"[A-Z\\_\\.\\-]+",e:":",eE:!0,i:"[^\\s]",starts:{cN:"value",eW:!0,eE:!0,c:[i,r,t.NM,t.QSM,t.ASM,t.CBLCLM,{cN:"important",b:"!important"}]}};return{cI:!0,i:"[=/|']",c:[t.CLCM,t.CBLCLM,{cN:"function",b:e+"\\(",e:"\\)",c:["self",t.NM,t.ASM,t.QSM]},{cN:"id",b:"\\#[A-Za-z0-9_-]+",r:0},{cN:"class",b:"\\.[A-Za-z0-9_-]+",r:0},{cN:"attr_selector",b:"\\[",e:"\\]",i:"$"},{cN:"tag",b:"\\b(a|abbr|acronym|address|area|article|aside|audio|b|base|big|blockquote|body|br|button|canvas|caption|cite|code|col|colgroup|command|datalist|dd|del|details|dfn|div|dl|dt|em|embed|fieldset|figcaption|figure|footer|form|frame|frameset|(h[1-6])|head|header|hgroup|hr|html|i|iframe|img|input|ins|kbd|keygen|label|legend|li|link|map|mark|meta|meter|nav|noframes|noscript|object|ol|optgroup|option|output|p|param|pre|progress|q|rp|rt|ruby|samp|script|section|select|small|span|strike|strong|style|sub|sup|table|tbody|td|textarea|tfoot|th|thead|time|title|tr|tt|ul|var|video)\\b",r:0},{cN:"pseudo",b:":(visited|valid|root|right|required|read-write|read-only|out-range|optional|only-of-type|only-child|nth-of-type|nth-last-of-type|nth-last-child|nth-child|not|link|left|last-of-type|last-child|lang|invalid|indeterminate|in-range|hover|focus|first-of-type|first-line|first-letter|first-child|first|enabled|empty|disabled|default|checked|before|after|active)"},{cN:"pseudo",b:"::(after|before|choices|first-letter|first-line|repeat-index|repeat-item|selection|value)"},{cN:"attribute",b:"\\b(z-index|word-wrap|word-spacing|word-break|width|widows|white-space|visibility|vertical-align|unicode-bidi|transition-timing-function|transition-property|transition-duration|transition-delay|transition|transform-style|transform-origin|transform|top|text-underline-position|text-transform|text-shadow|text-rendering|text-overflow|text-indent|text-decoration-style|text-decoration-line|text-decoration-color|text-decoration|text-align-last|text-align|tab-size|table-layout|right|resize|quotes|position|pointer-events|perspective-origin|perspective|page-break-inside|page-break-before|page-break-after|padding-top|padding-right|padding-left|padding-bottom|padding|overflow-y|overflow-x|overflow-wrap|overflow|outline-width|outline-style|outline-offset|outline-color|outline|orphans|order|opacity|object-position|object-fit|normal|none|nav-up|nav-right|nav-left|nav-index|nav-down|min-width|min-height|max-width|max-height|mask|marks|margin-top|margin-right|margin-left|margin-bottom|margin|list-style-type|list-style-position|list-style-image|list-style|line-height|letter-spacing|left|justify-content|initial|inherit|ime-mode|image-orientation|image-resolution|image-rendering|icon|hyphens|height|font-weight|font-variant-ligatures|font-variant|font-style|font-stretch|font-size-adjust|font-size|font-language-override|font-kerning|font-feature-settings|font-family|font|float|flex-wrap|flex-shrink|flex-grow|flex-flow|flex-direction|flex-basis|flex|filter|empty-cells|display|direction|cursor|counter-reset|counter-increment|content|column-width|column-span|column-rule-width|column-rule-style|column-rule-color|column-rule|column-gap|column-fill|column-count|columns|color|clip-path|clip|clear|caption-side|break-inside|break-before|break-after|box-sizing|box-shadow|box-decoration-break|bottom|border-width|border-top-width|border-top-style|border-top-right-radius|border-top-left-radius|border-top-color|border-top|border-style|border-spacing|border-right-width|border-right-style|border-right-color|border-right|border-radius|border-left-width|border-left-style|border-left-color|border-left|border-image-width|border-image-source|border-image-slice|border-image-repeat|border-image-outset|border-image|border-color|border-collapse|border-bottom-width|border-bottom-style|border-bottom-right-radius|border-bottom-left-radius|border-bottom-color|border-bottom|border|background-size|background-repeat|background-position|background-origin|background-image|background-color|background-clip|background-attachment|background|backface-visibility|auto|animation-timing-function|animation-play-state|animation-name|animation-iteration-count|animation-fill-mode|animation-duration|animation-direction|animation-delay|animation|align-self|align-items|align-content)\\b",i:"[^\\s]"},{cN:"value",b:"\\b(whitespace|wait|w-resize|visible|vertical-text|vertical-ideographic|uppercase|upper-roman|upper-alpha|underline|transparent|top|thin|thick|text|text-top|text-bottom|tb-rl|table-header-group|table-footer-group|sw-resize|super|strict|static|square|solid|small-caps|separate|se-resize|scroll|s-resize|rtl|row-resize|ridge|right|repeat|repeat-y|repeat-x|relative|progress|pointer|overline|outside|outset|oblique|nowrap|not-allowed|normal|none|nw-resize|no-repeat|no-drop|newspaper|ne-resize|n-resize|move|middle|medium|ltr|lr-tb|lowercase|lower-roman|lower-alpha|loose|list-item|line|line-through|line-edge|lighter|left|keep-all|justify|italic|inter-word|inter-ideograph|inside|inset|inline|inline-block|inherit|inactive|ideograph-space|ideograph-parenthesis|ideograph-numeric|ideograph-alpha|horizontal|hidden|help|hand|groove|fixed|ellipsis|e-resize|double|dotted|distribute|distribute-space|distribute-letter|distribute-all-lines|disc|disabled|default|decimal|dashed|crosshair|collapse|col-resize|circle|char|center|capitalize|break-word|break-all|bottom|both|bolder|bold|block|bidi-override|below|baseline|auto|always|all-scroll|absolute|table|table-cell)\\b"},{cN:"value",b:":",e:";",c:[r,t.NM,t.QSM,t.ASM,{cN:"important",b:"!important"}]},{cN:"at_rule",b:"@",e:"[{;]",k:"mixin include extend for if else each while charset import debug media page content font-face namespace warn",c:[i,t.QSM,t.ASM,r,t.NM,{cN:"preprocessor",b:"\\s[A-Za-z0-9_.-]+",r:0}]}]}}),hljs.registerLanguage("applescript",function(t){var e=t.inherit(t.QSM,{i:""}),i={cN:"params",b:"\\(",e:"\\)",c:["self",t.CNM,e]},r=[{cN:"comment",b:"--",e:"$"},{cN:"comment",b:"\\(\\*",e:"\\*\\)",c:["self",{b:"--",e:"$"}]},t.HCM];return{k:{keyword:"about above after against and around as at back before beginning behind below beneath beside between but by considering contain contains continue copy div does eighth else end equal equals error every exit fifth first for fourth from front get given global if ignoring in into is it its last local me middle mod my ninth not of on onto or over prop property put ref reference repeat returning script second set seventh since sixth some tell tenth that the then third through thru timeout times to transaction try until where while whose with without",constant:"AppleScript false linefeed return pi quote result space tab true",type:"alias application boolean class constant date file integer list number real record string text",command:"activate beep count delay launch log offset read round run say summarize write",property:"character characters contents day frontmost id item length month name paragraph paragraphs rest reverse running time version weekday word words year"},c:[e,t.CNM,{cN:"type",b:"\\bPOSIX file\\b"},{cN:"command",b:"\\b(clipboard info|the clipboard|info for|list (disks|folder)|mount volume|path to|(close|open for) access|(get|set) eof|current date|do shell script|get volume settings|random number|set volume|system attribute|system info|time to GMT|(load|run|store) script|scripting components|ASCII (character|number)|localized string|choose (application|color|file|file name|folder|from list|remote application|URL)|display (alert|dialog))\\b|^\\s*return\\b"},{cN:"constant",b:"\\b(text item delimiters|current application|missing value)\\b"},{cN:"keyword",b:"\\b(apart from|aside from|instead of|out of|greater than|isn't|(doesn't|does not) (equal|come before|come after|contain)|(greater|less) than( or equal)?|(starts?|ends|begins?) with|contained by|comes (before|after)|a (ref|reference))\\b"},{cN:"property",b:"\\b(POSIX path|(date|time) string|quoted form)\\b"},{cN:"function_start",bK:"on",i:"[${=;\\n]",c:[t.UTM,i]}].concat(r),i:"//"}}),hljs.registerLanguage("cpp",function(t){var e={keyword:"false int float while private char catch export virtual operator sizeof dynamic_cast|10 typedef const_cast|10 const struct for static_cast|10 union namespace unsigned long throw volatile static protected bool template mutable if public friend do return goto auto void enum else break new extern using true class asm case typeid short reinterpret_cast|10 default double register explicit signed typename try this switch continue wchar_t inline delete alignof char16_t char32_t constexpr decltype noexcept nullptr static_assert thread_local restrict _Bool complex _Complex _Imaginary",built_in:"std string cin cout cerr clog stringstream istringstream ostringstream auto_ptr deque list queue stack vector map set bitset multiset multimap unordered_set unordered_map unordered_multiset unordered_multimap array shared_ptr abort abs acos asin atan2 atan calloc ceil cosh cos exit exp fabs floor fmod fprintf fputs free frexp fscanf isalnum isalpha iscntrl isdigit isgraph islower isprint ispunct isspace isupper isxdigit tolower toupper labs ldexp log10 log malloc memchr memcmp memcpy memset modf pow printf putchar puts scanf sinh sin snprintf sprintf sqrt sscanf strcat strchr strcmp strcpy strcspn strlen strncat strncmp strncpy strpbrk strrchr strspn strstr tanh tan vfprintf vprintf vsprintf"};return{aliases:["c"],k:e,i:"</",c:[t.CLCM,t.CBLCLM,t.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},t.CNM,{cN:"preprocessor",b:"#",e:"$",c:[{b:"include\\s*<",e:">",i:"\\n"},t.CLCM]},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:e,r:10,c:["self"]}]}}),hljs.registerLanguage("makefile",function(t){var e={cN:"variable",b:/\$\(/,e:/\)/,c:[t.BE]};return{c:[t.HCM,{b:/^\w+\s*\W*=/,rB:!0,r:0,starts:{cN:"constant",e:/\s*\W*=/,eE:!0,starts:{e:/$/,r:0,c:[e]}}},{cN:"title",b:/^[\w]+:\s*$/},{cN:"phony",b:/^\.PHONY:/,e:/$/,k:".PHONY",l:/[\.\w]+/},{b:/^\t+/,e:/$/,c:[t.QSM,e]}]}}),hljs.initHighlightingOnLoad(),$(function(){$("select#sortBy").change(function(t){var e=$("#ticketTableSortingForm");$("input#sortDesc").attr("value","False"),e.submit()}),$("button#sortDescendingButton").bind("click",function(t){var e=$("#ticketTableSortingForm");$("input#sortDesc").attr("value","True"),e.submit()}),$("button#sortAscendingButton").bind("click",function(t){var e=$("#ticketTableSortingForm");$("input#sortDesc").attr("value","False"),e.submit()})}),$(function(){$(document.body).on("click","a.changePriorityLink",function(){var t=$(this).closest("div.singleTicket"),e=t.attr("class"),i=$(this).text(),r=$(this).closest(".dropdown-menu");r.find("li.hidden").toggleClass("hidden"),$(this).closest("li").toggleClass("hidden"),e.indexOf("border-red")>=0?(t.toggleClass("border-red"),t.find(".priorityLabel").toggleClass("red")):e.indexOf("border-yellow")>=0?(t.toggleClass("border-yellow"),t.find(".priorityLabel").toggleClass("yellow")):e.indexOf("border-green")>=0?(t.toggleClass("border-green"),t.find(".priorityLabel").toggleClass("green")):e.indexOf("border-blue")>=0&&(t.toggleClass("border-blue"),t.find(".priorityLabel").toggleClass("blue")),i.indexOf("critical")>=0?(t.toggleClass("border-green"),t.find(".priorityLabel").toggleClass("green"),t.find(".priorityLabel").html("<strong>CRITICAL</strong>")):i.indexOf("important")>=0?(t.toggleClass("border-yellow"),t.find(".priorityLabel").toggleClass("yellow"),t.find(".priorityLabel").html("<strong>IMPORTANT</strong>")):i.indexOf("useful")>=0?(t.toggleClass("border-red"),t.find(".priorityLabel").toggleClass("red"),t.find(".priorityLabel").html("<strong>USEFUL</strong>")):i.indexOf("high")>=0?(t.toggleClass("border-green"),t.find(".priorityLabel").toggleClass("green"),t.find(".priorityLabel").html("<strong>HIGH</strong>")):i.indexOf("medium")>=0?(t.toggleClass("border-yellow"),t.find(".priorityLabel").toggleClass("yellow"),t.find(".priorityLabel").html("<strong>MEDIUM</strong>")):i.indexOf("low")>=0?(t.toggleClass("border-red"),t.find(".priorityLabel").toggleClass("red"),t.find(".priorityLabel").html("<strong>LOW</strong>")):i.indexOf("none")>=0&&(t.toggleClass("border-blue"),t.find(".priorityLabel").toggleClass("blue"),t.find(".priorityLabel").html("NONE"))})}),$(function(){$(document.body).on("focusout","input[name='currentMag']",function(){var t=$(this).val();if(t>20.5)return alert("current magnitude must brighter than 20.5 mag"),$(this).val(20.5),!1}),$(document.body).on("click","button.generateOBSubmitButton",function(){var t=$(this).attr("id");setTimeout(function(){t="#"+t,$(t).modal("hide"),$(this).off()},500)})}),$(function(){$(".classificationForm").on("change","select#clsClassificationWRTMax",function(){var t=$(this).val(),e=$(this).closest("form").find("#clsClassificationPhase"),i=e.closest("div.input-prepend").find("span.add-on");if("post-max"==t||"pre-max"==t)e.removeAttr("disabled"),"post-max"==t?i.html("+"):i.html("-");else{var e=$(this).closest("form").find("#clsClassificationPhase");e.attr("disabled",!0),i.html("?")}})}),$(function(){$(".classificationForm").on("change","select[name='clsClassificationWRTMax']",function(){var t=$(this).val(),e=$(this).closest("form").find("input[name='clsClassificationPhase']"),i=e.closest("div.input-prepend").find("span.add-on");"post-max"==t||"pre-max"==t?(e.removeAttr("disabled"),"post-max"==t?i.html("+"):i.html("-")):(e.attr("disabled",!0),"at-max"==t?i.html(""):i.html("?"))})}),$(function(){$(".classificationForm").on("change","select[name='clsType']",function(){var t=$(this).val(),e=$(this).closest("form").find("select[name='clsSnClassification']"),i=$(this).closest("form").find("input[name='clsPeculiar']");"supernova"==t?(e.removeAttr("disabled"),i.removeAttr("disabled")):(e.attr("disabled",!0),i.attr("disabled",!0))})});var _pessto_create_new_ticket_form=function(){var t=$("input[name='objectRa']");t.blur(function(){var e=t.val();e.indexOf(":")>=0&&(e=ra_sex2degrees(e)),$.isNumeric(e)&&t.val(e)});var e=$("input[name='objectDec']");e.blur(function(){var t=e.val();t.indexOf(":")>=0&&(t=dec_sex2degrees(t)),$.isNumeric(t)&&e.val(t)})}();$(function(){document.URL.indexOf("/transients")>-1&&$.post("/marshall/actions/refresh_sidebar_list_counts?method=put")}),$(function(){$("a.ticketMoveToLink").bind("click",function(t){var e=$(this).attr("notification"),e=decodeURIComponent(e),i=$("span#dynamicNotification");i.html(e);var r=$(this).closest("div.singleTicket");fade_and_hide(r),$.post("/marshall/actions/refresh_sidebar_list_counts?method=put")}),$(document.body).on("click","a.ticketMoveToLinkUndo",function(t){var e=$(this).attr("id"),i=$("div#"+e);show_and_unfade(i);var r=$("span#dynamicNotification");setTimeout(function(){r.show().html("")},200),$.post("/marshall/actions/refresh_sidebar_list_counts?method=put")})}),$(function(){$("a[data-toggle='tab']").bind("click",function(t){if($(this).text().indexOf("context")>=0){var e=reset_all_tickets;e();var i=$(this).attr("href"),r=$("div"+i).find("div.aladin-hide");r.attr("class","aladin"),dryxAladin(r)}})});
//# sourceMappingURL=./main-ck.js.map